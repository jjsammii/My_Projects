{
  "paragraphs": [
    {
      "title": "Collaberative Filtering Solution (utilization of clusters to group users and movies)",
      "text": "//importing all relevant packages\r\nimport org.apache.log4j._\r\nimport org.apache.spark.sql._\r\nimport org.apache.spark.sql.types._\r\nimport org.apache.spark.ml.evaluation.RegressionEvaluator\r\nimport org.apache.spark.ml.recommendation.ALS\r\nimport org.apache.spark.sql.SparkSession\r\nimport org.apache.spark.ml.feature.{Normalizer, VectorAssembler}\r\nimport org.apache.spark.ml.feature.StringIndexer\r\nimport org.apache.spark.ml.Pipeline",
      "user": "anonymous",
      "dateUpdated": "2021-04-15T03:38:52+0000",
      "config": {
        "tableHide": false,
        "editorSetting": {
          "language": "scala",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "colWidth": 12,
        "editorMode": "ace/mode/scala",
        "fontSize": 9,
        "editorHide": false,
        "title": true,
        "results": {},
        "enabled": true
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "TEXT",
            "data": "import org.apache.log4j._\nimport org.apache.spark.sql._\nimport org.apache.spark.sql.types._\nimport org.apache.spark.ml.evaluation.RegressionEvaluator\nimport org.apache.spark.ml.recommendation.ALS\nimport org.apache.spark.sql.SparkSession\nimport org.apache.spark.ml.feature.{Normalizer, VectorAssembler}\nimport org.apache.spark.ml.feature.StringIndexer\nimport org.apache.spark.ml.Pipeline\n"
          }
        ]
      },
      "apps": [],
      "runtimeInfos": {},
      "progressUpdateIntervalMs": 500,
      "jobName": "paragraph_1618453647581_149522547",
      "id": "paragraph_1617515941873_847717443",
      "dateCreated": "2021-04-15T02:27:27+0000",
      "dateStarted": "2021-04-15T03:38:52+0000",
      "dateFinished": "2021-04-15T03:38:53+0000",
      "status": "FINISHED",
      "focus": true,
      "$$hashKey": "object:80047"
    },
    {
      "text": "// Algorithm Overview \n// Using clustering to find overall relationship between all users and movies. These clusters wil be used to determine top 10 movies that a user watches \n//based on the ratings from each cluster. Similarly It will be used to assess which top 10 user will be interested in a movie based on predicted ratings using als.",
      "user": "anonymous",
      "dateUpdated": "2021-04-15T03:38:53+0000",
      "config": {
        "editorSetting": {
          "language": "scala",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "colWidth": 12,
        "editorMode": "ace/mode/scala",
        "fontSize": 9,
        "results": {},
        "enabled": true
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": []
      },
      "apps": [],
      "runtimeInfos": {},
      "progressUpdateIntervalMs": 500,
      "jobName": "paragraph_1618453647582_1275728885",
      "id": "paragraph_1618199265442_1244622086",
      "dateCreated": "2021-04-15T02:27:27+0000",
      "dateStarted": "2021-04-15T03:38:53+0000",
      "dateFinished": "2021-04-15T03:38:54+0000",
      "status": "FINISHED",
      "$$hashKey": "object:80048"
    },
    {
      "text": "// Colbertive Filtering \n//1. User-based /User Similarity– This is where groups of users are formed based on their activities\n//(similar users). In essence, this is a measure of similarity between target users and other users of the\n//system. So recommendations can now be made of popular items to other members of the group.\n//2. Item-based/Association (“Users who looked at X also looked at Y”) – This is a measure of similarity\n//between the items based on users’ interactions with the items. For example, the system can look at\n//items that are purchased together or in sequence and suggests this to other users based on the item they\n//bought or chooses.\n",
      "user": "anonymous",
      "dateUpdated": "2021-04-15T03:38:54+0000",
      "config": {
        "editorSetting": {
          "language": "scala",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "colWidth": 12,
        "editorMode": "ace/mode/scala",
        "fontSize": 9,
        "results": {},
        "enabled": true
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": []
      },
      "apps": [],
      "runtimeInfos": {},
      "progressUpdateIntervalMs": 500,
      "jobName": "paragraph_1618453647582_863033282",
      "id": "paragraph_1618199180556_719097707",
      "dateCreated": "2021-04-15T02:27:27+0000",
      "dateStarted": "2021-04-15T03:38:54+0000",
      "dateFinished": "2021-04-15T03:38:54+0000",
      "status": "FINISHED",
      "$$hashKey": "object:80049"
    },
    {
      "text": "Logger.getLogger(\"org\").setLevel(Level.ERROR)",
      "user": "anonymous",
      "dateUpdated": "2021-04-15T03:38:54+0000",
      "config": {
        "editorSetting": {
          "language": "scala",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "colWidth": 12,
        "editorMode": "ace/mode/scala",
        "fontSize": 9,
        "results": {},
        "enabled": true
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": []
      },
      "apps": [],
      "runtimeInfos": {},
      "progressUpdateIntervalMs": 500,
      "jobName": "paragraph_1618453647582_1124664839",
      "id": "paragraph_1617516021899_2060473255",
      "dateCreated": "2021-04-15T02:27:27+0000",
      "dateStarted": "2021-04-15T03:38:54+0000",
      "dateFinished": "2021-04-15T03:38:55+0000",
      "status": "FINISHED",
      "$$hashKey": "object:80050"
    },
    {
      "text": "//alows for coversion from one type to another and ing\\fers values that can be passed\nimport spark.implicits._",
      "user": "anonymous",
      "dateUpdated": "2021-04-15T03:38:55+0000",
      "config": {
        "editorSetting": {
          "language": "scala",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "colWidth": 12,
        "editorMode": "ace/mode/scala",
        "fontSize": 9,
        "results": {},
        "enabled": true
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "TEXT",
            "data": "import spark.implicits._\n"
          }
        ]
      },
      "apps": [],
      "runtimeInfos": {},
      "progressUpdateIntervalMs": 500,
      "jobName": "paragraph_1618453647583_616990520",
      "id": "paragraph_1617623416035_392488973",
      "dateCreated": "2021-04-15T02:27:27+0000",
      "dateStarted": "2021-04-15T03:38:55+0000",
      "dateFinished": "2021-04-15T03:38:57+0000",
      "status": "FINISHED",
      "$$hashKey": "object:80051"
    },
    {
      "title": "User Rating per movie",
      "text": "%sh wget --no-check-certificate https://files.grouplens.org/datasets/movielens/ml-100k/u.data",
      "user": "anonymous",
      "dateUpdated": "2021-04-15T03:38:57+0000",
      "config": {
        "editorSetting": {
          "language": "sh",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": false
        },
        "colWidth": 12,
        "editorMode": "ace/mode/sh",
        "fontSize": 9,
        "title": true,
        "results": {},
        "enabled": true
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "TEXT",
            "data": "--2021-04-15 03:38:58--  https://files.grouplens.org/datasets/movielens/ml-100k/u.data\nResolving files.grouplens.org (files.grouplens.org)... 128.101.65.152\nConnecting to files.grouplens.org (files.grouplens.org)|128.101.65.152|:443... connected.\nWARNING: cannot verify files.grouplens.org's certificate, issued by ‘CN=InCommon RSA Server CA,OU=InCommon,O=Internet2,L=Ann Arbor,ST=MI,C=US’:\n  Unable to locally verify the issuer's authority.\nHTTP request sent, awaiting response... 200 OK\nLength: 1979173 (1.9M)\nSaving to: ‘u.data.4’\n\n     0K .......... .......... .......... .......... ..........  2%  221K 9s\n    50K .......... .......... .......... .......... ..........  5%  460K 6s\n   100K .......... .......... .......... .......... ..........  7% 2.03M 4s\n   150K .......... .......... .......... .......... .......... 10%  545K 4s\n   200K .......... .......... .......... .......... .......... 12% 3.19M 3s\n   250K .......... .......... .......... .......... .......... 15% 2.85M 3s\n   300K .......... .......... .......... .......... .......... 18%  598K 3s\n   350K .......... .......... .......... .......... .......... 20% 2.55M 2s\n   400K .......... .......... .......... .......... .......... 23% 4.95M 2s\n   450K .......... .......... .......... .......... .......... 25% 3.99M 2s\n   500K .......... .......... .......... .......... .......... 28% 6.24M 2s\n   550K .......... .......... .......... .......... .......... 31%  784K 2s\n   600K .......... .......... .......... .......... .......... 33% 1.61M 1s\n   650K .......... .......... .......... .......... .......... 36% 3.68M 1s\n   700K .......... .......... .......... .......... .......... 38% 6.87M 1s\n   750K .......... .......... .......... .......... .......... 41% 3.97M 1s\n   800K .......... .......... .......... .......... .......... 43% 6.69M 1s\n   850K .......... .......... .......... .......... .......... 46% 1.19M 1s\n   900K .......... .......... .......... .......... .......... 49%  720K 1s\n   950K .......... .......... .......... .......... .......... 51% 8.14M 1s\n  1000K .......... .......... .......... .......... .......... 54% 6.35M 1s\n  1050K .......... .......... .......... .......... .......... 56% 5.92M 1s\n  1100K .......... .......... .......... .......... .......... 59% 21.8M 1s\n  1150K .......... .......... .......... .......... .......... 62% 3.90M 1s\n  1200K .......... .......... .......... .......... .......... 64%  620K 1s\n  1250K .......... .......... .......... .......... .......... 67% 17.1M 0s\n  1300K .......... .......... .......... .......... .......... 69% 1.14M 0s\n  1350K .......... .......... .......... .......... .......... 72% 6.90M 0s\n  1400K .......... .......... .......... .......... .......... 75% 5.27M 0s\n  1450K .......... .......... .......... .......... .......... 77%  245M 0s\n  1500K .......... .......... .......... .......... .......... 80% 1010K 0s\n  1550K .......... .......... .......... .......... .......... 82% 5.51M 0s\n  1600K .......... .......... .......... .......... .......... 85% 4.22M 0s\n  1650K .......... .......... .......... .......... .......... 87% 1.86M 0s\n  1700K .......... .......... .......... .......... .......... 90% 18.0M 0s\n  1750K .......... .......... .......... .......... .......... 93% 7.27M 0s\n  1800K .......... .......... .......... .......... .......... 95% 1.99M 0s\n  1850K .......... .......... .......... .......... .......... 98% 1.25M 0s\n  1900K .......... .......... .......... ..                   100% 16.9M=1.2s\n\n2021-04-15 03:39:00 (1.56 MB/s) - ‘u.data.4’ saved [1979173/1979173]\n\n"
          }
        ]
      },
      "apps": [],
      "runtimeInfos": {},
      "progressUpdateIntervalMs": 500,
      "jobName": "paragraph_1618453647583_468709824",
      "id": "paragraph_1617518309641_222710646",
      "dateCreated": "2021-04-15T02:27:27+0000",
      "dateStarted": "2021-04-15T03:38:57+0000",
      "dateFinished": "2021-04-15T03:39:00+0000",
      "status": "FINISHED",
      "$$hashKey": "object:80052"
    },
    {
      "text": "%sh\nls\n",
      "user": "anonymous",
      "dateUpdated": "2021-04-15T03:39:00+0000",
      "config": {
        "editorSetting": {
          "language": "sh",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": false
        },
        "colWidth": 12,
        "editorMode": "ace/mode/sh",
        "fontSize": 9,
        "results": {},
        "enabled": true
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "TEXT",
            "data": "bin\nconf\ninterpreter\nk8s\nlib\nLICENSE\nlicenses\nlogs\nmovies.dat\nmovies.dat.1\nmovies.dat.2\nmovies.dat.3\nnotebook\nNOTICE\nplugins\nratings.dat\nratings.dat.1\nratings.dat.2\nratings.dat.3\nREADME.md\nrun\nu.data\nu.data.1\nu.data.2\nu.data.3\nu.data.4\nu.item\nu.item.1\nu.item.2\nu.item.3\nusers.dat\nusers.dat.1\nusers.dat.2\nusers.dat.3\nu.user\nu.user.1\nu.user.2\nu.user.3\nwebapps\nzeppelin-web-0.9.0-preview2.war\nzeppelin-web-angular-0.9.0-preview2.war\n"
          }
        ]
      },
      "apps": [],
      "runtimeInfos": {},
      "progressUpdateIntervalMs": 500,
      "jobName": "paragraph_1618453647583_1245968311",
      "id": "paragraph_1617519135225_111573163",
      "dateCreated": "2021-04-15T02:27:27+0000",
      "dateStarted": "2021-04-15T03:39:00+0000",
      "dateFinished": "2021-04-15T03:39:00+0000",
      "status": "FINISHED",
      "$$hashKey": "object:80053"
    },
    {
      "text": "// create datarame for users and ratings against movies\nval ratings = sqlContext.read.format(\"com.databricks.spark.csv\").option(\"delimiter\", \"\\t\").option(\"header\", false).option(\"inferSchema\", true).load(\"u.data\").toDF(\n  \"userid\", \"movieid\", \"rating\", \"timestamp\")",
      "user": "anonymous",
      "dateUpdated": "2021-04-15T03:39:00+0000",
      "config": {
        "editorSetting": {
          "language": "scala",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "colWidth": 12,
        "editorMode": "ace/mode/scala",
        "fontSize": 9,
        "results": {},
        "enabled": true
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "TEXT",
            "data": "\u001b[1m\u001b[34mratings\u001b[0m: \u001b[1m\u001b[32morg.apache.spark.sql.DataFrame\u001b[0m = [userid: int, movieid: int ... 2 more fields]\n"
          }
        ]
      },
      "apps": [],
      "runtimeInfos": {
        "jobUrl": {
          "propertyName": "jobUrl",
          "label": "SPARK JOB",
          "tooltip": "View in Spark web UI",
          "group": "spark",
          "values": [
            {
              "jobUrl": "http://e67d52a5ef45:4040/jobs/job?id=1288",
              "$$hashKey": "object:100029"
            },
            {
              "jobUrl": "http://e67d52a5ef45:4040/jobs/job?id=1289",
              "$$hashKey": "object:100030"
            }
          ],
          "interpreterSettingId": "spark"
        }
      },
      "progressUpdateIntervalMs": 500,
      "jobName": "paragraph_1618453647583_684146701",
      "id": "paragraph_1617518344455_1941976410",
      "dateCreated": "2021-04-15T02:27:27+0000",
      "dateStarted": "2021-04-15T03:39:00+0000",
      "dateFinished": "2021-04-15T03:39:02+0000",
      "status": "FINISHED",
      "$$hashKey": "object:80054"
    },
    {
      "text": "//show top 5\nratings.show(5)",
      "user": "anonymous",
      "dateUpdated": "2021-04-15T03:39:02+0000",
      "config": {
        "editorSetting": {
          "language": "scala",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "colWidth": 12,
        "editorMode": "ace/mode/scala",
        "fontSize": 9,
        "results": {},
        "enabled": true
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "TEXT",
            "data": "+------+-------+------+---------+\n|userid|movieid|rating|timestamp|\n+------+-------+------+---------+\n|   196|    242|     3|881250949|\n|   186|    302|     3|891717742|\n|    22|    377|     1|878887116|\n|   244|     51|     2|880606923|\n|   166|    346|     1|886397596|\n+------+-------+------+---------+\nonly showing top 5 rows\n\n"
          }
        ]
      },
      "apps": [],
      "runtimeInfos": {
        "jobUrl": {
          "propertyName": "jobUrl",
          "label": "SPARK JOB",
          "tooltip": "View in Spark web UI",
          "group": "spark",
          "values": [
            {
              "jobUrl": "http://e67d52a5ef45:4040/jobs/job?id=1290",
              "$$hashKey": "object:100079"
            }
          ],
          "interpreterSettingId": "spark"
        }
      },
      "progressUpdateIntervalMs": 500,
      "jobName": "paragraph_1618453647584_1622899295",
      "id": "paragraph_1617900591916_120338520",
      "dateCreated": "2021-04-15T02:27:27+0000",
      "dateStarted": "2021-04-15T03:39:02+0000",
      "dateFinished": "2021-04-15T03:39:03+0000",
      "status": "FINISHED",
      "$$hashKey": "object:80055"
    },
    {
      "text": "// checking for total number of missing values for each column\r\nimport org.apache.spark.sql.functions.{sum, col}\r\nratings.select(ratings.columns.map(c => sum(col(c).isNull.cast(\"int\")).alias(c)): _*).show\r\n// No missing values identified",
      "user": "anonymous",
      "dateUpdated": "2021-04-15T03:39:03+0000",
      "config": {
        "editorSetting": {
          "language": "scala",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "colWidth": 12,
        "editorMode": "ace/mode/scala",
        "fontSize": 9,
        "results": {},
        "enabled": true
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "TEXT",
            "data": "+------+-------+------+---------+\n|userid|movieid|rating|timestamp|\n+------+-------+------+---------+\n|     0|      0|     0|        0|\n+------+-------+------+---------+\n\nimport org.apache.spark.sql.functions.{sum, col}\n"
          }
        ]
      },
      "apps": [],
      "runtimeInfos": {
        "jobUrl": {
          "propertyName": "jobUrl",
          "label": "SPARK JOB",
          "tooltip": "View in Spark web UI",
          "group": "spark",
          "values": [
            {
              "jobUrl": "http://e67d52a5ef45:4040/jobs/job?id=1291",
              "$$hashKey": "object:100124"
            }
          ],
          "interpreterSettingId": "spark"
        }
      },
      "progressUpdateIntervalMs": 500,
      "jobName": "paragraph_1618453647584_908278114",
      "id": "paragraph_1617900623358_1899383368",
      "dateCreated": "2021-04-15T02:27:27+0000",
      "dateStarted": "2021-04-15T03:39:03+0000",
      "dateFinished": "2021-04-15T03:39:04+0000",
      "status": "FINISHED",
      "$$hashKey": "object:80056"
    },
    {
      "text": "// Assess range of ratings (1 through 5)\nratings.select(\"rating\").groupBy(\"rating\").agg(count(ratings(\"rating\")).\nalias(\"cRating\")).orderBy(desc(\"cRating\")).show(1000)",
      "user": "anonymous",
      "dateUpdated": "2021-04-15T03:39:04+0000",
      "config": {
        "editorSetting": {
          "language": "scala",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "colWidth": 12,
        "editorMode": "ace/mode/scala",
        "fontSize": 9,
        "results": {},
        "enabled": true
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "TEXT",
            "data": "+------+-------+\n|rating|cRating|\n+------+-------+\n|     4|  34174|\n|     3|  27145|\n|     5|  21201|\n|     2|  11370|\n|     1|   6110|\n+------+-------+\n\n"
          }
        ]
      },
      "apps": [],
      "runtimeInfos": {
        "jobUrl": {
          "propertyName": "jobUrl",
          "label": "SPARK JOB",
          "tooltip": "View in Spark web UI",
          "group": "spark",
          "values": [
            {
              "jobUrl": "http://e67d52a5ef45:4040/jobs/job?id=1292",
              "$$hashKey": "object:100171"
            }
          ],
          "interpreterSettingId": "spark"
        }
      },
      "progressUpdateIntervalMs": 500,
      "jobName": "paragraph_1618453647584_1868756540",
      "id": "paragraph_1617901071689_1751207482",
      "dateCreated": "2021-04-15T02:27:27+0000",
      "dateStarted": "2021-04-15T03:39:04+0000",
      "dateFinished": "2021-04-15T03:39:06+0000",
      "status": "FINISHED",
      "$$hashKey": "object:80057"
    },
    {
      "title": "Import movie details",
      "text": "%sh wget --no-check-certificate https://files.grouplens.org/datasets/movielens/ml-100k/u.item",
      "user": "anonymous",
      "dateUpdated": "2021-04-15T03:39:06+0000",
      "config": {
        "editorSetting": {
          "language": "sh",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": false
        },
        "colWidth": 12,
        "editorMode": "ace/mode/sh",
        "fontSize": 9,
        "title": true,
        "results": {},
        "enabled": true
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "TEXT",
            "data": "--2021-04-15 03:39:06--  https://files.grouplens.org/datasets/movielens/ml-100k/u.item\nResolving files.grouplens.org (files.grouplens.org)... 128.101.65.152\nConnecting to files.grouplens.org (files.grouplens.org)|128.101.65.152|:443... connected.\nWARNING: cannot verify files.grouplens.org's certificate, issued by ‘CN=InCommon RSA Server CA,OU=InCommon,O=Internet2,L=Ann Arbor,ST=MI,C=US’:\n  Unable to locally verify the issuer's authority.\nHTTP request sent, awaiting response... 200 OK\nLength: 236344 (231K)\nSaving to: ‘u.item.4’\n\n     0K .......... .......... .......... .......... .......... 21%  221K 1s\n    50K .......... .......... .......... .......... .......... 43%  458K 0s\n   100K .......... .......... .......... .......... .......... 64%  439K 0s\n   150K .......... .......... .......... .......... .......... 86% 6.56M 0s\n   200K .......... .......... ..........                      100%  367K=0.5s\n\n2021-04-15 03:39:07 (427 KB/s) - ‘u.item.4’ saved [236344/236344]\n\n"
          }
        ]
      },
      "apps": [],
      "runtimeInfos": {},
      "progressUpdateIntervalMs": 500,
      "jobName": "paragraph_1618453647584_1693811980",
      "id": "paragraph_1617890523393_990766222",
      "dateCreated": "2021-04-15T02:27:27+0000",
      "dateStarted": "2021-04-15T03:39:06+0000",
      "dateFinished": "2021-04-15T03:39:07+0000",
      "status": "FINISHED",
      "$$hashKey": "object:80058"
    },
    {
      "text": "//creating dataframe for all movie descriptions\n\nval movies = sqlContext.read.format(\"com.databricks.spark.csv\").option(\"delimiter\", \"|\").option(\"header\", false).option(\"inferSchema\", true).load(\"u.item\").toDF(\n  \"movieid\", \"movie_title\", \"release_date\", \"vid_release_date\", \"IMDb_URL\", \"unknown\", \"Action\", \"Adventure\", \"Animation\", \"Children\", \"Comedy\", \"Crime\", \"Documentary\", \"Drama\", \"Fantasy\", \"FilmNoir\", \"Horror\", \"Musical\", \"Mystery\", \"Romance\", \"SciFi\", \"Thriller\", \"War\", \"Western\")",
      "user": "anonymous",
      "dateUpdated": "2021-04-15T03:39:07+0000",
      "config": {
        "editorSetting": {
          "language": "scala",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "colWidth": 12,
        "editorMode": "ace/mode/scala",
        "fontSize": 9,
        "results": {},
        "enabled": true
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "TEXT",
            "data": "\u001b[1m\u001b[34mmovies\u001b[0m: \u001b[1m\u001b[32morg.apache.spark.sql.DataFrame\u001b[0m = [movieid: int, movie_title: string ... 22 more fields]\n"
          }
        ]
      },
      "apps": [],
      "runtimeInfos": {
        "jobUrl": {
          "propertyName": "jobUrl",
          "label": "SPARK JOB",
          "tooltip": "View in Spark web UI",
          "group": "spark",
          "values": [
            {
              "jobUrl": "http://e67d52a5ef45:4040/jobs/job?id=1293",
              "$$hashKey": "object:100261"
            },
            {
              "jobUrl": "http://e67d52a5ef45:4040/jobs/job?id=1294",
              "$$hashKey": "object:100262"
            }
          ],
          "interpreterSettingId": "spark"
        }
      },
      "progressUpdateIntervalMs": 500,
      "jobName": "paragraph_1618453647584_1154846507",
      "id": "paragraph_1617890896264_369713120",
      "dateCreated": "2021-04-15T02:27:27+0000",
      "dateStarted": "2021-04-15T03:39:08+0000",
      "dateFinished": "2021-04-15T03:39:08+0000",
      "status": "FINISHED",
      "$$hashKey": "object:80059"
    },
    {
      "text": "// checking for total number of missing values for each column\r\nimport org.apache.spark.sql.functions.{sum, col}\r\nmovies.select(movies.columns.map(c => sum(col(c).isNull.cast(\"int\")).alias(c)): _*).show\r\n// missing values identified in vid_release_date for every row, 3 missing values in IMDB_url and 1 missing value found for column release date",
      "user": "anonymous",
      "dateUpdated": "2021-04-15T03:39:08+0000",
      "config": {
        "editorSetting": {
          "language": "scala",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "colWidth": 12,
        "editorMode": "ace/mode/scala",
        "fontSize": 9,
        "results": {},
        "enabled": true
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "TEXT",
            "data": "+-------+-----------+------------+----------------+--------+-------+------+---------+---------+--------+------+-----+-----------+-----+-------+--------+------+-------+-------+-------+-----+--------+---+-------+\n|movieid|movie_title|release_date|vid_release_date|IMDb_URL|unknown|Action|Adventure|Animation|Children|Comedy|Crime|Documentary|Drama|Fantasy|FilmNoir|Horror|Musical|Mystery|Romance|SciFi|Thriller|War|Western|\n+-------+-----------+------------+----------------+--------+-------+------+---------+---------+--------+------+-----+-----------+-----+-------+--------+------+-------+-------+-------+-----+--------+---+-------+\n|      0|          0|           1|            1682|       3|      0|     0|        0|        0|       0|     0|    0|          0|    0|      0|       0|     0|      0|      0|      0|    0|       0|  0|      0|\n+-------+-----------+------------+----------------+--------+-------+------+---------+---------+--------+------+-----+-----------+-----+-------+--------+------+-------+-------+-------+-----+--------+---+-------+\n\nimport org.apache.spark.sql.functions.{sum, col}\n"
          }
        ]
      },
      "apps": [],
      "runtimeInfos": {
        "jobUrl": {
          "propertyName": "jobUrl",
          "label": "SPARK JOB",
          "tooltip": "View in Spark web UI",
          "group": "spark",
          "values": [
            {
              "jobUrl": "http://e67d52a5ef45:4040/jobs/job?id=1295",
              "$$hashKey": "object:100311"
            }
          ],
          "interpreterSettingId": "spark"
        }
      },
      "progressUpdateIntervalMs": 500,
      "jobName": "paragraph_1618453647584_1902167423",
      "id": "paragraph_1617905330010_901374831",
      "dateCreated": "2021-04-15T02:27:27+0000",
      "dateStarted": "2021-04-15T03:39:08+0000",
      "dateFinished": "2021-04-15T03:39:09+0000",
      "status": "FINISHED",
      "$$hashKey": "object:80060"
    },
    {
      "text": "//review null row for movies data\nmovies.filter(\"release_date is null\").show",
      "user": "anonymous",
      "dateUpdated": "2021-04-15T03:39:09+0000",
      "config": {
        "editorSetting": {
          "language": "scala",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "colWidth": 12,
        "editorMode": "ace/mode/scala",
        "fontSize": 9,
        "results": {},
        "enabled": true
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "TEXT",
            "data": "+-------+-----------+------------+----------------+--------+-------+------+---------+---------+--------+------+-----+-----------+-----+-------+--------+------+-------+-------+-------+-----+--------+---+-------+\n|movieid|movie_title|release_date|vid_release_date|IMDb_URL|unknown|Action|Adventure|Animation|Children|Comedy|Crime|Documentary|Drama|Fantasy|FilmNoir|Horror|Musical|Mystery|Romance|SciFi|Thriller|War|Western|\n+-------+-----------+------------+----------------+--------+-------+------+---------+---------+--------+------+-----+-----------+-----+-------+--------+------+-------+-------+-------+-----+--------+---+-------+\n|    267|    unknown|        null|            null|    null|      1|     0|        0|        0|       0|     0|    0|          0|    0|      0|       0|     0|      0|      0|      0|    0|       0|  0|      0|\n+-------+-----------+------------+----------------+--------+-------+------+---------+---------+--------+------+-----+-----------+-----+-------+--------+------+-------+-------+-------+-----+--------+---+-------+\n\n"
          }
        ]
      },
      "apps": [],
      "runtimeInfos": {
        "jobUrl": {
          "propertyName": "jobUrl",
          "label": "SPARK JOB",
          "tooltip": "View in Spark web UI",
          "group": "spark",
          "values": [
            {
              "jobUrl": "http://e67d52a5ef45:4040/jobs/job?id=1296",
              "$$hashKey": "object:100356"
            }
          ],
          "interpreterSettingId": "spark"
        }
      },
      "progressUpdateIntervalMs": 500,
      "jobName": "paragraph_1618453647585_1805611818",
      "id": "paragraph_1618106638993_819071699",
      "dateCreated": "2021-04-15T02:27:27+0000",
      "dateStarted": "2021-04-15T03:39:09+0000",
      "dateFinished": "2021-04-15T03:39:10+0000",
      "status": "FINISHED",
      "$$hashKey": "object:80061"
    },
    {
      "text": "//replace null value with 0\nval movies3 = movies.withColumn(\"release_date\", when(col(\"release_date\").isNull, 0) otherwise col(\"release_date\"))",
      "user": "anonymous",
      "dateUpdated": "2021-04-15T03:39:10+0000",
      "config": {
        "editorSetting": {
          "language": "scala",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "colWidth": 12,
        "editorMode": "ace/mode/scala",
        "fontSize": 9,
        "results": {},
        "enabled": true
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "TEXT",
            "data": "\u001b[1m\u001b[34mmovies3\u001b[0m: \u001b[1m\u001b[32morg.apache.spark.sql.DataFrame\u001b[0m = [movieid: int, movie_title: string ... 22 more fields]\n"
          }
        ]
      },
      "apps": [],
      "runtimeInfos": {},
      "progressUpdateIntervalMs": 500,
      "jobName": "paragraph_1618453647585_1783672126",
      "id": "paragraph_1618107442122_389129484",
      "dateCreated": "2021-04-15T02:27:27+0000",
      "dateStarted": "2021-04-15T03:39:10+0000",
      "dateFinished": "2021-04-15T03:39:10+0000",
      "status": "FINISHED",
      "$$hashKey": "object:80062"
    },
    {
      "text": "//replace null value with 0\nval movies = movies3.withColumn(\"IMDb_URL\", when(col(\"IMDb_URL\").isNull, 0) otherwise col(\"IMDb_URL\"))",
      "user": "anonymous",
      "dateUpdated": "2021-04-15T03:39:10+0000",
      "config": {
        "editorSetting": {
          "language": "scala",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "colWidth": 12,
        "editorMode": "ace/mode/scala",
        "fontSize": 9,
        "results": {},
        "enabled": true
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "TEXT",
            "data": "\u001b[1m\u001b[34mmovies\u001b[0m: \u001b[1m\u001b[32morg.apache.spark.sql.DataFrame\u001b[0m = [movieid: int, movie_title: string ... 22 more fields]\n"
          }
        ]
      },
      "apps": [],
      "runtimeInfos": {},
      "progressUpdateIntervalMs": 500,
      "jobName": "paragraph_1618453647585_1689491128",
      "id": "paragraph_1618107446435_320414795",
      "dateCreated": "2021-04-15T02:27:27+0000",
      "dateStarted": "2021-04-15T03:39:10+0000",
      "dateFinished": "2021-04-15T03:39:11+0000",
      "status": "FINISHED",
      "$$hashKey": "object:80063"
    },
    {
      "text": "// checking for total number of missing values for each column\r\nimport org.apache.spark.sql.functions.{sum, col}\r\nmovies.select(movies.columns.map(c => sum(col(c).isNull.cast(\"int\")).alias(c)): _*).show\r\n// missing values identified in vid_release_date for every row, 3 missing values in IMDB_url and 1 missing value found for column release date",
      "user": "anonymous",
      "dateUpdated": "2021-04-15T03:39:11+0000",
      "config": {
        "editorSetting": {
          "language": "scala",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "colWidth": 12,
        "editorMode": "ace/mode/scala",
        "fontSize": 9,
        "results": {},
        "enabled": true
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "TEXT",
            "data": "+-------+-----------+------------+----------------+--------+-------+------+---------+---------+--------+------+-----+-----------+-----+-------+--------+------+-------+-------+-------+-----+--------+---+-------+\n|movieid|movie_title|release_date|vid_release_date|IMDb_URL|unknown|Action|Adventure|Animation|Children|Comedy|Crime|Documentary|Drama|Fantasy|FilmNoir|Horror|Musical|Mystery|Romance|SciFi|Thriller|War|Western|\n+-------+-----------+------------+----------------+--------+-------+------+---------+---------+--------+------+-----+-----------+-----+-------+--------+------+-------+-------+-------+-----+--------+---+-------+\n|      0|          0|           0|            1682|       0|      0|     0|        0|        0|       0|     0|    0|          0|    0|      0|       0|     0|      0|      0|      0|    0|       0|  0|      0|\n+-------+-----------+------------+----------------+--------+-------+------+---------+---------+--------+------+-----+-----------+-----+-------+--------+------+-------+-------+-------+-----+--------+---+-------+\n\nimport org.apache.spark.sql.functions.{sum, col}\n"
          }
        ]
      },
      "apps": [],
      "runtimeInfos": {
        "jobUrl": {
          "propertyName": "jobUrl",
          "label": "SPARK JOB",
          "tooltip": "View in Spark web UI",
          "group": "spark",
          "values": [
            {
              "jobUrl": "http://e67d52a5ef45:4040/jobs/job?id=1297",
              "$$hashKey": "object:100451"
            }
          ],
          "interpreterSettingId": "spark"
        }
      },
      "progressUpdateIntervalMs": 500,
      "jobName": "paragraph_1618453647585_78049308",
      "id": "paragraph_1618105517252_144320261",
      "dateCreated": "2021-04-15T02:27:27+0000",
      "dateStarted": "2021-04-15T03:39:11+0000",
      "dateFinished": "2021-04-15T03:39:12+0000",
      "status": "FINISHED",
      "$$hashKey": "object:80064"
    },
    {
      "text": "// Only dropping release date column as it does not have any data whatsoever\nval movies1 = movies.drop(\"vid_release_date\")\n",
      "user": "anonymous",
      "dateUpdated": "2021-04-15T03:39:12+0000",
      "config": {
        "editorSetting": {
          "language": "scala",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "colWidth": 12,
        "editorMode": "ace/mode/scala",
        "fontSize": 9,
        "results": {},
        "enabled": true
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "TEXT",
            "data": "\u001b[1m\u001b[34mmovies1\u001b[0m: \u001b[1m\u001b[32morg.apache.spark.sql.DataFrame\u001b[0m = [movieid: int, movie_title: string ... 21 more fields]\n"
          }
        ]
      },
      "apps": [],
      "runtimeInfos": {},
      "progressUpdateIntervalMs": 500,
      "jobName": "paragraph_1618453647585_468097307",
      "id": "paragraph_1617907141031_1579372018",
      "dateCreated": "2021-04-15T02:27:27+0000",
      "dateStarted": "2021-04-15T03:39:12+0000",
      "dateFinished": "2021-04-15T03:39:13+0000",
      "status": "FINISHED",
      "$$hashKey": "object:80065"
    },
    {
      "text": "//renaming dataframe\nval movies = movies1",
      "user": "anonymous",
      "dateUpdated": "2021-04-15T03:39:13+0000",
      "config": {
        "editorSetting": {
          "language": "scala",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "colWidth": 12,
        "editorMode": "ace/mode/scala",
        "fontSize": 9,
        "results": {},
        "enabled": true
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "TEXT",
            "data": "\u001b[1m\u001b[34mmovies\u001b[0m: \u001b[1m\u001b[32morg.apache.spark.sql.DataFrame\u001b[0m = [movieid: int, movie_title: string ... 21 more fields]\n"
          }
        ]
      },
      "apps": [],
      "runtimeInfos": {},
      "progressUpdateIntervalMs": 500,
      "jobName": "paragraph_1618453647585_1268858171",
      "id": "paragraph_1617907221992_820441480",
      "dateCreated": "2021-04-15T02:27:27+0000",
      "dateStarted": "2021-04-15T03:39:13+0000",
      "dateFinished": "2021-04-15T03:39:14+0000",
      "status": "FINISHED",
      "$$hashKey": "object:80066"
    },
    {
      "text": "//showing 5 rows\nmovies.show(5)",
      "user": "anonymous",
      "dateUpdated": "2021-04-15T03:39:14+0000",
      "config": {
        "editorSetting": {
          "language": "scala",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "colWidth": 12,
        "editorMode": "ace/mode/scala",
        "fontSize": 9,
        "results": {},
        "enabled": true
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "TEXT",
            "data": "+-------+-----------------+------------+--------------------+-------+------+---------+---------+--------+------+-----+-----------+-----+-------+--------+------+-------+-------+-------+-----+--------+---+-------+\n|movieid|      movie_title|release_date|            IMDb_URL|unknown|Action|Adventure|Animation|Children|Comedy|Crime|Documentary|Drama|Fantasy|FilmNoir|Horror|Musical|Mystery|Romance|SciFi|Thriller|War|Western|\n+-------+-----------------+------------+--------------------+-------+------+---------+---------+--------+------+-----+-----------+-----+-------+--------+------+-------+-------+-------+-----+--------+---+-------+\n|      1| Toy Story (1995)| 01-Jan-1995|http://us.imdb.co...|      0|     0|        0|        1|       1|     1|    0|          0|    0|      0|       0|     0|      0|      0|      0|    0|       0|  0|      0|\n|      2| GoldenEye (1995)| 01-Jan-1995|http://us.imdb.co...|      0|     1|        1|        0|       0|     0|    0|          0|    0|      0|       0|     0|      0|      0|      0|    0|       1|  0|      0|\n|      3|Four Rooms (1995)| 01-Jan-1995|http://us.imdb.co...|      0|     0|        0|        0|       0|     0|    0|          0|    0|      0|       0|     0|      0|      0|      0|    0|       1|  0|      0|\n|      4|Get Shorty (1995)| 01-Jan-1995|http://us.imdb.co...|      0|     1|        0|        0|       0|     1|    0|          0|    1|      0|       0|     0|      0|      0|      0|    0|       0|  0|      0|\n|      5|   Copycat (1995)| 01-Jan-1995|http://us.imdb.co...|      0|     0|        0|        0|       0|     0|    1|          0|    1|      0|       0|     0|      0|      0|      0|    0|       1|  0|      0|\n+-------+-----------------+------------+--------------------+-------+------+---------+---------+--------+------+-----+-----------+-----+-------+--------+------+-------+-------+-------+-----+--------+---+-------+\nonly showing top 5 rows\n\n"
          }
        ]
      },
      "apps": [],
      "runtimeInfos": {
        "jobUrl": {
          "propertyName": "jobUrl",
          "label": "SPARK JOB",
          "tooltip": "View in Spark web UI",
          "group": "spark",
          "values": [
            {
              "jobUrl": "http://e67d52a5ef45:4040/jobs/job?id=1298",
              "$$hashKey": "object:100537"
            }
          ],
          "interpreterSettingId": "spark"
        }
      },
      "progressUpdateIntervalMs": 500,
      "jobName": "paragraph_1618453647586_56783150",
      "id": "paragraph_1617892243158_2103658284",
      "dateCreated": "2021-04-15T02:27:27+0000",
      "dateStarted": "2021-04-15T03:39:14+0000",
      "dateFinished": "2021-04-15T03:39:15+0000",
      "status": "FINISHED",
      "$$hashKey": "object:80067"
    },
    {
      "text": "// Total Number of columns\nmovies.columns.size",
      "user": "anonymous",
      "dateUpdated": "2021-04-15T03:39:15+0000",
      "config": {
        "editorSetting": {
          "language": "scala",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "colWidth": 12,
        "editorMode": "ace/mode/scala",
        "fontSize": 9,
        "results": {},
        "enabled": true
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "TEXT",
            "data": "\u001b[1m\u001b[34mres352\u001b[0m: \u001b[1m\u001b[32mInt\u001b[0m = 23\n"
          }
        ]
      },
      "apps": [],
      "runtimeInfos": {},
      "progressUpdateIntervalMs": 500,
      "jobName": "paragraph_1618453647586_1399407085",
      "id": "paragraph_1617906033778_653373258",
      "dateCreated": "2021-04-15T02:27:27+0000",
      "dateStarted": "2021-04-15T03:39:15+0000",
      "dateFinished": "2021-04-15T03:39:16+0000",
      "status": "FINISHED",
      "$$hashKey": "object:80068"
    },
    {
      "text": "// Total number of rows\nmovies.count",
      "user": "anonymous",
      "dateUpdated": "2021-04-15T03:39:16+0000",
      "config": {
        "editorSetting": {
          "language": "scala",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "colWidth": 12,
        "editorMode": "ace/mode/scala",
        "fontSize": 9,
        "results": {},
        "enabled": true
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "TEXT",
            "data": "\u001b[1m\u001b[34mres353\u001b[0m: \u001b[1m\u001b[32mLong\u001b[0m = 1682\n"
          }
        ]
      },
      "apps": [],
      "runtimeInfos": {
        "jobUrl": {
          "propertyName": "jobUrl",
          "label": "SPARK JOB",
          "tooltip": "View in Spark web UI",
          "group": "spark",
          "values": [
            {
              "jobUrl": "http://e67d52a5ef45:4040/jobs/job?id=1299",
              "$$hashKey": "object:100575"
            }
          ],
          "interpreterSettingId": "spark"
        }
      },
      "progressUpdateIntervalMs": 500,
      "jobName": "paragraph_1618453647586_592026178",
      "id": "paragraph_1617906169679_257652783",
      "dateCreated": "2021-04-15T02:27:27+0000",
      "dateStarted": "2021-04-15T03:39:16+0000",
      "dateFinished": "2021-04-15T03:39:17+0000",
      "status": "FINISHED",
      "$$hashKey": "object:80069"
    },
    {
      "text": "//creating index variables for each column\nval mindexers = for {column <- List(\"movieid\", \"movie_title\", \"release_date\", \"IMDb_URL\", \"unknown\", \"Action\", \"Adventure\", \"Animation\", \"Children\", \"Comedy\", \"Crime\", \"Documentary\", \"Drama\", \"Fantasy\", \"FilmNoir\", \"Horror\", \"Musical\", \"Mystery\", \"Romance\", \"SciFi\", \"Thriller\", \"War\", \"Western\")} yield new StringIndexer().setInputCol(column).setOutputCol(column+\"_index\")\nval pipeline = new Pipeline().setStages(mindexers.toArray)",
      "user": "anonymous",
      "dateUpdated": "2021-04-15T03:39:17+0000",
      "config": {
        "editorSetting": {
          "language": "scala",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "colWidth": 12,
        "editorMode": "ace/mode/scala",
        "fontSize": 9,
        "results": {},
        "enabled": true
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "TEXT",
            "data": "\u001b[1m\u001b[34mmindexers\u001b[0m: \u001b[1m\u001b[32mList[org.apache.spark.ml.feature.StringIndexer]\u001b[0m = List(strIdx_3fa33b0bc7b6, strIdx_d9dd254c933b, strIdx_276e78d7d666, strIdx_5fcffa1eceb4, strIdx_76a3c5c9467f, strIdx_6f7f8c74877e, strIdx_3f2fc4f7e164, strIdx_580d9cc9ce8c, strIdx_05f06c394423, strIdx_96ffb7aa850d, strIdx_fedb09c0dee1, strIdx_0f2a8d8c3794, strIdx_58b579fa3bac, strIdx_8f7e3e59a01f, strIdx_05f8118cc0b9, strIdx_f8fa20618595, strIdx_132594873955, strIdx_47e5771ac067, strIdx_9fefc09b4768, strIdx_346a415607f7, strIdx_cebc4c08a025, strIdx_8b97656e0b49, strIdx_8f008c12143e)\n\u001b[1m\u001b[34mpipeline\u001b[0m: \u001b[1m\u001b[32morg.apache.spark.ml.Pipeline\u001b[0m = pipeline_c92a7850ed55\n"
          }
        ]
      },
      "apps": [],
      "runtimeInfos": {},
      "progressUpdateIntervalMs": 500,
      "jobName": "paragraph_1618453647586_676809335",
      "id": "paragraph_1617943977640_513851503",
      "dateCreated": "2021-04-15T02:27:27+0000",
      "dateStarted": "2021-04-15T03:39:17+0000",
      "dateFinished": "2021-04-15T03:39:18+0000",
      "status": "FINISHED",
      "$$hashKey": "object:80070"
    },
    {
      "text": "//fitting index columns to dataset\nval movies1 = pipeline.fit(movies).transform(movies)\nmovies1.show()",
      "user": "anonymous",
      "dateUpdated": "2021-04-15T03:39:18+0000",
      "config": {
        "editorSetting": {
          "language": "scala",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "colWidth": 12,
        "editorMode": "ace/mode/scala",
        "fontSize": 9,
        "results": {},
        "enabled": true
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "TEXT",
            "data": "+-------+--------------------+------------+--------------------+-------+------+---------+---------+--------+------+-----+-----------+-----+-------+--------+------+-------+-------+-------+-----+--------+---+-------+-------------+-----------------+------------------+--------------+-------------+------------+---------------+---------------+--------------+------------+-----------+-----------------+-----------+-------------+--------------+------------+-------------+-------------+-------------+-----------+--------------+---------+-------------+\n|movieid|         movie_title|release_date|            IMDb_URL|unknown|Action|Adventure|Animation|Children|Comedy|Crime|Documentary|Drama|Fantasy|FilmNoir|Horror|Musical|Mystery|Romance|SciFi|Thriller|War|Western|movieid_index|movie_title_index|release_date_index|IMDb_URL_index|unknown_index|Action_index|Adventure_index|Animation_index|Children_index|Comedy_index|Crime_index|Documentary_index|Drama_index|Fantasy_index|FilmNoir_index|Horror_index|Musical_index|Mystery_index|Romance_index|SciFi_index|Thriller_index|War_index|Western_index|\n+-------+--------------------+------------+--------------------+-------+------+---------+---------+--------+------+-----+-----------+-----+-------+--------+------+-------+-------+-------+-----+--------+---+-------+-------------+-----------------+------------------+--------------+-------------+------------+---------------+---------------+--------------+------------+-----------+-----------------+-----------+-------------+--------------+------------+-------------+-------------+-------------+-----------+--------------+---------+-------------+\n|      1|    Toy Story (1995)| 01-Jan-1995|http://us.imdb.co...|      0|     0|        0|        1|       1|     1|    0|          0|    0|      0|       0|     0|      0|      0|      0|    0|       0|  0|      0|        902.0|             37.0|               0.0|        1138.0|          0.0|         0.0|            0.0|            1.0|           1.0|         1.0|        0.0|              0.0|        0.0|          0.0|           0.0|         0.0|          0.0|          0.0|          0.0|        0.0|           0.0|      0.0|          0.0|\n|      2|    GoldenEye (1995)| 01-Jan-1995|http://us.imdb.co...|      0|     1|        1|        0|       0|     0|    0|          0|    0|      0|       0|     0|      0|      0|      0|    0|       1|  0|      0|       1191.0|            461.0|               0.0|         364.0|          0.0|         1.0|            1.0|            0.0|           0.0|         0.0|        0.0|              0.0|        0.0|          0.0|           0.0|         0.0|          0.0|          0.0|          0.0|        0.0|           1.0|      0.0|          0.0|\n|      3|   Four Rooms (1995)| 01-Jan-1995|http://us.imdb.co...|      0|     0|        0|        0|       0|     0|    0|          0|    0|      0|       0|     0|      0|      0|      0|    0|       1|  0|      0|       1491.0|            822.0|               0.0|         108.0|          0.0|         0.0|            0.0|            0.0|           0.0|         0.0|        0.0|              0.0|        0.0|          0.0|           0.0|         0.0|          0.0|          0.0|          0.0|        0.0|           1.0|      0.0|          0.0|\n|      4|   Get Shorty (1995)| 01-Jan-1995|http://us.imdb.co...|      0|     1|        0|        0|       0|     1|    0|          0|    1|      0|       0|     0|      0|      0|      0|    0|       0|  0|      0|        192.0|            541.0|               0.0|        1434.0|          0.0|         1.0|            0.0|            0.0|           0.0|         1.0|        0.0|              0.0|        1.0|          0.0|           0.0|         0.0|          0.0|          0.0|          0.0|        0.0|           0.0|      0.0|          0.0|\n|      5|      Copycat (1995)| 01-Jan-1995|http://us.imdb.co...|      0|     0|        0|        0|       0|     0|    1|          0|    1|      0|       0|     0|      0|      0|      0|    0|       1|  0|      0|        603.0|             99.0|               0.0|        1144.0|          0.0|         0.0|            0.0|            0.0|           0.0|         0.0|        1.0|              0.0|        1.0|          0.0|           0.0|         0.0|          0.0|          0.0|          0.0|        0.0|           1.0|      0.0|          0.0|\n|      6|Shanghai Triad (Y...| 01-Jan-1995|http://us.imdb.co...|      0|     0|        0|        0|       0|     0|    0|          0|    1|      0|       0|     0|      0|      0|      0|    0|       0|  0|      0|        878.0|           1659.0|               0.0|         578.0|          0.0|         0.0|            0.0|            0.0|           0.0|         0.0|        0.0|              0.0|        1.0|          0.0|           0.0|         0.0|          0.0|          0.0|          0.0|        0.0|           0.0|      0.0|          0.0|\n|      7|Twelve Monkeys (1...| 01-Jan-1995|http://us.imdb.co...|      0|     0|        0|        0|       0|     0|    0|          0|    1|      0|       0|     0|      0|      0|      0|    1|       0|  0|      0|       1390.0|            951.0|               0.0|         462.0|          0.0|         0.0|            0.0|            0.0|           0.0|         0.0|        0.0|              0.0|        1.0|          0.0|           0.0|         0.0|          0.0|          0.0|          0.0|        1.0|           0.0|      0.0|          0.0|\n|      8|         Babe (1995)| 01-Jan-1995|http://us.imdb.co...|      0|     0|        0|        0|       1|     1|    0|          0|    1|      0|       0|     0|      0|      0|      0|    0|       0|  0|      0|        102.0|           1454.0|               0.0|         425.0|          0.0|         0.0|            0.0|            0.0|           1.0|         1.0|        0.0|              0.0|        1.0|          0.0|           0.0|         0.0|          0.0|          0.0|          0.0|        0.0|           0.0|      0.0|          0.0|\n|      9|Dead Man Walking ...| 01-Jan-1995|http://us.imdb.co...|      0|     0|        0|        0|       0|     0|    0|          0|    1|      0|       0|     0|      0|      0|      0|    0|       0|  0|      0|        303.0|           1452.0|               0.0|         573.0|          0.0|         0.0|            0.0|            0.0|           0.0|         0.0|        0.0|              0.0|        1.0|          0.0|           0.0|         0.0|          0.0|          0.0|          0.0|        0.0|           0.0|      0.0|          0.0|\n|     10|  Richard III (1995)| 22-Jan-1996|http://us.imdb.co...|      0|     0|        0|        0|       0|     0|    0|          0|    1|      0|       0|     0|      0|      0|      0|    0|       0|  1|      0|        629.0|           1448.0|             202.0|         928.0|          0.0|         0.0|            0.0|            0.0|           0.0|         0.0|        0.0|              0.0|        1.0|          0.0|           0.0|         0.0|          0.0|          0.0|          0.0|        0.0|           0.0|      1.0|          0.0|\n|     11|Seven (Se7en) (1995)| 01-Jan-1995|http://us.imdb.co...|      0|     0|        0|        0|       0|     0|    1|          0|    0|      0|       0|     0|      0|      0|      0|    0|       1|  0|      0|        290.0|            523.0|               0.0|        1341.0|          0.0|         0.0|            0.0|            0.0|           0.0|         0.0|        1.0|              0.0|        0.0|          0.0|           0.0|         0.0|          0.0|          0.0|          0.0|        0.0|           1.0|      0.0|          0.0|\n|     12|Usual Suspects, T...| 14-Aug-1995|http://us.imdb.co...|      0|     0|        0|        0|       0|     0|    1|          0|    0|      0|       0|     0|      0|      0|      0|    0|       1|  0|      0|         74.0|            532.0|             183.0|        1277.0|          0.0|         0.0|            0.0|            0.0|           0.0|         0.0|        1.0|              0.0|        0.0|          0.0|           0.0|         0.0|          0.0|          0.0|          0.0|        0.0|           1.0|      0.0|          0.0|\n|     13|Mighty Aphrodite ...| 30-Oct-1995|http://us.imdb.co...|      0|     0|        0|        0|       0|     1|    0|          0|    0|      0|       0|     0|      0|      0|      0|    0|       0|  0|      0|        491.0|           1086.0|             226.0|        1288.0|          0.0|         0.0|            0.0|            0.0|           0.0|         1.0|        0.0|              0.0|        0.0|          0.0|           0.0|         0.0|          0.0|          0.0|          0.0|        0.0|           0.0|      0.0|          0.0|\n|     14|  Postino, Il (1994)| 01-Jan-1994|http://us.imdb.co...|      0|     0|        0|        0|       0|     0|    0|          0|    1|      0|       0|     0|      0|      0|      1|    0|       0|  0|      0|        969.0|           1555.0|               1.0|        1497.0|          0.0|         0.0|            0.0|            0.0|           0.0|         0.0|        0.0|              0.0|        1.0|          0.0|           0.0|         0.0|          0.0|          0.0|          1.0|        0.0|           0.0|      0.0|          0.0|\n|     15|Mr. Holland's Opu...| 29-Jan-1996|http://us.imdb.co...|      0|     0|        0|        0|       0|     0|    0|          0|    1|      0|       0|     0|      0|      0|      0|    0|       0|  0|      0|        280.0|            537.0|             229.0|         974.0|          0.0|         0.0|            0.0|            0.0|           0.0|         0.0|        0.0|              0.0|        1.0|          0.0|           0.0|         0.0|          0.0|          0.0|          0.0|        0.0|           0.0|      0.0|          0.0|\n|     16|French Twist (Gaz...| 01-Jan-1995|http://us.imdb.co...|      0|     0|        0|        0|       0|     1|    0|          0|    0|      0|       0|     0|      0|      0|      1|    0|       0|  0|      0|        567.0|           1511.0|               0.0|         824.0|          0.0|         0.0|            0.0|            0.0|           0.0|         1.0|        0.0|              0.0|        0.0|          0.0|           0.0|         0.0|          0.0|          0.0|          1.0|        0.0|           0.0|      0.0|          0.0|\n|     17|From Dusk Till Da...| 05-Feb-1996|http://us.imdb.co...|      0|     1|        0|        0|       0|     1|    1|          0|    0|      0|       0|     1|      0|      0|      0|    0|       1|  0|      0|        947.0|            943.0|             170.0|         315.0|          0.0|         1.0|            0.0|            0.0|           0.0|         1.0|        1.0|              0.0|        0.0|          0.0|           0.0|         1.0|          0.0|          0.0|          0.0|        0.0|           1.0|      0.0|          0.0|\n|     18|White Balloon, Th...| 01-Jan-1995|http://us.imdb.co...|      0|     0|        0|        0|       0|     0|    0|          0|    1|      0|       0|     0|      0|      0|      0|    0|       0|  0|      0|       1344.0|           1273.0|               0.0|         826.0|          0.0|         0.0|            0.0|            0.0|           0.0|         0.0|        0.0|              0.0|        1.0|          0.0|           0.0|         0.0|          0.0|          0.0|          0.0|        0.0|           0.0|      0.0|          0.0|\n|     19|Antonia's Line (1...| 01-Jan-1995|http://us.imdb.co...|      0|     0|        0|        0|       0|     0|    0|          0|    1|      0|       0|     0|      0|      0|      0|    0|       0|  0|      0|        160.0|            381.0|               0.0|        1003.0|          0.0|         0.0|            0.0|            0.0|           0.0|         0.0|        0.0|              0.0|        1.0|          0.0|           0.0|         0.0|          0.0|          0.0|          0.0|        0.0|           0.0|      0.0|          0.0|\n|     20|Angels and Insect...| 01-Jan-1995|http://us.imdb.co...|      0|     0|        0|        0|       0|     0|    0|          0|    1|      0|       0|     0|      0|      0|      1|    0|       0|  0|      0|       1142.0|            347.0|               0.0|        1312.0|          0.0|         0.0|            0.0|            0.0|           0.0|         0.0|        0.0|              0.0|        1.0|          0.0|           0.0|         0.0|          0.0|          0.0|          1.0|        0.0|           0.0|      0.0|          0.0|\n+-------+--------------------+------------+--------------------+-------+------+---------+---------+--------+------+-----+-----------+-----+-------+--------+------+-------+-------+-------+-----+--------+---+-------+-------------+-----------------+------------------+--------------+-------------+------------+---------------+---------------+--------------+------------+-----------+-----------------+-----------+-------------+--------------+------------+-------------+-------------+-------------+-----------+--------------+---------+-------------+\nonly showing top 20 rows\n\n\u001b[1m\u001b[34mmovies1\u001b[0m: \u001b[1m\u001b[32morg.apache.spark.sql.DataFrame\u001b[0m = [movieid: int, movie_title: string ... 44 more fields]\n"
          }
        ]
      },
      "apps": [],
      "runtimeInfos": {
        "jobUrl": {
          "propertyName": "jobUrl",
          "label": "SPARK JOB",
          "tooltip": "View in Spark web UI",
          "group": "spark",
          "values": [
            {
              "jobUrl": "http://e67d52a5ef45:4040/jobs/job?id=1300",
              "$$hashKey": "object:101648"
            },
            {
              "jobUrl": "http://e67d52a5ef45:4040/jobs/job?id=1301",
              "$$hashKey": "object:101649"
            },
            {
              "jobUrl": "http://e67d52a5ef45:4040/jobs/job?id=1302",
              "$$hashKey": "object:101650"
            },
            {
              "jobUrl": "http://e67d52a5ef45:4040/jobs/job?id=1303",
              "$$hashKey": "object:101651"
            },
            {
              "jobUrl": "http://e67d52a5ef45:4040/jobs/job?id=1304",
              "$$hashKey": "object:101652"
            },
            {
              "jobUrl": "http://e67d52a5ef45:4040/jobs/job?id=1305",
              "$$hashKey": "object:101653"
            },
            {
              "jobUrl": "http://e67d52a5ef45:4040/jobs/job?id=1306",
              "$$hashKey": "object:101654"
            },
            {
              "jobUrl": "http://e67d52a5ef45:4040/jobs/job?id=1307",
              "$$hashKey": "object:101655"
            },
            {
              "jobUrl": "http://e67d52a5ef45:4040/jobs/job?id=1308",
              "$$hashKey": "object:101656"
            },
            {
              "jobUrl": "http://e67d52a5ef45:4040/jobs/job?id=1309",
              "$$hashKey": "object:101657"
            },
            {
              "jobUrl": "http://e67d52a5ef45:4040/jobs/job?id=1310",
              "$$hashKey": "object:101658"
            },
            {
              "jobUrl": "http://e67d52a5ef45:4040/jobs/job?id=1311",
              "$$hashKey": "object:101659"
            },
            {
              "jobUrl": "http://e67d52a5ef45:4040/jobs/job?id=1312",
              "$$hashKey": "object:101660"
            },
            {
              "jobUrl": "http://e67d52a5ef45:4040/jobs/job?id=1313",
              "$$hashKey": "object:101661"
            },
            {
              "jobUrl": "http://e67d52a5ef45:4040/jobs/job?id=1314",
              "$$hashKey": "object:101662"
            },
            {
              "jobUrl": "http://e67d52a5ef45:4040/jobs/job?id=1315",
              "$$hashKey": "object:101663"
            },
            {
              "jobUrl": "http://e67d52a5ef45:4040/jobs/job?id=1316",
              "$$hashKey": "object:101664"
            },
            {
              "jobUrl": "http://e67d52a5ef45:4040/jobs/job?id=1317",
              "$$hashKey": "object:101665"
            },
            {
              "jobUrl": "http://e67d52a5ef45:4040/jobs/job?id=1318",
              "$$hashKey": "object:101666"
            },
            {
              "jobUrl": "http://e67d52a5ef45:4040/jobs/job?id=1319",
              "$$hashKey": "object:101667"
            },
            {
              "jobUrl": "http://e67d52a5ef45:4040/jobs/job?id=1320",
              "$$hashKey": "object:101668"
            },
            {
              "jobUrl": "http://e67d52a5ef45:4040/jobs/job?id=1321",
              "$$hashKey": "object:101669"
            },
            {
              "jobUrl": "http://e67d52a5ef45:4040/jobs/job?id=1322",
              "$$hashKey": "object:101670"
            },
            {
              "jobUrl": "http://e67d52a5ef45:4040/jobs/job?id=1323",
              "$$hashKey": "object:101671"
            }
          ],
          "interpreterSettingId": "spark"
        }
      },
      "progressUpdateIntervalMs": 500,
      "jobName": "paragraph_1618453647587_49438218",
      "id": "paragraph_1617944047647_177338603",
      "dateCreated": "2021-04-15T02:27:27+0000",
      "dateStarted": "2021-04-15T03:39:18+0000",
      "dateFinished": "2021-04-15T03:39:25+0000",
      "status": "FINISHED",
      "$$hashKey": "object:80071"
    },
    {
      "text": "//dropping irrelevant columns not equired for cluster\nval m_features = movies1.drop(\"movieid\", \"movieid_index\", \"movie_title\", \"release_date\", \"IMDb_URL\", \"unknown\", \"Action\", \"Adventure\", \"Animation\", \"Children\", \"Comedy\", \"Crime\", \"Documentary\", \"Drama\", \"Fantasy\", \"FilmNoir\", \"Horror\", \"Musical\", \"Mystery\", \"Romance\", \"SciFi\", \"Thriller\", \"War\", \"Western\")\nm_features.columns",
      "user": "anonymous",
      "dateUpdated": "2021-04-15T03:39:25+0000",
      "config": {
        "editorSetting": {
          "language": "scala",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "colWidth": 12,
        "editorMode": "ace/mode/scala",
        "fontSize": 9,
        "results": {},
        "enabled": true
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "TEXT",
            "data": "\u001b[1m\u001b[34mm_features\u001b[0m: \u001b[1m\u001b[32morg.apache.spark.sql.DataFrame\u001b[0m = [movie_title_index: double, release_date_index: double ... 20 more fields]\n\u001b[1m\u001b[34mres355\u001b[0m: \u001b[1m\u001b[32mArray[String]\u001b[0m = Array(movie_title_index, release_date_index, IMDb_URL_index, unknown_index, Action_index, Adventure_index, Animation_index, Children_index, Comedy_index, Crime_index, Documentary_index, Drama_index, Fantasy_index, FilmNoir_index, Horror_index, Musical_index, Mystery_index, Romance_index, SciFi_index, Thriller_index, War_index, Western_index)\n"
          }
        ]
      },
      "apps": [],
      "runtimeInfos": {},
      "progressUpdateIntervalMs": 500,
      "jobName": "paragraph_1618453647587_2009427774",
      "id": "paragraph_1617944222467_1087196238",
      "dateCreated": "2021-04-15T02:27:27+0000",
      "dateStarted": "2021-04-15T03:39:25+0000",
      "dateFinished": "2021-04-15T03:39:25+0000",
      "status": "FINISHED",
      "$$hashKey": "object:80072"
    },
    {
      "text": "//dropping irrelevant columns bu maintaining movie id\nval minfo = movies1.drop(\"movieid_index\", \"movie_title\", \"release_date\", \"IMDb_URL\", \"unknown\", \"Action\", \"Adventure\", \"Animation\", \"Children\", \"Comedy\", \"Crime\", \"Documentary\", \"Drama\", \"Fantasy\", \"FilmNoir\", \"Horror\", \"Musical\", \"Mystery\", \"Romance\", \"SciFi\", \"Thriller\", \"War\", \"Western\")\nminfo.columns",
      "user": "anonymous",
      "dateUpdated": "2021-04-15T03:39:26+0000",
      "config": {
        "editorSetting": {
          "language": "scala",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "colWidth": 12,
        "editorMode": "ace/mode/scala",
        "fontSize": 9,
        "results": {},
        "enabled": true
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "TEXT",
            "data": "\u001b[1m\u001b[34mminfo\u001b[0m: \u001b[1m\u001b[32morg.apache.spark.sql.DataFrame\u001b[0m = [movieid: int, movie_title_index: double ... 21 more fields]\n\u001b[1m\u001b[34mres356\u001b[0m: \u001b[1m\u001b[32mArray[String]\u001b[0m = Array(movieid, movie_title_index, release_date_index, IMDb_URL_index, unknown_index, Action_index, Adventure_index, Animation_index, Children_index, Comedy_index, Crime_index, Documentary_index, Drama_index, Fantasy_index, FilmNoir_index, Horror_index, Musical_index, Mystery_index, Romance_index, SciFi_index, Thriller_index, War_index, Western_index)\n"
          }
        ]
      },
      "apps": [],
      "runtimeInfos": {},
      "progressUpdateIntervalMs": 500,
      "jobName": "paragraph_1618453647588_249161728",
      "id": "paragraph_1617944368442_80776772",
      "dateCreated": "2021-04-15T02:27:27+0000",
      "dateStarted": "2021-04-15T03:39:26+0000",
      "dateFinished": "2021-04-15T03:39:26+0000",
      "status": "FINISHED",
      "$$hashKey": "object:80073"
    },
    {
      "text": "//review features\nm_features.show(5)",
      "user": "anonymous",
      "dateUpdated": "2021-04-15T03:39:27+0000",
      "config": {
        "editorSetting": {
          "language": "scala",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "colWidth": 12,
        "editorMode": "ace/mode/scala",
        "fontSize": 9,
        "results": {},
        "enabled": true
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "TEXT",
            "data": "+-----------------+------------------+--------------+-------------+------------+---------------+---------------+--------------+------------+-----------+-----------------+-----------+-------------+--------------+------------+-------------+-------------+-------------+-----------+--------------+---------+-------------+\n|movie_title_index|release_date_index|IMDb_URL_index|unknown_index|Action_index|Adventure_index|Animation_index|Children_index|Comedy_index|Crime_index|Documentary_index|Drama_index|Fantasy_index|FilmNoir_index|Horror_index|Musical_index|Mystery_index|Romance_index|SciFi_index|Thriller_index|War_index|Western_index|\n+-----------------+------------------+--------------+-------------+------------+---------------+---------------+--------------+------------+-----------+-----------------+-----------+-------------+--------------+------------+-------------+-------------+-------------+-----------+--------------+---------+-------------+\n|             37.0|               0.0|        1138.0|          0.0|         0.0|            0.0|            1.0|           1.0|         1.0|        0.0|              0.0|        0.0|          0.0|           0.0|         0.0|          0.0|          0.0|          0.0|        0.0|           0.0|      0.0|          0.0|\n|            461.0|               0.0|         364.0|          0.0|         1.0|            1.0|            0.0|           0.0|         0.0|        0.0|              0.0|        0.0|          0.0|           0.0|         0.0|          0.0|          0.0|          0.0|        0.0|           1.0|      0.0|          0.0|\n|            822.0|               0.0|         108.0|          0.0|         0.0|            0.0|            0.0|           0.0|         0.0|        0.0|              0.0|        0.0|          0.0|           0.0|         0.0|          0.0|          0.0|          0.0|        0.0|           1.0|      0.0|          0.0|\n|            541.0|               0.0|        1434.0|          0.0|         1.0|            0.0|            0.0|           0.0|         1.0|        0.0|              0.0|        1.0|          0.0|           0.0|         0.0|          0.0|          0.0|          0.0|        0.0|           0.0|      0.0|          0.0|\n|             99.0|               0.0|        1144.0|          0.0|         0.0|            0.0|            0.0|           0.0|         0.0|        1.0|              0.0|        1.0|          0.0|           0.0|         0.0|          0.0|          0.0|          0.0|        0.0|           1.0|      0.0|          0.0|\n+-----------------+------------------+--------------+-------------+------------+---------------+---------------+--------------+------------+-----------+-----------------+-----------+-------------+--------------+------------+-------------+-------------+-------------+-----------+--------------+---------+-------------+\nonly showing top 5 rows\n\n"
          }
        ]
      },
      "apps": [],
      "runtimeInfos": {
        "jobUrl": {
          "propertyName": "jobUrl",
          "label": "SPARK JOB",
          "tooltip": "View in Spark web UI",
          "group": "spark",
          "values": [
            {
              "jobUrl": "http://e67d52a5ef45:4040/jobs/job?id=1324",
              "$$hashKey": "object:101768"
            }
          ],
          "interpreterSettingId": "spark"
        }
      },
      "progressUpdateIntervalMs": 500,
      "jobName": "paragraph_1618453647588_997901901",
      "id": "paragraph_1617944684956_1994906111",
      "dateCreated": "2021-04-15T02:27:27+0000",
      "dateStarted": "2021-04-15T03:39:27+0000",
      "dateFinished": "2021-04-15T03:39:28+0000",
      "status": "FINISHED",
      "$$hashKey": "object:80074"
    },
    {
      "text": "//attaching features to a single column with matching movie id\nval assembler = new VectorAssembler().setInputCols(m_features.columns).setOutputCol(\"features\")\nval movies_output = assembler.transform(minfo).select(\"movieid\", \"features\")\nmovies_output.show(10 , false)",
      "user": "anonymous",
      "dateUpdated": "2021-04-15T03:39:28+0000",
      "config": {
        "editorSetting": {
          "language": "scala",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "colWidth": 12,
        "editorMode": "ace/mode/scala",
        "fontSize": 9,
        "results": {},
        "enabled": true
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "TEXT",
            "data": "+-------+-----------------------------------------------+\n|movieid|features                                       |\n+-------+-----------------------------------------------+\n|1      |(22,[0,2,6,7,8],[37.0,1138.0,1.0,1.0,1.0])     |\n|2      |(22,[0,2,4,5,19],[461.0,364.0,1.0,1.0,1.0])    |\n|3      |(22,[0,2,19],[822.0,108.0,1.0])                |\n|4      |(22,[0,2,4,8,11],[541.0,1434.0,1.0,1.0,1.0])   |\n|5      |(22,[0,2,9,11,19],[99.0,1144.0,1.0,1.0,1.0])   |\n|6      |(22,[0,2,11],[1659.0,578.0,1.0])               |\n|7      |(22,[0,2,11,18],[951.0,462.0,1.0,1.0])         |\n|8      |(22,[0,2,7,8,11],[1454.0,425.0,1.0,1.0,1.0])   |\n|9      |(22,[0,2,11],[1452.0,573.0,1.0])               |\n|10     |(22,[0,1,2,11,20],[1448.0,202.0,928.0,1.0,1.0])|\n+-------+-----------------------------------------------+\nonly showing top 10 rows\n\n\u001b[1m\u001b[34massembler\u001b[0m: \u001b[1m\u001b[32morg.apache.spark.ml.feature.VectorAssembler\u001b[0m = vecAssembler_260fd16404ba\n\u001b[1m\u001b[34mmovies_output\u001b[0m: \u001b[1m\u001b[32morg.apache.spark.sql.DataFrame\u001b[0m = [movieid: int, features: vector]\n"
          }
        ]
      },
      "apps": [],
      "runtimeInfos": {
        "jobUrl": {
          "propertyName": "jobUrl",
          "label": "SPARK JOB",
          "tooltip": "View in Spark web UI",
          "group": "spark",
          "values": [
            {
              "jobUrl": "http://e67d52a5ef45:4040/jobs/job?id=1325",
              "$$hashKey": "object:101793"
            }
          ],
          "interpreterSettingId": "spark"
        }
      },
      "progressUpdateIntervalMs": 500,
      "jobName": "paragraph_1618453647588_733135981",
      "id": "paragraph_1617944581936_1418757540",
      "dateCreated": "2021-04-15T02:27:27+0000",
      "dateStarted": "2021-04-15T03:39:28+0000",
      "dateFinished": "2021-04-15T03:39:29+0000",
      "status": "FINISHED",
      "$$hashKey": "object:80075"
    },
    {
      "text": "//split data set testing and training\r\nval Array(mtraining, mtesting) = movies_output.randomSplit(Array(0.7, 0.3), seed = 1234)",
      "user": "anonymous",
      "dateUpdated": "2021-04-15T03:39:29+0000",
      "config": {
        "editorSetting": {
          "language": "scala",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "colWidth": 12,
        "editorMode": "ace/mode/scala",
        "fontSize": 9,
        "results": {},
        "enabled": true
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "TEXT",
            "data": "\u001b[1m\u001b[34mmtraining\u001b[0m: \u001b[1m\u001b[32morg.apache.spark.sql.Dataset[org.apache.spark.sql.Row]\u001b[0m = [movieid: int, features: vector]\n\u001b[1m\u001b[34mmtesting\u001b[0m: \u001b[1m\u001b[32morg.apache.spark.sql.Dataset[org.apache.spark.sql.Row]\u001b[0m = [movieid: int, features: vector]\n"
          }
        ]
      },
      "apps": [],
      "runtimeInfos": {},
      "progressUpdateIntervalMs": 500,
      "jobName": "paragraph_1618453647588_830187079",
      "id": "paragraph_1617945956872_189248836",
      "dateCreated": "2021-04-15T02:27:27+0000",
      "dateStarted": "2021-04-15T03:39:29+0000",
      "dateFinished": "2021-04-15T03:39:30+0000",
      "status": "FINISHED",
      "$$hashKey": "object:80076"
    },
    {
      "text": "import org.apache.spark.ml.clustering.KMeans\r\n// using kmeans to model with 13 clusters and fit to training\r\nval model1 = new KMeans()\r\n    .setK(13)\r\n    .setFeaturesCol(\"features\")\r\n    .setPredictionCol(\"prediction\")\r\n    .fit(mtraining)",
      "user": "anonymous",
      "dateUpdated": "2021-04-15T03:39:30+0000",
      "config": {
        "editorSetting": {
          "language": "scala",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "colWidth": 12,
        "editorMode": "ace/mode/scala",
        "fontSize": 9,
        "results": {},
        "enabled": true
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "TEXT",
            "data": "import org.apache.spark.ml.clustering.KMeans\n\u001b[1m\u001b[34mmodel1\u001b[0m: \u001b[1m\u001b[32morg.apache.spark.ml.clustering.KMeansModel\u001b[0m = kmeans_5f474c5c6f5e\n"
          }
        ]
      },
      "apps": [],
      "runtimeInfos": {
        "jobUrl": {
          "propertyName": "jobUrl",
          "label": "SPARK JOB",
          "tooltip": "View in Spark web UI",
          "group": "spark",
          "values": [
            {
              "jobUrl": "http://e67d52a5ef45:4040/jobs/job?id=1326",
              "$$hashKey": "object:103211"
            },
            {
              "jobUrl": "http://e67d52a5ef45:4040/jobs/job?id=1327",
              "$$hashKey": "object:103212"
            },
            {
              "jobUrl": "http://e67d52a5ef45:4040/jobs/job?id=1328",
              "$$hashKey": "object:103213"
            },
            {
              "jobUrl": "http://e67d52a5ef45:4040/jobs/job?id=1329",
              "$$hashKey": "object:103214"
            },
            {
              "jobUrl": "http://e67d52a5ef45:4040/jobs/job?id=1330",
              "$$hashKey": "object:103215"
            },
            {
              "jobUrl": "http://e67d52a5ef45:4040/jobs/job?id=1331",
              "$$hashKey": "object:103216"
            },
            {
              "jobUrl": "http://e67d52a5ef45:4040/jobs/job?id=1332",
              "$$hashKey": "object:103217"
            },
            {
              "jobUrl": "http://e67d52a5ef45:4040/jobs/job?id=1333",
              "$$hashKey": "object:103218"
            },
            {
              "jobUrl": "http://e67d52a5ef45:4040/jobs/job?id=1334",
              "$$hashKey": "object:103219"
            },
            {
              "jobUrl": "http://e67d52a5ef45:4040/jobs/job?id=1335",
              "$$hashKey": "object:103220"
            },
            {
              "jobUrl": "http://e67d52a5ef45:4040/jobs/job?id=1336",
              "$$hashKey": "object:103221"
            },
            {
              "jobUrl": "http://e67d52a5ef45:4040/jobs/job?id=1337",
              "$$hashKey": "object:103222"
            },
            {
              "jobUrl": "http://e67d52a5ef45:4040/jobs/job?id=1338",
              "$$hashKey": "object:103223"
            },
            {
              "jobUrl": "http://e67d52a5ef45:4040/jobs/job?id=1339",
              "$$hashKey": "object:103224"
            },
            {
              "jobUrl": "http://e67d52a5ef45:4040/jobs/job?id=1340",
              "$$hashKey": "object:103225"
            },
            {
              "jobUrl": "http://e67d52a5ef45:4040/jobs/job?id=1341",
              "$$hashKey": "object:103226"
            },
            {
              "jobUrl": "http://e67d52a5ef45:4040/jobs/job?id=1342",
              "$$hashKey": "object:103227"
            },
            {
              "jobUrl": "http://e67d52a5ef45:4040/jobs/job?id=1343",
              "$$hashKey": "object:103228"
            },
            {
              "jobUrl": "http://e67d52a5ef45:4040/jobs/job?id=1344",
              "$$hashKey": "object:103229"
            },
            {
              "jobUrl": "http://e67d52a5ef45:4040/jobs/job?id=1345",
              "$$hashKey": "object:103230"
            },
            {
              "jobUrl": "http://e67d52a5ef45:4040/jobs/job?id=1346",
              "$$hashKey": "object:103231"
            },
            {
              "jobUrl": "http://e67d52a5ef45:4040/jobs/job?id=1347",
              "$$hashKey": "object:103232"
            },
            {
              "jobUrl": "http://e67d52a5ef45:4040/jobs/job?id=1348",
              "$$hashKey": "object:103233"
            },
            {
              "jobUrl": "http://e67d52a5ef45:4040/jobs/job?id=1349",
              "$$hashKey": "object:103234"
            },
            {
              "jobUrl": "http://e67d52a5ef45:4040/jobs/job?id=1350",
              "$$hashKey": "object:103235"
            },
            {
              "jobUrl": "http://e67d52a5ef45:4040/jobs/job?id=1351",
              "$$hashKey": "object:103236"
            },
            {
              "jobUrl": "http://e67d52a5ef45:4040/jobs/job?id=1352",
              "$$hashKey": "object:103237"
            },
            {
              "jobUrl": "http://e67d52a5ef45:4040/jobs/job?id=1353",
              "$$hashKey": "object:103238"
            }
          ],
          "interpreterSettingId": "spark"
        }
      },
      "progressUpdateIntervalMs": 500,
      "jobName": "paragraph_1618453647589_1680864577",
      "id": "paragraph_1617944578118_1675460365",
      "dateCreated": "2021-04-15T02:27:27+0000",
      "dateStarted": "2021-04-15T03:39:30+0000",
      "dateFinished": "2021-04-15T03:39:34+0000",
      "status": "FINISHED",
      "$$hashKey": "object:80077"
    },
    {
      "text": "// test model with testing set\r\n   val movie_predict1 = model1.transform(mtesting)\r\n   val movie_predtrain = model1.transform(mtraining)\r\n   println(\"View predictions on test set\")\r\n   movie_predict1.show(20)",
      "user": "anonymous",
      "dateUpdated": "2021-04-15T03:39:34+0000",
      "config": {
        "editorSetting": {
          "language": "scala",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "colWidth": 12,
        "editorMode": "ace/mode/scala",
        "fontSize": 9,
        "results": {},
        "enabled": true
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "TEXT",
            "data": "View predictions on test set\n+-------+--------------------+----------+\n|movieid|            features|prediction|\n+-------+--------------------+----------+\n|      1|(22,[0,2,6,7,8],[...|         2|\n|      2|(22,[0,2,4,5,19],...|         0|\n|      3|(22,[0,2,19],[822...|         8|\n|     14|(22,[0,1,2,11,17]...|         1|\n|     27|(22,[0,2,4],[299....|         2|\n|     28|(22,[0,2,4,11,19]...|        11|\n|     32|(22,[0,1,2,10],[1...|        11|\n|     35|(22,[0,2,5,7,11],...|         8|\n|     39|(22,[0,2,4,9,18],...|         2|\n|     42|(22,[0,1,2,8],[13...|        11|\n|     45|(22,[0,1,2,8,11],...|         6|\n|     46|(22,[0,1,2,11],[1...|         3|\n|     48|(22,[0,1,2,10],[1...|         1|\n|     53|(22,[0,1,2,4,19],...|        11|\n|     63|(22,[0,1,2,7,8],[...|         2|\n|     66|(22,[0,2,8,17],[2...|         3|\n|     75|(22,[0,1,2,10],[8...|         9|\n|     79|(22,[0,1,2,4,19],...|         3|\n|     80|(22,[0,1,2,4,8,20...|         3|\n|     82|(22,[0,1,2,4,5,18...|         2|\n+-------+--------------------+----------+\nonly showing top 20 rows\n\n\u001b[1m\u001b[34mmovie_predict1\u001b[0m: \u001b[1m\u001b[32morg.apache.spark.sql.DataFrame\u001b[0m = [movieid: int, features: vector ... 1 more field]\n\u001b[1m\u001b[34mmovie_predtrain\u001b[0m: \u001b[1m\u001b[32morg.apache.spark.sql.DataFrame\u001b[0m = [movieid: int, features: vector ... 1 more field]\n"
          }
        ]
      },
      "apps": [],
      "runtimeInfos": {
        "jobUrl": {
          "propertyName": "jobUrl",
          "label": "SPARK JOB",
          "tooltip": "View in Spark web UI",
          "group": "spark",
          "values": [
            {
              "jobUrl": "http://e67d52a5ef45:4040/jobs/job?id=1354",
              "$$hashKey": "object:103317"
            }
          ],
          "interpreterSettingId": "spark"
        }
      },
      "progressUpdateIntervalMs": 500,
      "jobName": "paragraph_1618453647589_1048225309",
      "id": "paragraph_1617946098237_1094679702",
      "dateCreated": "2021-04-15T02:27:27+0000",
      "dateStarted": "2021-04-15T03:39:34+0000",
      "dateFinished": "2021-04-15T03:39:35+0000",
      "status": "FINISHED",
      "$$hashKey": "object:80078"
    },
    {
      "text": "val movie_predict = movie_predict1.union(movie_predtrain)",
      "user": "anonymous",
      "dateUpdated": "2021-04-15T03:39:35+0000",
      "config": {
        "colWidth": 12,
        "fontSize": 9,
        "enabled": true,
        "results": {},
        "editorSetting": {
          "language": "scala",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "editorMode": "ace/mode/scala"
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "TEXT",
            "data": "\u001b[1m\u001b[34mmovie_predict\u001b[0m: \u001b[1m\u001b[32morg.apache.spark.sql.Dataset[org.apache.spark.sql.Row]\u001b[0m = [movieid: int, features: vector ... 1 more field]\n"
          }
        ]
      },
      "apps": [],
      "runtimeInfos": {},
      "progressUpdateIntervalMs": 500,
      "jobName": "paragraph_1618456721978_378096268",
      "id": "paragraph_1618456721978_378096268",
      "dateCreated": "2021-04-15T03:18:41+0000",
      "dateStarted": "2021-04-15T03:39:35+0000",
      "dateFinished": "2021-04-15T03:39:35+0000",
      "status": "FINISHED",
      "$$hashKey": "object:80079"
    },
    {
      "text": "//renaming columns\nval movieprd = movie_predict.withColumnRenamed(\"movieid\", \"movie_id\").withColumnRenamed(\"features\", \"mfeatures\").withColumnRenamed(\"prediction\", \"mprediction\")\nmovieprd.show(5)",
      "user": "anonymous",
      "dateUpdated": "2021-04-15T03:39:35+0000",
      "config": {
        "editorSetting": {
          "language": "scala",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "colWidth": 12,
        "editorMode": "ace/mode/scala",
        "fontSize": 9,
        "results": {},
        "enabled": true
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "TEXT",
            "data": "+--------+--------------------+-----------+\n|movie_id|           mfeatures|mprediction|\n+--------+--------------------+-----------+\n|       1|(22,[0,2,6,7,8],[...|          2|\n|       2|(22,[0,2,4,5,19],...|          0|\n|       3|(22,[0,2,19],[822...|          8|\n|      14|(22,[0,1,2,11,17]...|          1|\n|      27|(22,[0,2,4],[299....|          2|\n+--------+--------------------+-----------+\nonly showing top 5 rows\n\n\u001b[1m\u001b[34mmovieprd\u001b[0m: \u001b[1m\u001b[32morg.apache.spark.sql.DataFrame\u001b[0m = [movie_id: int, mfeatures: vector ... 1 more field]\n"
          }
        ]
      },
      "apps": [],
      "runtimeInfos": {
        "jobUrl": {
          "propertyName": "jobUrl",
          "label": "SPARK JOB",
          "tooltip": "View in Spark web UI",
          "group": "spark",
          "values": [
            {
              "jobUrl": "http://e67d52a5ef45:4040/jobs/job?id=1355",
              "$$hashKey": "object:103355"
            }
          ],
          "interpreterSettingId": "spark"
        }
      },
      "progressUpdateIntervalMs": 500,
      "jobName": "paragraph_1618453647589_694209010",
      "id": "paragraph_1618144766848_963888135",
      "dateCreated": "2021-04-15T02:27:27+0000",
      "dateStarted": "2021-04-15T03:39:36+0000",
      "dateFinished": "2021-04-15T03:39:37+0000",
      "status": "FINISHED",
      "$$hashKey": "object:80080"
    },
    {
      "text": "// Evaluate clustering by computing Silhouette score\r\n//Its value ranges from -1 to 1.\r\n// 1: Means clusters are well apart from each other and clearly distinguished.\r\n// 0: Means clusters are indifferent, or we can say that the distance between clusters is not significant.\r\nimport org.apache.spark.ml.evaluation.ClusteringEvaluator\r\nval evaluator = new ClusteringEvaluator()",
      "user": "anonymous",
      "dateUpdated": "2021-04-15T03:39:37+0000",
      "config": {
        "editorSetting": {
          "language": "scala",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "colWidth": 12,
        "editorMode": "ace/mode/scala",
        "fontSize": 9,
        "results": {},
        "enabled": true
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "TEXT",
            "data": "import org.apache.spark.ml.evaluation.ClusteringEvaluator\n\u001b[1m\u001b[34mevaluator\u001b[0m: \u001b[1m\u001b[32morg.apache.spark.ml.evaluation.ClusteringEvaluator\u001b[0m = cluEval_db6d6dc6beb5\n"
          }
        ]
      },
      "apps": [],
      "runtimeInfos": {},
      "progressUpdateIntervalMs": 500,
      "jobName": "paragraph_1618453647590_860305464",
      "id": "paragraph_1617946094552_353211676",
      "dateCreated": "2021-04-15T02:27:27+0000",
      "dateStarted": "2021-04-15T03:39:37+0000",
      "dateFinished": "2021-04-15T03:39:37+0000",
      "status": "FINISHED",
      "$$hashKey": "object:80081"
    },
    {
      "text": "//A score of 0.6 since it is closer to 1, suggest that the clusters are fairly well apart from each other\r\nval silhouette = evaluator.evaluate(movie_predict1)\r\nprintln(s\"Silhouette with squared euclidean distance = $silhouette\")",
      "user": "anonymous",
      "dateUpdated": "2021-04-15T03:39:37+0000",
      "config": {
        "editorSetting": {
          "language": "scala",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "colWidth": 12,
        "editorMode": "ace/mode/scala",
        "fontSize": 9,
        "results": {},
        "enabled": true
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "TEXT",
            "data": "Silhouette with squared euclidean distance = 0.5101221702850435\n\u001b[1m\u001b[34msilhouette\u001b[0m: \u001b[1m\u001b[32mDouble\u001b[0m = 0.5101221702850435\n"
          }
        ]
      },
      "apps": [],
      "runtimeInfos": {
        "jobUrl": {
          "propertyName": "jobUrl",
          "label": "SPARK JOB",
          "tooltip": "View in Spark web UI",
          "group": "spark",
          "values": [
            {
              "jobUrl": "http://e67d52a5ef45:4040/jobs/job?id=1356",
              "$$hashKey": "object:103405"
            },
            {
              "jobUrl": "http://e67d52a5ef45:4040/jobs/job?id=1357",
              "$$hashKey": "object:103406"
            }
          ],
          "interpreterSettingId": "spark"
        }
      },
      "progressUpdateIntervalMs": 500,
      "jobName": "paragraph_1618453647590_2050252013",
      "id": "paragraph_1617946088816_1670012931",
      "dateCreated": "2021-04-15T02:27:27+0000",
      "dateStarted": "2021-04-15T03:39:37+0000",
      "dateFinished": "2021-04-15T03:39:40+0000",
      "status": "FINISHED",
      "$$hashKey": "object:80082"
    },
    {
      "text": "// This cluster model can be improved by condensing all genres into one column with the respective genre name as a string. \n// That way a better clustering analysis could have been done since 1, 0 is is not uniue enough. This I suspect would provide a better \n// euclidean distance as seen with 1M movie lens movie.dat file (all genres are in one column)",
      "user": "anonymous",
      "dateUpdated": "2021-04-15T03:39:40+0000",
      "config": {
        "editorSetting": {
          "language": "scala",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "colWidth": 12,
        "editorMode": "ace/mode/scala",
        "fontSize": 9,
        "results": {},
        "enabled": true
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": []
      },
      "apps": [],
      "runtimeInfos": {},
      "progressUpdateIntervalMs": 500,
      "jobName": "paragraph_1618453647590_1976926121",
      "id": "paragraph_1618197969055_999701643",
      "dateCreated": "2021-04-15T02:27:27+0000",
      "dateStarted": "2021-04-15T03:39:40+0000",
      "dateFinished": "2021-04-15T03:39:40+0000",
      "status": "FINISHED",
      "$$hashKey": "object:80083"
    },
    {
      "title": "Importing user personal data",
      "text": "%sh wget --no-check-certificate https://files.grouplens.org/datasets/movielens/ml-100k/u.user",
      "user": "anonymous",
      "dateUpdated": "2021-04-15T03:39:40+0000",
      "config": {
        "lineNumbers": false,
        "editorSetting": {
          "language": "sh",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": false
        },
        "colWidth": 12,
        "editorMode": "ace/mode/sh",
        "fontSize": 9,
        "title": true,
        "results": {},
        "enabled": true
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "TEXT",
            "data": "--2021-04-15 03:39:41--  https://files.grouplens.org/datasets/movielens/ml-100k/u.user\nResolving files.grouplens.org (files.grouplens.org)... 128.101.65.152\nConnecting to files.grouplens.org (files.grouplens.org)|128.101.65.152|:443... connected.\nWARNING: cannot verify files.grouplens.org's certificate, issued by ‘CN=InCommon RSA Server CA,OU=InCommon,O=Internet2,L=Ann Arbor,ST=MI,C=US’:\n  Unable to locally verify the issuer's authority.\nHTTP request sent, awaiting response... 200 OK\nLength: 22628 (22K)\nSaving to: ‘u.user.4’\n\n     0K .......... .......... ..                              100%  227K=0.1s\n\n2021-04-15 03:39:41 (227 KB/s) - ‘u.user.4’ saved [22628/22628]\n\n"
          }
        ]
      },
      "apps": [],
      "runtimeInfos": {},
      "progressUpdateIntervalMs": 500,
      "jobName": "paragraph_1618453647590_2082980971",
      "id": "paragraph_1617902545839_280085463",
      "dateCreated": "2021-04-15T02:27:27+0000",
      "dateStarted": "2021-04-15T03:39:40+0000",
      "dateFinished": "2021-04-15T03:39:41+0000",
      "status": "FINISHED",
      "$$hashKey": "object:80084"
    },
    {
      "text": "// create datarame for users against movies\n\nval users = sqlContext.read.format(\"com.databricks.spark.csv\").option(\"delimiter\", \"|\").option(\"header\", false).option(\"inferSchema\", true).load(\"u.user\").toDF(\n  \"userid\", \"age\", \"gender\", \"occupation\", \"zipcode\")\n",
      "user": "anonymous",
      "dateUpdated": "2021-04-15T03:39:41+0000",
      "config": {
        "editorSetting": {
          "language": "scala",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "colWidth": 12,
        "editorMode": "ace/mode/scala",
        "fontSize": 9,
        "results": {},
        "enabled": true
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "TEXT",
            "data": "\u001b[1m\u001b[34musers\u001b[0m: \u001b[1m\u001b[32morg.apache.spark.sql.DataFrame\u001b[0m = [userid: int, age: int ... 3 more fields]\n"
          }
        ]
      },
      "apps": [],
      "runtimeInfos": {
        "jobUrl": {
          "propertyName": "jobUrl",
          "label": "SPARK JOB",
          "tooltip": "View in Spark web UI",
          "group": "spark",
          "values": [
            {
              "jobUrl": "http://e67d52a5ef45:4040/jobs/job?id=1358",
              "$$hashKey": "object:103504"
            },
            {
              "jobUrl": "http://e67d52a5ef45:4040/jobs/job?id=1359",
              "$$hashKey": "object:103505"
            }
          ],
          "interpreterSettingId": "spark"
        }
      },
      "progressUpdateIntervalMs": 500,
      "jobName": "paragraph_1618453647590_177518052",
      "id": "paragraph_1617902577722_982349551",
      "dateCreated": "2021-04-15T02:27:27+0000",
      "dateStarted": "2021-04-15T03:39:41+0000",
      "dateFinished": "2021-04-15T03:39:43+0000",
      "status": "FINISHED",
      "$$hashKey": "object:80085"
    },
    {
      "text": "//review 5 rows\nusers.show(5)",
      "user": "anonymous",
      "dateUpdated": "2021-04-15T03:39:43+0000",
      "config": {
        "editorSetting": {
          "language": "scala",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "colWidth": 12,
        "editorMode": "ace/mode/scala",
        "fontSize": 9,
        "results": {},
        "enabled": true
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "TEXT",
            "data": "+------+---+------+----------+-------+\n|userid|age|gender|occupation|zipcode|\n+------+---+------+----------+-------+\n|     1| 24|     M|technician|  85711|\n|     2| 53|     F|     other|  94043|\n|     3| 23|     M|    writer|  32067|\n|     4| 24|     M|technician|  43537|\n|     5| 33|     F|     other|  15213|\n+------+---+------+----------+-------+\nonly showing top 5 rows\n\n"
          }
        ]
      },
      "apps": [],
      "runtimeInfos": {
        "jobUrl": {
          "propertyName": "jobUrl",
          "label": "SPARK JOB",
          "tooltip": "View in Spark web UI",
          "group": "spark",
          "values": [
            {
              "jobUrl": "http://e67d52a5ef45:4040/jobs/job?id=1360",
              "$$hashKey": "object:103554"
            }
          ],
          "interpreterSettingId": "spark"
        }
      },
      "progressUpdateIntervalMs": 500,
      "jobName": "paragraph_1618453647591_241664828",
      "id": "paragraph_1617626353116_1508777769",
      "dateCreated": "2021-04-15T02:27:27+0000",
      "dateStarted": "2021-04-15T03:39:43+0000",
      "dateFinished": "2021-04-15T03:39:43+0000",
      "status": "FINISHED",
      "$$hashKey": "object:80086"
    },
    {
      "text": "// checking for total number of missing values for each column\r\nimport org.apache.spark.sql.functions.{sum, col}\r\nusers.select(users.columns.map(c => sum(col(c).isNull.cast(\"int\")).alias(c)): _*).show\r\n// No missing values identified",
      "user": "anonymous",
      "dateUpdated": "2021-04-15T03:39:43+0000",
      "config": {
        "editorSetting": {
          "language": "scala",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "colWidth": 12,
        "editorMode": "ace/mode/scala",
        "fontSize": 9,
        "results": {},
        "enabled": true
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "TEXT",
            "data": "+------+---+------+----------+-------+\n|userid|age|gender|occupation|zipcode|\n+------+---+------+----------+-------+\n|     0|  0|     0|         0|      0|\n+------+---+------+----------+-------+\n\nimport org.apache.spark.sql.functions.{sum, col}\n"
          }
        ]
      },
      "apps": [],
      "runtimeInfos": {
        "jobUrl": {
          "propertyName": "jobUrl",
          "label": "SPARK JOB",
          "tooltip": "View in Spark web UI",
          "group": "spark",
          "values": [
            {
              "jobUrl": "http://e67d52a5ef45:4040/jobs/job?id=1361",
              "$$hashKey": "object:103599"
            }
          ],
          "interpreterSettingId": "spark"
        }
      },
      "progressUpdateIntervalMs": 500,
      "jobName": "paragraph_1618453647591_191728651",
      "id": "paragraph_1617906801820_1359437286",
      "dateCreated": "2021-04-15T02:27:27+0000",
      "dateStarted": "2021-04-15T03:39:43+0000",
      "dateFinished": "2021-04-15T03:39:45+0000",
      "status": "FINISHED",
      "$$hashKey": "object:80087"
    },
    {
      "text": "//creating indexer columns for modeling and pipeline for fitting\nval indexers = for {column <- List(\"userid\", \"age\", \"gender\", \"occupation\", \"zipcode\")} yield new StringIndexer().setInputCol(column).setOutputCol(column+\"_index\")\nval pipeline = new Pipeline().setStages(indexers.toArray)",
      "user": "anonymous",
      "dateUpdated": "2021-04-15T03:39:45+0000",
      "config": {
        "editorSetting": {
          "language": "scala",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "colWidth": 12,
        "editorMode": "ace/mode/scala",
        "fontSize": 9,
        "results": {},
        "enabled": true
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "TEXT",
            "data": "\u001b[1m\u001b[34mindexers\u001b[0m: \u001b[1m\u001b[32mList[org.apache.spark.ml.feature.StringIndexer]\u001b[0m = List(strIdx_3fb9849e9b51, strIdx_f1bcc6c2235c, strIdx_2df8cefbc8bd, strIdx_41e3dba67b00, strIdx_0032c2325757)\n\u001b[1m\u001b[34mpipeline\u001b[0m: \u001b[1m\u001b[32morg.apache.spark.ml.Pipeline\u001b[0m = pipeline_d6900f69bf9a\n"
          }
        ]
      },
      "apps": [],
      "runtimeInfos": {},
      "progressUpdateIntervalMs": 500,
      "jobName": "paragraph_1618453647591_1381066720",
      "id": "paragraph_1617913790738_2032055675",
      "dateCreated": "2021-04-15T02:27:27+0000",
      "dateStarted": "2021-04-15T03:39:45+0000",
      "dateFinished": "2021-04-15T03:39:46+0000",
      "status": "FINISHED",
      "$$hashKey": "object:80088"
    },
    {
      "text": "val users1 = pipeline.fit(users).transform(users)\nusers1.show()",
      "user": "anonymous",
      "dateUpdated": "2021-04-15T03:39:46+0000",
      "config": {
        "editorSetting": {
          "language": "scala",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "colWidth": 12,
        "editorMode": "ace/mode/scala",
        "fontSize": 9,
        "results": {},
        "enabled": true
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "TEXT",
            "data": "+------+---+------+-------------+-------+------------+---------+------------+----------------+-------------+\n|userid|age|gender|   occupation|zipcode|userid_index|age_index|gender_index|occupation_index|zipcode_index|\n+------+---+------+-------------+-------+------------+---------+------------+----------------+-------------+\n|     1| 24|     M|   technician|  85711|       500.0|      6.0|         0.0|            11.0|         86.0|\n|     2| 53|     F|        other|  94043|       674.0|     34.0|         1.0|             1.0|         13.0|\n|     3| 23|     M|       writer|  32067|       849.0|      9.0|         0.0|             7.0|        307.0|\n|     4| 24|     M|   technician|  43537|       110.0|      6.0|         0.0|            11.0|        719.0|\n|     5| 33|     F|        other|  15213|       344.0|     13.0|         1.0|             1.0|        688.0|\n|     6| 42|     M|    executive|  98101|       490.0|     20.0|         0.0|             8.0|        162.0|\n|     7| 57|     M|administrator|  91344|       781.0|     37.0|         0.0|             3.0|         45.0|\n|     8| 36|     M|administrator|  05201|        62.0|     19.0|         0.0|             3.0|        180.0|\n|     9| 29|     M|      student|  01002|       165.0|      8.0|         0.0|             0.0|        598.0|\n|    10| 53|     M|       lawyer|  90703|       358.0|     34.0|         0.0|            17.0|        668.0|\n|    11| 39|     F|        other|  30329|       158.0|     17.0|         1.0|             1.0|        448.0|\n|    12| 28|     F|        other|  06405|        47.0|      3.0|         1.0|             1.0|        552.0|\n|    13| 47|     M|     educator|  29206|       275.0|     31.0|         0.0|             2.0|        239.0|\n|    14| 45|     M|    scientist|  55106|       542.0|     29.0|         0.0|             9.0|         14.0|\n|    15| 49|     F|     educator|  97301|       153.0|     25.0|         1.0|             2.0|         22.0|\n|    16| 21|     M|entertainment|  10309|       322.0|     12.0|         0.0|            13.0|        129.0|\n|    17| 30|     M|   programmer|  06355|       524.0|      0.0|         0.0|             5.0|        371.0|\n|    18| 35|     F|        other|  37212|       751.0|     11.0|         1.0|             1.0|        582.0|\n|    19| 40|     M|    librarian|  02138|        89.0|     18.0|         0.0|             6.0|        569.0|\n|    20| 42|     F|    homemaker|  95660|       650.0|     20.0|         1.0|            20.0|        291.0|\n+------+---+------+-------------+-------+------------+---------+------------+----------------+-------------+\nonly showing top 20 rows\n\n\u001b[1m\u001b[34musers1\u001b[0m: \u001b[1m\u001b[32morg.apache.spark.sql.DataFrame\u001b[0m = [userid: int, age: int ... 8 more fields]\n"
          }
        ]
      },
      "apps": [],
      "runtimeInfos": {
        "jobUrl": {
          "propertyName": "jobUrl",
          "label": "SPARK JOB",
          "tooltip": "View in Spark web UI",
          "group": "spark",
          "values": [
            {
              "jobUrl": "http://e67d52a5ef45:4040/jobs/job?id=1362",
              "$$hashKey": "object:103819"
            },
            {
              "jobUrl": "http://e67d52a5ef45:4040/jobs/job?id=1363",
              "$$hashKey": "object:103820"
            },
            {
              "jobUrl": "http://e67d52a5ef45:4040/jobs/job?id=1364",
              "$$hashKey": "object:103821"
            },
            {
              "jobUrl": "http://e67d52a5ef45:4040/jobs/job?id=1365",
              "$$hashKey": "object:103822"
            },
            {
              "jobUrl": "http://e67d52a5ef45:4040/jobs/job?id=1366",
              "$$hashKey": "object:103823"
            },
            {
              "jobUrl": "http://e67d52a5ef45:4040/jobs/job?id=1367",
              "$$hashKey": "object:103824"
            }
          ],
          "interpreterSettingId": "spark"
        }
      },
      "progressUpdateIntervalMs": 500,
      "jobName": "paragraph_1618453647591_1815262122",
      "id": "paragraph_1617916557585_2065928490",
      "dateCreated": "2021-04-15T02:27:27+0000",
      "dateStarted": "2021-04-15T03:39:46+0000",
      "dateFinished": "2021-04-15T03:39:47+0000",
      "status": "FINISHED",
      "$$hashKey": "object:80089"
    },
    {
      "text": "//variable reassignment\nval users = users1",
      "user": "anonymous",
      "dateUpdated": "2021-04-15T03:39:47+0000",
      "config": {
        "editorSetting": {
          "language": "scala",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "colWidth": 12,
        "editorMode": "ace/mode/scala",
        "fontSize": 9,
        "results": {},
        "enabled": true
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "TEXT",
            "data": "\u001b[1m\u001b[34musers\u001b[0m: \u001b[1m\u001b[32morg.apache.spark.sql.DataFrame\u001b[0m = [userid: int, age: int ... 8 more fields]\n"
          }
        ]
      },
      "apps": [],
      "runtimeInfos": {},
      "progressUpdateIntervalMs": 500,
      "jobName": "paragraph_1618453647591_1640323864",
      "id": "paragraph_1617929790304_1678902868",
      "dateCreated": "2021-04-15T02:27:27+0000",
      "dateStarted": "2021-04-15T03:39:47+0000",
      "dateFinished": "2021-04-15T03:39:48+0000",
      "status": "FINISHED",
      "$$hashKey": "object:80090"
    },
    {
      "text": "//dropping irrelevant columns for clustering\nval u_features = users1.drop(\"userid\", \"userid_index\", \"age\", \"gender\", \"occupation\", \"zipcode\")\nu_features.show(5)",
      "user": "anonymous",
      "dateUpdated": "2021-04-15T03:39:48+0000",
      "config": {
        "editorSetting": {
          "language": "scala",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "colWidth": 12,
        "editorMode": "ace/mode/scala",
        "fontSize": 9,
        "results": {},
        "enabled": true
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "msg": [
          {
            "data": "",
            "type": "TEXT"
          }
        ]
      },
      "apps": [],
      "runtimeInfos": {
        "jobUrl": {
          "propertyName": "jobUrl",
          "label": "SPARK JOB",
          "tooltip": "View in Spark web UI",
          "group": "spark",
          "values": [
            {
              "jobUrl": "http://e67d52a5ef45:4040/jobs/job?id=1368",
              "$$hashKey": "object:103912"
            }
          ],
          "interpreterSettingId": "spark"
        }
      },
      "progressUpdateIntervalMs": 500,
      "jobName": "paragraph_1618453647592_937799225",
      "id": "paragraph_1617917765422_856543157",
      "dateCreated": "2021-04-15T02:27:27+0000",
      "dateStarted": "2021-04-15T03:39:48+0000",
      "dateFinished": "2021-04-15T03:27:39+0000",
      "status": "RUNNING",
      "$$hashKey": "object:80091"
    },
    {
      "text": "//dropping irrelevant columns however maintaining the userid\nval uinfo = users1.drop(\"userid_index\", \"age\", \"gender\", \"occupation\", \"zipcode\")\nuinfo.show()",
      "user": "anonymous",
      "dateUpdated": "2021-04-15T03:27:39+0000",
      "config": {
        "editorSetting": {
          "language": "scala",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "colWidth": 12,
        "editorMode": "ace/mode/scala",
        "fontSize": 9,
        "results": {},
        "enabled": true
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "TEXT",
            "data": "+------+---------+------------+----------------+-------------+\n|userid|age_index|gender_index|occupation_index|zipcode_index|\n+------+---------+------------+----------------+-------------+\n|     1|      6.0|         0.0|            11.0|         86.0|\n|     2|     34.0|         1.0|             1.0|         13.0|\n|     3|      9.0|         0.0|             7.0|        307.0|\n|     4|      6.0|         0.0|            11.0|        719.0|\n|     5|     13.0|         1.0|             1.0|        688.0|\n|     6|     20.0|         0.0|             8.0|        162.0|\n|     7|     37.0|         0.0|             3.0|         45.0|\n|     8|     19.0|         0.0|             3.0|        180.0|\n|     9|      8.0|         0.0|             0.0|        598.0|\n|    10|     34.0|         0.0|            17.0|        668.0|\n|    11|     17.0|         1.0|             1.0|        448.0|\n|    12|      3.0|         1.0|             1.0|        552.0|\n|    13|     31.0|         0.0|             2.0|        239.0|\n|    14|     29.0|         0.0|             9.0|         14.0|\n|    15|     25.0|         1.0|             2.0|         22.0|\n|    16|     12.0|         0.0|            13.0|        129.0|\n|    17|      0.0|         0.0|             5.0|        371.0|\n|    18|     11.0|         1.0|             1.0|        582.0|\n|    19|     18.0|         0.0|             6.0|        569.0|\n|    20|     20.0|         1.0|            20.0|        291.0|\n+------+---------+------------+----------------+-------------+\nonly showing top 20 rows\n\n\u001b[1m\u001b[34muinfo\u001b[0m: \u001b[1m\u001b[32morg.apache.spark.sql.DataFrame\u001b[0m = [userid: int, age_index: double ... 3 more fields]\n"
          }
        ]
      },
      "apps": [],
      "runtimeInfos": {
        "jobUrl": {
          "propertyName": "jobUrl",
          "label": "SPARK JOB",
          "tooltip": "View in Spark web UI",
          "group": "spark",
          "values": [
            {
              "jobUrl": "http://e67d52a5ef45:4040/jobs/job?id=1044",
              "$$hashKey": "object:87451"
            }
          ],
          "interpreterSettingId": "spark"
        }
      },
      "progressUpdateIntervalMs": 500,
      "jobName": "paragraph_1618453647592_1420930599",
      "id": "paragraph_1617918711067_1010139322",
      "dateCreated": "2021-04-15T02:27:27+0000",
      "dateStarted": "2021-04-15T03:27:39+0000",
      "dateFinished": "2021-04-15T03:27:40+0000",
      "status": "FINISHED",
      "$$hashKey": "object:80092"
    },
    {
      "text": "//Assigning features to one column for modeling with matching userid. Features are allocated to a list\nval assembler = new VectorAssembler().setInputCols(u_features.columns).setOutputCol(\"features\")\nval users_output = assembler.transform(uinfo).select(\"userid\", \"features\")\nusers_output.show(20 , false)",
      "user": "anonymous",
      "dateUpdated": "2021-04-15T03:27:40+0000",
      "config": {
        "editorSetting": {
          "language": "scala",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "colWidth": 12,
        "editorMode": "ace/mode/scala",
        "fontSize": 9,
        "results": {},
        "enabled": true
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "TEXT",
            "data": "+------+---------------------+\n|userid|features             |\n+------+---------------------+\n|1     |[6.0,0.0,11.0,86.0]  |\n|2     |[34.0,1.0,1.0,13.0]  |\n|3     |[9.0,0.0,7.0,307.0]  |\n|4     |[6.0,0.0,11.0,719.0] |\n|5     |[13.0,1.0,1.0,688.0] |\n|6     |[20.0,0.0,8.0,162.0] |\n|7     |[37.0,0.0,3.0,45.0]  |\n|8     |[19.0,0.0,3.0,180.0] |\n|9     |[8.0,0.0,0.0,598.0]  |\n|10    |[34.0,0.0,17.0,668.0]|\n|11    |[17.0,1.0,1.0,448.0] |\n|12    |[3.0,1.0,1.0,552.0]  |\n|13    |[31.0,0.0,2.0,239.0] |\n|14    |[29.0,0.0,9.0,14.0]  |\n|15    |[25.0,1.0,2.0,22.0]  |\n|16    |[12.0,0.0,13.0,129.0]|\n|17    |[0.0,0.0,5.0,371.0]  |\n|18    |[11.0,1.0,1.0,582.0] |\n|19    |[18.0,0.0,6.0,569.0] |\n|20    |[20.0,1.0,20.0,291.0]|\n+------+---------------------+\nonly showing top 20 rows\n\n\u001b[1m\u001b[34massembler\u001b[0m: \u001b[1m\u001b[32morg.apache.spark.ml.feature.VectorAssembler\u001b[0m = vecAssembler_66c1bc2c4941\n\u001b[1m\u001b[34musers_output\u001b[0m: \u001b[1m\u001b[32morg.apache.spark.sql.DataFrame\u001b[0m = [userid: int, features: vector]\n"
          }
        ]
      },
      "apps": [],
      "runtimeInfos": {
        "jobUrl": {
          "propertyName": "jobUrl",
          "label": "SPARK JOB",
          "tooltip": "View in Spark web UI",
          "group": "spark",
          "values": [
            {
              "jobUrl": "http://e67d52a5ef45:4040/jobs/job?id=1045",
              "$$hashKey": "object:87517"
            }
          ],
          "interpreterSettingId": "spark"
        }
      },
      "progressUpdateIntervalMs": 500,
      "jobName": "paragraph_1618453647592_1677904723",
      "id": "paragraph_1617911210831_556723385",
      "dateCreated": "2021-04-15T02:27:27+0000",
      "dateStarted": "2021-04-15T03:27:40+0000",
      "dateFinished": "2021-04-15T03:27:41+0000",
      "status": "FINISHED",
      "$$hashKey": "object:80093"
    },
    {
      "text": "//split data set testing and training\r\nval Array(utraining, utesting) = users_output.randomSplit(Array(0.7, 0.3), seed = 1234)\r\n",
      "user": "anonymous",
      "dateUpdated": "2021-04-15T03:27:41+0000",
      "config": {
        "editorSetting": {
          "language": "scala",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "colWidth": 12,
        "editorMode": "ace/mode/scala",
        "fontSize": 9,
        "results": {},
        "enabled": true
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "TEXT",
            "data": "\u001b[1m\u001b[34mutraining\u001b[0m: \u001b[1m\u001b[32morg.apache.spark.sql.Dataset[org.apache.spark.sql.Row]\u001b[0m = [userid: int, features: vector]\n\u001b[1m\u001b[34mutesting\u001b[0m: \u001b[1m\u001b[32morg.apache.spark.sql.Dataset[org.apache.spark.sql.Row]\u001b[0m = [userid: int, features: vector]\n"
          }
        ]
      },
      "apps": [],
      "runtimeInfos": {},
      "progressUpdateIntervalMs": 500,
      "jobName": "paragraph_1618453647593_380030801",
      "id": "paragraph_1617941796221_1908318315",
      "dateCreated": "2021-04-15T02:27:27+0000",
      "dateStarted": "2021-04-15T03:27:41+0000",
      "dateFinished": "2021-04-15T03:27:41+0000",
      "status": "FINISHED",
      "$$hashKey": "object:80094"
    },
    {
      "text": "import org.apache.spark.ml.clustering.KMeans\r\n// using kmeans to model with 11 clusters and fit to training\r\nval model = new KMeans()\r\n    .setK(11)\r\n    .setFeaturesCol(\"features\")\r\n    .setPredictionCol(\"prediction\")\r\n    .fit(utraining)",
      "user": "anonymous",
      "dateUpdated": "2021-04-15T03:27:41+0000",
      "config": {
        "editorSetting": {
          "language": "scala",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "colWidth": 12,
        "editorMode": "ace/mode/scala",
        "fontSize": 9,
        "results": {},
        "enabled": true
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "TEXT",
            "data": "import org.apache.spark.ml.clustering.KMeans\n\u001b[1m\u001b[34mmodel\u001b[0m: \u001b[1m\u001b[32morg.apache.spark.ml.clustering.KMeansModel\u001b[0m = kmeans_069d6b44182c\n"
          }
        ]
      },
      "apps": [],
      "runtimeInfos": {
        "jobUrl": {
          "propertyName": "jobUrl",
          "label": "SPARK JOB",
          "tooltip": "View in Spark web UI",
          "group": "spark",
          "values": [
            {
              "jobUrl": "http://e67d52a5ef45:4040/jobs/job?id=1046",
              "$$hashKey": "object:87643"
            },
            {
              "jobUrl": "http://e67d52a5ef45:4040/jobs/job?id=1047",
              "$$hashKey": "object:87644"
            },
            {
              "jobUrl": "http://e67d52a5ef45:4040/jobs/job?id=1048",
              "$$hashKey": "object:87645"
            },
            {
              "jobUrl": "http://e67d52a5ef45:4040/jobs/job?id=1049",
              "$$hashKey": "object:87646"
            },
            {
              "jobUrl": "http://e67d52a5ef45:4040/jobs/job?id=1050",
              "$$hashKey": "object:87647"
            },
            {
              "jobUrl": "http://e67d52a5ef45:4040/jobs/job?id=1051",
              "$$hashKey": "object:87648"
            },
            {
              "jobUrl": "http://e67d52a5ef45:4040/jobs/job?id=1052",
              "$$hashKey": "object:87649"
            },
            {
              "jobUrl": "http://e67d52a5ef45:4040/jobs/job?id=1053",
              "$$hashKey": "object:87650"
            },
            {
              "jobUrl": "http://e67d52a5ef45:4040/jobs/job?id=1054",
              "$$hashKey": "object:87651"
            },
            {
              "jobUrl": "http://e67d52a5ef45:4040/jobs/job?id=1055",
              "$$hashKey": "object:87652"
            },
            {
              "jobUrl": "http://e67d52a5ef45:4040/jobs/job?id=1056",
              "$$hashKey": "object:87653"
            },
            {
              "jobUrl": "http://e67d52a5ef45:4040/jobs/job?id=1057",
              "$$hashKey": "object:87654"
            },
            {
              "jobUrl": "http://e67d52a5ef45:4040/jobs/job?id=1058",
              "$$hashKey": "object:87655"
            },
            {
              "jobUrl": "http://e67d52a5ef45:4040/jobs/job?id=1059",
              "$$hashKey": "object:87656"
            },
            {
              "jobUrl": "http://e67d52a5ef45:4040/jobs/job?id=1060",
              "$$hashKey": "object:87657"
            },
            {
              "jobUrl": "http://e67d52a5ef45:4040/jobs/job?id=1061",
              "$$hashKey": "object:87658"
            },
            {
              "jobUrl": "http://e67d52a5ef45:4040/jobs/job?id=1062",
              "$$hashKey": "object:87659"
            },
            {
              "jobUrl": "http://e67d52a5ef45:4040/jobs/job?id=1063",
              "$$hashKey": "object:87660"
            },
            {
              "jobUrl": "http://e67d52a5ef45:4040/jobs/job?id=1064",
              "$$hashKey": "object:87661"
            },
            {
              "jobUrl": "http://e67d52a5ef45:4040/jobs/job?id=1065",
              "$$hashKey": "object:87662"
            },
            {
              "jobUrl": "http://e67d52a5ef45:4040/jobs/job?id=1066",
              "$$hashKey": "object:87663"
            },
            {
              "jobUrl": "http://e67d52a5ef45:4040/jobs/job?id=1067",
              "$$hashKey": "object:87664"
            },
            {
              "jobUrl": "http://e67d52a5ef45:4040/jobs/job?id=1068",
              "$$hashKey": "object:87665"
            },
            {
              "jobUrl": "http://e67d52a5ef45:4040/jobs/job?id=1069",
              "$$hashKey": "object:87666"
            },
            {
              "jobUrl": "http://e67d52a5ef45:4040/jobs/job?id=1070",
              "$$hashKey": "object:87667"
            },
            {
              "jobUrl": "http://e67d52a5ef45:4040/jobs/job?id=1071",
              "$$hashKey": "object:87668"
            }
          ],
          "interpreterSettingId": "spark"
        }
      },
      "progressUpdateIntervalMs": 500,
      "jobName": "paragraph_1618453647595_300961214",
      "id": "paragraph_1617934884093_381604690",
      "dateCreated": "2021-04-15T02:27:27+0000",
      "dateStarted": "2021-04-15T03:27:41+0000",
      "dateFinished": "2021-04-15T03:27:44+0000",
      "status": "FINISHED",
      "$$hashKey": "object:80095"
    },
    {
      "text": "// test model with testing set\r\n   val user_predict1 = model.transform(utesting)\r\n   val user_predtrain = model.transform(utraining)\r\n   println(\"View predictions on test set\")\r\n   user_predict1.show(20)",
      "user": "anonymous",
      "dateUpdated": "2021-04-15T03:27:44+0000",
      "config": {
        "editorSetting": {
          "language": "scala",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "colWidth": 12,
        "editorMode": "ace/mode/scala",
        "fontSize": 9,
        "title": false,
        "results": {},
        "enabled": true
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "TEXT",
            "data": "View predictions on test set\n+------+--------------------+----------+\n|userid|            features|prediction|\n+------+--------------------+----------+\n|     1| [6.0,0.0,11.0,86.0]|         7|\n|     2| [34.0,1.0,1.0,13.0]|         6|\n|     3| [9.0,0.0,7.0,307.0]|         0|\n|    14| [29.0,0.0,9.0,14.0]|         6|\n|    27|[18.0,1.0,6.0,336.0]|         0|\n|    28| [10.0,0.0,7.0,44.0]|         2|\n|    32|  [3.0,1.0,0.0,64.0]|         2|\n|    35|[7.0,1.0,20.0,341.0]|         0|\n|    39|[36.0,0.0,13.0,43...|         3|\n|    42| [0.0,0.0,3.0,567.0]|         1|\n|    45| [8.0,0.0,5.0,785.0]|         5|\n|    46|[4.0,1.0,12.0,425.0]|         3|\n|    48|[29.0,0.0,3.0,600.0]|         1|\n|    53|   [5.0,0.0,5.0,0.0]|         6|\n|    63|[14.0,0.0,12.0,25...|         9|\n|    66| [9.0,0.0,0.0,758.0]|         5|\n|    75|[6.0,0.0,13.0,699.0]|         4|\n|    79|[17.0,1.0,3.0,214.0]|         9|\n|    80|[27.0,1.0,3.0,206.0]|         9|\n|    82| [22.0,0.0,5.0,21.0]|         6|\n+------+--------------------+----------+\nonly showing top 20 rows\n\n\u001b[1m\u001b[34muser_predict1\u001b[0m: \u001b[1m\u001b[32morg.apache.spark.sql.DataFrame\u001b[0m = [userid: int, features: vector ... 1 more field]\n\u001b[1m\u001b[34muser_predtrain\u001b[0m: \u001b[1m\u001b[32morg.apache.spark.sql.DataFrame\u001b[0m = [userid: int, features: vector ... 1 more field]\n"
          }
        ]
      },
      "apps": [],
      "runtimeInfos": {
        "jobUrl": {
          "propertyName": "jobUrl",
          "label": "SPARK JOB",
          "tooltip": "View in Spark web UI",
          "group": "spark",
          "values": [
            {
              "jobUrl": "http://e67d52a5ef45:4040/jobs/job?id=1072",
              "$$hashKey": "object:87834"
            }
          ],
          "interpreterSettingId": "spark"
        }
      },
      "progressUpdateIntervalMs": 500,
      "jobName": "paragraph_1618453647596_242254318",
      "id": "paragraph_1617941971210_739532810",
      "dateCreated": "2021-04-15T02:27:27+0000",
      "dateStarted": "2021-04-15T03:27:44+0000",
      "dateFinished": "2021-04-15T03:27:45+0000",
      "status": "FINISHED",
      "$$hashKey": "object:80096"
    },
    {
      "text": "//combining training and testing\nval user_predict = user_predict1.union(user_predtrain)",
      "user": "anonymous",
      "dateUpdated": "2021-04-15T03:27:45+0000",
      "config": {
        "colWidth": 12,
        "fontSize": 9,
        "enabled": true,
        "results": {},
        "editorSetting": {
          "language": "scala",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "editorMode": "ace/mode/scala"
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "TEXT",
            "data": "\u001b[1m\u001b[34muser_predict\u001b[0m: \u001b[1m\u001b[32morg.apache.spark.sql.Dataset[org.apache.spark.sql.Row]\u001b[0m = [userid: int, features: vector ... 1 more field]\n"
          }
        ]
      },
      "apps": [],
      "runtimeInfos": {},
      "progressUpdateIntervalMs": 500,
      "jobName": "paragraph_1618456303836_890394562",
      "id": "paragraph_1618456303836_890394562",
      "dateCreated": "2021-04-15T03:11:43+0000",
      "dateStarted": "2021-04-15T03:27:45+0000",
      "dateFinished": "2021-04-15T03:27:46+0000",
      "status": "FINISHED",
      "$$hashKey": "object:80097"
    },
    {
      "text": "//renaming columns specific to user data set\nval userprd = user_predict.withColumnRenamed(\"userid\", \"user_id\").withColumnRenamed(\"features\", \"ufeatures\").withColumnRenamed(\"prediction\", \"uprediction\")\nuserprd.show(5)",
      "user": "anonymous",
      "dateUpdated": "2021-04-15T03:27:46+0000",
      "config": {
        "editorSetting": {
          "language": "scala",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "colWidth": 12,
        "editorMode": "ace/mode/scala",
        "fontSize": 9,
        "results": {},
        "enabled": true
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "TEXT",
            "data": "+-------+--------------------+-----------+\n|user_id|           ufeatures|uprediction|\n+-------+--------------------+-----------+\n|      1| [6.0,0.0,11.0,86.0]|          7|\n|      2| [34.0,1.0,1.0,13.0]|          6|\n|      3| [9.0,0.0,7.0,307.0]|          0|\n|     14| [29.0,0.0,9.0,14.0]|          6|\n|     27|[18.0,1.0,6.0,336.0]|          0|\n+-------+--------------------+-----------+\nonly showing top 5 rows\n\n\u001b[1m\u001b[34muserprd\u001b[0m: \u001b[1m\u001b[32morg.apache.spark.sql.DataFrame\u001b[0m = [user_id: int, ufeatures: vector ... 1 more field]\n"
          }
        ]
      },
      "apps": [],
      "runtimeInfos": {
        "jobUrl": {
          "propertyName": "jobUrl",
          "label": "SPARK JOB",
          "tooltip": "View in Spark web UI",
          "group": "spark",
          "values": [
            {
              "jobUrl": "http://e67d52a5ef45:4040/jobs/job?id=1073",
              "$$hashKey": "object:87960"
            }
          ],
          "interpreterSettingId": "spark"
        }
      },
      "progressUpdateIntervalMs": 500,
      "jobName": "paragraph_1618453647597_367464221",
      "id": "paragraph_1618145117502_1720689935",
      "dateCreated": "2021-04-15T02:27:27+0000",
      "dateStarted": "2021-04-15T03:27:46+0000",
      "dateFinished": "2021-04-15T03:27:47+0000",
      "status": "FINISHED",
      "$$hashKey": "object:80098"
    },
    {
      "text": "// Evaluate clustering by computing Silhouette score\r\n//Its value ranges from -1 to 1.\r\n// 1: Means clusters are well apart from each other and clearly distinguished.\r\n// 0: Means clusters are indifferent, or we can say that the distance between clusters is not significant.\r\nimport org.apache.spark.ml.evaluation.ClusteringEvaluator\r\nval evaluator = new ClusteringEvaluator()",
      "user": "anonymous",
      "dateUpdated": "2021-04-15T03:27:47+0000",
      "config": {
        "editorSetting": {
          "language": "scala",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "colWidth": 12,
        "editorMode": "ace/mode/scala",
        "fontSize": 9,
        "results": {},
        "enabled": true
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "TEXT",
            "data": "import org.apache.spark.ml.evaluation.ClusteringEvaluator\n\u001b[1m\u001b[34mevaluator\u001b[0m: \u001b[1m\u001b[32morg.apache.spark.ml.evaluation.ClusteringEvaluator\u001b[0m = cluEval_947b4dceb7e1\n"
          }
        ]
      },
      "apps": [],
      "runtimeInfos": {},
      "progressUpdateIntervalMs": 500,
      "jobName": "paragraph_1618453647599_2017930753",
      "id": "paragraph_1617942256393_340649221",
      "dateCreated": "2021-04-15T02:27:27+0000",
      "dateStarted": "2021-04-15T03:27:47+0000",
      "dateFinished": "2021-04-15T03:27:47+0000",
      "status": "FINISHED",
      "$$hashKey": "object:80099"
    },
    {
      "text": "//A score of 0.6 since it is closer to 1, suggest that the clusters are fairly well apart from each other\r\nval silhouette = evaluator.evaluate(user_predict1)\r\nprintln(s\"Silhouette with squared euclidean distance = $silhouette\")",
      "user": "anonymous",
      "dateUpdated": "2021-04-15T03:27:47+0000",
      "config": {
        "editorSetting": {
          "language": "scala",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "colWidth": 12,
        "editorMode": "ace/mode/scala",
        "fontSize": 9,
        "results": {},
        "enabled": true
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "TEXT",
            "data": "Silhouette with squared euclidean distance = 0.6121683461022298\n\u001b[1m\u001b[34msilhouette\u001b[0m: \u001b[1m\u001b[32mDouble\u001b[0m = 0.6121683461022298\n"
          }
        ]
      },
      "apps": [],
      "runtimeInfos": {
        "jobUrl": {
          "propertyName": "jobUrl",
          "label": "SPARK JOB",
          "tooltip": "View in Spark web UI",
          "group": "spark",
          "values": [
            {
              "jobUrl": "http://e67d52a5ef45:4040/jobs/job?id=1074",
              "$$hashKey": "object:88086"
            },
            {
              "jobUrl": "http://e67d52a5ef45:4040/jobs/job?id=1075",
              "$$hashKey": "object:88087"
            }
          ],
          "interpreterSettingId": "spark"
        }
      },
      "progressUpdateIntervalMs": 500,
      "jobName": "paragraph_1618453647600_1403343170",
      "id": "paragraph_1617942247829_170180516",
      "dateCreated": "2021-04-15T02:27:27+0000",
      "dateStarted": "2021-04-15T03:27:47+0000",
      "dateFinished": "2021-04-15T03:27:49+0000",
      "status": "FINISHED",
      "$$hashKey": "object:80100"
    },
    {
      "title": "Combining user and movie predicted values to ratings table",
      "text": "//joing tables\nval ratings_new = ratings.join(userprd, ratings(\"userid\") === userprd(\"user_id\"), \"left\")\nval ratings1 = ratings_new.join(movieprd, ratings(\"movieid\") === movieprd(\"movie_id\"), \"left\")\nratings1.show()\n// as it turns out not all movies from u.items rated a movie and not all users from u.users rated a movie",
      "user": "anonymous",
      "dateUpdated": "2021-04-15T03:27:49+0000",
      "config": {
        "editorSetting": {
          "language": "scala",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "colWidth": 12,
        "editorMode": "ace/mode/scala",
        "fontSize": 9,
        "title": true,
        "results": {},
        "enabled": true
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "TEXT",
            "data": "+------+-------+------+---------+-------+--------------------+-----------+--------+--------------------+-----------+\n|userid|movieid|rating|timestamp|user_id|           ufeatures|uprediction|movie_id|           mfeatures|mprediction|\n+------+-------+------+---------+-------+--------------------+-----------+--------+--------------------+-----------+\n|   196|    242|     3|881250949|    196|  [25.0,0.0,7.0,1.0]|          6|     242|(22,[0,1,2,8],[12...|         11|\n|   186|    302|     3|891717742|    186| [17.0,1.0,8.0,68.0]|          2|     302|(22,[0,1,2,9,13,1...|         12|\n|    22|    377|     1|878887116|     22| [1.0,0.0,7.0,409.0]|          3|     377|(22,[0,1,2,7,8],[...|          3|\n|   244|     51|     2|880606923|    244| [3.0,0.0,11.0,27.0]|          6|      51|(22,[0,1,2,11,17,...|         12|\n|   166|    346|     1|886397596|    166| [31.0,0.0,2.0,15.0]|          6|     346|(22,[0,1,2,9,11],...|          3|\n|   298|    474|     4|884182806|    298|[16.0,0.0,8.0,787.0]|          5|     474|(22,[0,1,2,18,20]...|         10|\n|   115|    265|     2|881171488|    115|[14.0,0.0,4.0,349.0]|          0|     265|(22,[0,1,2,4,19],...|          7|\n|   253|    465|     5|891628467|    253|  [5.0,1.0,6.0,16.0]|          6|     465|(22,[0,1,2,5,7,17...|         12|\n|   305|    451|     3|886324817|    305| [9.0,0.0,5.0,100.0]|          7|     451|(22,[0,1,2,8,15,1...|         11|\n|     6|     86|     3|883603013|      6|[20.0,0.0,8.0,162.0]|         10|      86|(22,[0,1,2,11],[1...|         10|\n|    62|    257|     2|879372434|     62| [4.0,1.0,3.0,209.0]|          9|     257|(22,[0,1,2,4,5,8,...|          3|\n|   286|   1014|     5|879781125|    286| [4.0,0.0,0.0,222.0]|          9|    1014|(22,[0,1,2,8],[64...|          0|\n|   200|    222|     5|876042340|    200|[18.0,0.0,5.0,142.0]|         10|     222|(22,[0,1,2,4,5,18...|          9|\n|   210|     40|     3|891035994|    210|[17.0,0.0,4.0,693.0]|          4|      40|(22,[0,2,8],[543....|          4|\n|   224|     29|     3|888104457|    224|[14.0,1.0,2.0,519.0]|          8|      29|(22,[0,2,4,5,8,9]...|          0|\n|   303|    785|     3|879485318|    303|[15.0,0.0,0.0,684.0]|          4|     785|(22,[0,1,2,8,17],...|          2|\n|   122|    387|     5|879270459|    122| [10.0,1.0,7.0,31.0]|          6|     387|(22,[0,1,2,11],[1...|          1|\n|   194|    274|     2|879539794|    194| [28.0,0.0,3.0,94.0]|          7|     274|(22,[0,2,8,17],[8...|          8|\n|   291|   1042|     4|874834944|    291|[15.0,0.0,0.0,292.0]|          0|    1042|(22,[0,2,16,19],[...|          3|\n|   234|   1184|     2|892079237|    234|[38.0,0.0,15.0,65...|          4|    1184|(22,[0,1,2,10],[9...|          9|\n+------+-------+------+---------+-------+--------------------+-----------+--------+--------------------+-----------+\nonly showing top 20 rows\n\n\u001b[1m\u001b[34mratings_new\u001b[0m: \u001b[1m\u001b[32morg.apache.spark.sql.DataFrame\u001b[0m = [userid: int, movieid: int ... 5 more fields]\n\u001b[1m\u001b[34mratings1\u001b[0m: \u001b[1m\u001b[32morg.apache.spark.sql.DataFrame\u001b[0m = [userid: int, movieid: int ... 8 more fields]\n"
          }
        ]
      },
      "apps": [],
      "runtimeInfos": {
        "jobUrl": {
          "propertyName": "jobUrl",
          "label": "SPARK JOB",
          "tooltip": "View in Spark web UI",
          "group": "spark",
          "values": [
            {
              "jobUrl": "http://e67d52a5ef45:4040/jobs/job?id=1076",
              "$$hashKey": "object:88157"
            },
            {
              "jobUrl": "http://e67d52a5ef45:4040/jobs/job?id=1077",
              "$$hashKey": "object:88158"
            },
            {
              "jobUrl": "http://e67d52a5ef45:4040/jobs/job?id=1078",
              "$$hashKey": "object:88159"
            }
          ],
          "interpreterSettingId": "spark"
        }
      },
      "progressUpdateIntervalMs": 500,
      "jobName": "paragraph_1618453647603_1012487244",
      "id": "paragraph_1618145301611_1078628365",
      "dateCreated": "2021-04-15T02:27:27+0000",
      "dateStarted": "2021-04-15T03:27:49+0000",
      "dateFinished": "2021-04-15T03:27:52+0000",
      "status": "FINISHED",
      "$$hashKey": "object:80101"
    },
    {
      "text": "//checking if user 196 \nuserprd.filter(userprd(\"user_id\") === 196).show(false)",
      "user": "anonymous",
      "dateUpdated": "2021-04-15T03:27:52+0000",
      "config": {
        "editorSetting": {
          "language": "scala",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "colWidth": 12,
        "editorMode": "ace/mode/scala",
        "fontSize": 9,
        "results": {},
        "enabled": true
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "TEXT",
            "data": "+-------+------------------+-----------+\n|user_id|ufeatures         |uprediction|\n+-------+------------------+-----------+\n|196    |[25.0,0.0,7.0,1.0]|6          |\n+-------+------------------+-----------+\n\n"
          }
        ]
      },
      "apps": [],
      "runtimeInfos": {
        "jobUrl": {
          "propertyName": "jobUrl",
          "label": "SPARK JOB",
          "tooltip": "View in Spark web UI",
          "group": "spark",
          "values": [
            {
              "jobUrl": "http://e67d52a5ef45:4040/jobs/job?id=1079",
              "$$hashKey": "object:88233"
            },
            {
              "jobUrl": "http://e67d52a5ef45:4040/jobs/job?id=1080",
              "$$hashKey": "object:88234"
            }
          ],
          "interpreterSettingId": "spark"
        }
      },
      "progressUpdateIntervalMs": 500,
      "jobName": "paragraph_1618453647605_1985393234",
      "id": "paragraph_1618146109773_1389855810",
      "dateCreated": "2021-04-15T02:27:27+0000",
      "dateStarted": "2021-04-15T03:27:52+0000",
      "dateFinished": "2021-04-15T03:27:53+0000",
      "status": "FINISHED",
      "$$hashKey": "object:80102"
    },
    {
      "text": "movieprd.filter(movieprd(\"movie_id\") === 302).show(false)\n//as it turns out not all movies were rated",
      "user": "anonymous",
      "dateUpdated": "2021-04-15T03:27:53+0000",
      "config": {
        "editorSetting": {
          "language": "scala",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "colWidth": 12,
        "editorMode": "ace/mode/scala",
        "fontSize": 9,
        "results": {},
        "enabled": true
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "TEXT",
            "data": "+--------+-----------------------------------------------------------+-----------+\n|movie_id|mfeatures                                                  |mprediction|\n+--------+-----------------------------------------------------------+-----------+\n|302     |(22,[0,1,2,9,13,16,19],[1153.0,3.0,1636.0,1.0,1.0,1.0,1.0])|12         |\n+--------+-----------------------------------------------------------+-----------+\n\n"
          }
        ]
      },
      "apps": [],
      "runtimeInfos": {
        "jobUrl": {
          "propertyName": "jobUrl",
          "label": "SPARK JOB",
          "tooltip": "View in Spark web UI",
          "group": "spark",
          "values": [
            {
              "jobUrl": "http://e67d52a5ef45:4040/jobs/job?id=1081",
              "$$hashKey": "object:88304"
            },
            {
              "jobUrl": "http://e67d52a5ef45:4040/jobs/job?id=1082",
              "$$hashKey": "object:88305"
            }
          ],
          "interpreterSettingId": "spark"
        }
      },
      "progressUpdateIntervalMs": 500,
      "jobName": "paragraph_1618453647606_1129894755",
      "id": "paragraph_1618146437985_690388406",
      "dateCreated": "2021-04-15T02:27:27+0000",
      "dateStarted": "2021-04-15T03:27:53+0000",
      "dateFinished": "2021-04-15T03:27:55+0000",
      "status": "FINISHED",
      "$$hashKey": "object:80103"
    },
    {
      "text": "//filtering / drop out out null rows\nval ratings_nw = ratings1.na.drop()\nratings_nw.show()",
      "user": "anonymous",
      "dateUpdated": "2021-04-15T03:27:55+0000",
      "config": {
        "editorSetting": {
          "language": "scala",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "colWidth": 12,
        "editorMode": "ace/mode/scala",
        "fontSize": 9,
        "results": {},
        "enabled": true
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "TEXT",
            "data": "+------+-------+------+---------+-------+--------------------+-----------+--------+--------------------+-----------+\n|userid|movieid|rating|timestamp|user_id|           ufeatures|uprediction|movie_id|           mfeatures|mprediction|\n+------+-------+------+---------+-------+--------------------+-----------+--------+--------------------+-----------+\n|   196|    242|     3|881250949|    196|  [25.0,0.0,7.0,1.0]|          6|     242|(22,[0,1,2,8],[12...|         11|\n|   186|    302|     3|891717742|    186| [17.0,1.0,8.0,68.0]|          2|     302|(22,[0,1,2,9,13,1...|         12|\n|    22|    377|     1|878887116|     22| [1.0,0.0,7.0,409.0]|          3|     377|(22,[0,1,2,7,8],[...|          3|\n|   244|     51|     2|880606923|    244| [3.0,0.0,11.0,27.0]|          6|      51|(22,[0,1,2,11,17,...|         12|\n|   166|    346|     1|886397596|    166| [31.0,0.0,2.0,15.0]|          6|     346|(22,[0,1,2,9,11],...|          3|\n|   298|    474|     4|884182806|    298|[16.0,0.0,8.0,787.0]|          5|     474|(22,[0,1,2,18,20]...|         10|\n|   115|    265|     2|881171488|    115|[14.0,0.0,4.0,349.0]|          0|     265|(22,[0,1,2,4,19],...|          7|\n|   253|    465|     5|891628467|    253|  [5.0,1.0,6.0,16.0]|          6|     465|(22,[0,1,2,5,7,17...|         12|\n|   305|    451|     3|886324817|    305| [9.0,0.0,5.0,100.0]|          7|     451|(22,[0,1,2,8,15,1...|         11|\n|     6|     86|     3|883603013|      6|[20.0,0.0,8.0,162.0]|         10|      86|(22,[0,1,2,11],[1...|         10|\n|    62|    257|     2|879372434|     62| [4.0,1.0,3.0,209.0]|          9|     257|(22,[0,1,2,4,5,8,...|          3|\n|   286|   1014|     5|879781125|    286| [4.0,0.0,0.0,222.0]|          9|    1014|(22,[0,1,2,8],[64...|          0|\n|   200|    222|     5|876042340|    200|[18.0,0.0,5.0,142.0]|         10|     222|(22,[0,1,2,4,5,18...|          9|\n|   210|     40|     3|891035994|    210|[17.0,0.0,4.0,693.0]|          4|      40|(22,[0,2,8],[543....|          4|\n|   224|     29|     3|888104457|    224|[14.0,1.0,2.0,519.0]|          8|      29|(22,[0,2,4,5,8,9]...|          0|\n|   303|    785|     3|879485318|    303|[15.0,0.0,0.0,684.0]|          4|     785|(22,[0,1,2,8,17],...|          2|\n|   122|    387|     5|879270459|    122| [10.0,1.0,7.0,31.0]|          6|     387|(22,[0,1,2,11],[1...|          1|\n|   194|    274|     2|879539794|    194| [28.0,0.0,3.0,94.0]|          7|     274|(22,[0,2,8,17],[8...|          8|\n|   291|   1042|     4|874834944|    291|[15.0,0.0,0.0,292.0]|          0|    1042|(22,[0,2,16,19],[...|          3|\n|   234|   1184|     2|892079237|    234|[38.0,0.0,15.0,65...|          4|    1184|(22,[0,1,2,10],[9...|          9|\n+------+-------+------+---------+-------+--------------------+-----------+--------+--------------------+-----------+\nonly showing top 20 rows\n\n\u001b[1m\u001b[34mratings_nw\u001b[0m: \u001b[1m\u001b[32morg.apache.spark.sql.DataFrame\u001b[0m = [userid: int, movieid: int ... 8 more fields]\n"
          }
        ]
      },
      "apps": [],
      "runtimeInfos": {
        "jobUrl": {
          "propertyName": "jobUrl",
          "label": "SPARK JOB",
          "tooltip": "View in Spark web UI",
          "group": "spark",
          "values": [
            {
              "jobUrl": "http://e67d52a5ef45:4040/jobs/job?id=1083",
              "$$hashKey": "object:88375"
            },
            {
              "jobUrl": "http://e67d52a5ef45:4040/jobs/job?id=1084",
              "$$hashKey": "object:88376"
            },
            {
              "jobUrl": "http://e67d52a5ef45:4040/jobs/job?id=1085",
              "$$hashKey": "object:88377"
            }
          ],
          "interpreterSettingId": "spark"
        }
      },
      "progressUpdateIntervalMs": 500,
      "jobName": "paragraph_1618453647606_128236457",
      "id": "paragraph_1618147169179_2093723530",
      "dateCreated": "2021-04-15T02:27:27+0000",
      "dateStarted": "2021-04-15T03:27:55+0000",
      "dateFinished": "2021-04-15T03:27:57+0000",
      "status": "FINISHED",
      "$$hashKey": "object:80104"
    },
    {
      "text": "//only 7427 ratings applies to collaberative filting model\nratings_nw.count",
      "user": "anonymous",
      "dateUpdated": "2021-04-15T03:27:57+0000",
      "config": {
        "editorSetting": {
          "language": "scala",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "colWidth": 12,
        "editorMode": "ace/mode/scala",
        "fontSize": 9,
        "results": {},
        "enabled": true
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "TEXT",
            "data": "\u001b[1m\u001b[34mres293\u001b[0m: \u001b[1m\u001b[32mLong\u001b[0m = 100000\n"
          }
        ]
      },
      "apps": [],
      "runtimeInfos": {
        "jobUrl": {
          "propertyName": "jobUrl",
          "label": "SPARK JOB",
          "tooltip": "View in Spark web UI",
          "group": "spark",
          "values": [
            {
              "jobUrl": "http://e67d52a5ef45:4040/jobs/job?id=1086",
              "$$hashKey": "object:88451"
            },
            {
              "jobUrl": "http://e67d52a5ef45:4040/jobs/job?id=1087",
              "$$hashKey": "object:88452"
            },
            {
              "jobUrl": "http://e67d52a5ef45:4040/jobs/job?id=1088",
              "$$hashKey": "object:88453"
            }
          ],
          "interpreterSettingId": "spark"
        }
      },
      "progressUpdateIntervalMs": 500,
      "jobName": "paragraph_1618453647606_1821588754",
      "id": "paragraph_1618147709030_1232819915",
      "dateCreated": "2021-04-15T02:27:27+0000",
      "dateStarted": "2021-04-15T03:27:57+0000",
      "dateFinished": "2021-04-15T03:28:00+0000",
      "status": "FINISHED",
      "$$hashKey": "object:80105"
    },
    {
      "title": "ALS Modeling",
      "text": "//creating training and test data for modeling\nval Array(training, test) = ratings_nw.randomSplit(Array(0.8, 0.2))",
      "user": "anonymous",
      "dateUpdated": "2021-04-15T03:28:00+0000",
      "config": {
        "editorSetting": {
          "language": "scala",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "colWidth": 12,
        "editorMode": "ace/mode/scala",
        "fontSize": 9,
        "title": true,
        "results": {},
        "enabled": true
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "TEXT",
            "data": "\u001b[1m\u001b[34mtraining\u001b[0m: \u001b[1m\u001b[32morg.apache.spark.sql.Dataset[org.apache.spark.sql.Row]\u001b[0m = [userid: int, movieid: int ... 8 more fields]\n\u001b[1m\u001b[34mtest\u001b[0m: \u001b[1m\u001b[32morg.apache.spark.sql.Dataset[org.apache.spark.sql.Row]\u001b[0m = [userid: int, movieid: int ... 8 more fields]\n"
          }
        ]
      },
      "apps": [],
      "runtimeInfos": {},
      "progressUpdateIntervalMs": 500,
      "jobName": "paragraph_1618453647607_109651989",
      "id": "paragraph_1617619700530_1812175532",
      "dateCreated": "2021-04-15T02:27:27+0000",
      "dateStarted": "2021-04-15T03:28:00+0000",
      "dateFinished": "2021-04-15T03:28:01+0000",
      "status": "FINISHED",
      "$$hashKey": "object:80106"
    },
    {
      "text": "//set ALS parameters\r\nval als = new ALS()\r\n      .setMaxIter(5)\r\n      .setRegParam(0.01)\r\n      .setUserCol(\"uprediction\")\r\n      .setItemCol(\"mprediction\")\r\n      .setRatingCol(\"rating\")\r\nval model = als.fit(training)",
      "user": "anonymous",
      "dateUpdated": "2021-04-15T03:28:01+0000",
      "config": {
        "editorSetting": {
          "language": "scala",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "colWidth": 12,
        "editorMode": "ace/mode/scala",
        "fontSize": 9,
        "results": {},
        "enabled": true
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "TEXT",
            "data": "\u001b[1m\u001b[34mals\u001b[0m: \u001b[1m\u001b[32morg.apache.spark.ml.recommendation.ALS\u001b[0m = als_47a5336118e9\n\u001b[1m\u001b[34mmodel\u001b[0m: \u001b[1m\u001b[32morg.apache.spark.ml.recommendation.ALSModel\u001b[0m = als_47a5336118e9\n"
          }
        ]
      },
      "apps": [],
      "runtimeInfos": {
        "jobUrl": {
          "propertyName": "jobUrl",
          "label": "SPARK JOB",
          "tooltip": "View in Spark web UI",
          "group": "spark",
          "values": [
            {
              "jobUrl": "http://e67d52a5ef45:4040/jobs/job?id=1089",
              "$$hashKey": "object:88587"
            },
            {
              "jobUrl": "http://e67d52a5ef45:4040/jobs/job?id=1090",
              "$$hashKey": "object:88588"
            },
            {
              "jobUrl": "http://e67d52a5ef45:4040/jobs/job?id=1091",
              "$$hashKey": "object:88589"
            },
            {
              "jobUrl": "http://e67d52a5ef45:4040/jobs/job?id=1092",
              "$$hashKey": "object:88590"
            },
            {
              "jobUrl": "http://e67d52a5ef45:4040/jobs/job?id=1093",
              "$$hashKey": "object:88591"
            },
            {
              "jobUrl": "http://e67d52a5ef45:4040/jobs/job?id=1094",
              "$$hashKey": "object:88592"
            },
            {
              "jobUrl": "http://e67d52a5ef45:4040/jobs/job?id=1095",
              "$$hashKey": "object:88593"
            },
            {
              "jobUrl": "http://e67d52a5ef45:4040/jobs/job?id=1096",
              "$$hashKey": "object:88594"
            },
            {
              "jobUrl": "http://e67d52a5ef45:4040/jobs/job?id=1097",
              "$$hashKey": "object:88595"
            }
          ],
          "interpreterSettingId": "spark"
        }
      },
      "progressUpdateIntervalMs": 500,
      "jobName": "paragraph_1618453647607_286409571",
      "id": "paragraph_1617624268308_670533",
      "dateCreated": "2021-04-15T02:27:27+0000",
      "dateStarted": "2021-04-15T03:28:01+0000",
      "dateFinished": "2021-04-15T03:28:10+0000",
      "status": "FINISHED",
      "$$hashKey": "object:80107"
    },
    {
      "text": "// Evaluate the model by computing the RMSE on the test data\r\n// Cold start strategy to 'drop' to ensure we don't get NaN evaluation metrics\r\nmodel.setColdStartStrategy(\"drop\")\r\nval predictions = model.transform(test)",
      "user": "anonymous",
      "dateUpdated": "2021-04-15T03:28:10+0000",
      "config": {
        "editorSetting": {
          "language": "scala",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "colWidth": 12,
        "editorMode": "ace/mode/scala",
        "fontSize": 9,
        "results": {},
        "enabled": true
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "TEXT",
            "data": "\u001b[1m\u001b[34mpredictions\u001b[0m: \u001b[1m\u001b[32morg.apache.spark.sql.DataFrame\u001b[0m = [userid: int, movieid: int ... 9 more fields]\n"
          }
        ]
      },
      "apps": [],
      "runtimeInfos": {},
      "progressUpdateIntervalMs": 500,
      "jobName": "paragraph_1618453647608_1737665102",
      "id": "paragraph_1617624296370_2010522577",
      "dateCreated": "2021-04-15T02:27:27+0000",
      "dateStarted": "2021-04-15T03:28:10+0000",
      "dateFinished": "2021-04-15T03:28:10+0000",
      "status": "FINISHED",
      "$$hashKey": "object:80108"
    },
    {
      "text": "// Evaluate Model using RMSE\r\nval evaluator = new RegressionEvaluator().setMetricName(\"rmse\").setLabelCol(\"rating\").setPredictionCol(\"prediction\")\r\nval rmse = evaluator.evaluate(predictions)\r\nprintln(s\"Root-mean-square error = $rmse\")",
      "user": "anonymous",
      "dateUpdated": "2021-04-15T03:28:10+0000",
      "config": {
        "editorSetting": {
          "language": "scala",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "colWidth": 12,
        "editorMode": "ace/mode/scala",
        "fontSize": 9,
        "results": {},
        "enabled": true
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "TEXT",
            "data": "Root-mean-square error = 1.1240891555225592\n\u001b[1m\u001b[34mevaluator\u001b[0m: \u001b[1m\u001b[32morg.apache.spark.ml.evaluation.RegressionEvaluator\u001b[0m = regEval_94b5ee9f3407\n\u001b[1m\u001b[34mrmse\u001b[0m: \u001b[1m\u001b[32mDouble\u001b[0m = 1.1240891555225592\n"
          }
        ]
      },
      "apps": [],
      "runtimeInfos": {
        "jobUrl": {
          "propertyName": "jobUrl",
          "label": "SPARK JOB",
          "tooltip": "View in Spark web UI",
          "group": "spark",
          "values": [
            {
              "jobUrl": "http://e67d52a5ef45:4040/jobs/job?id=1098",
              "$$hashKey": "object:88753"
            },
            {
              "jobUrl": "http://e67d52a5ef45:4040/jobs/job?id=1099",
              "$$hashKey": "object:88754"
            },
            {
              "jobUrl": "http://e67d52a5ef45:4040/jobs/job?id=1100",
              "$$hashKey": "object:88755"
            }
          ],
          "interpreterSettingId": "spark"
        }
      },
      "progressUpdateIntervalMs": 500,
      "jobName": "paragraph_1618453647610_1160106657",
      "id": "paragraph_1617624369045_2044835838",
      "dateCreated": "2021-04-15T02:27:27+0000",
      "dateStarted": "2021-04-15T03:28:11+0000",
      "dateFinished": "2021-04-15T03:28:18+0000",
      "status": "FINISHED",
      "$$hashKey": "object:80109"
    },
    {
      "text": "//rmse value of 1.08 suggest that the error for ratings may be of by up to + /- 1.08",
      "user": "anonymous",
      "dateUpdated": "2021-04-15T03:28:18+0000",
      "config": {
        "editorSetting": {
          "language": "scala",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "colWidth": 12,
        "editorMode": "ace/mode/scala",
        "fontSize": 9,
        "results": {},
        "enabled": true
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": []
      },
      "apps": [],
      "runtimeInfos": {},
      "progressUpdateIntervalMs": 500,
      "jobName": "paragraph_1618453647611_574672204",
      "id": "paragraph_1618198647482_216384442",
      "dateCreated": "2021-04-15T02:27:27+0000",
      "dateStarted": "2021-04-15T03:28:18+0000",
      "dateFinished": "2021-04-15T03:28:19+0000",
      "status": "FINISHED",
      "$$hashKey": "object:80110"
    },
    {
      "text": "\r\n// Generate top 10 movie recommendations for each user (Item to user)\r\nval usertop10 = model.recommendForAllUsers(10)",
      "user": "anonymous",
      "dateUpdated": "2021-04-15T03:28:19+0000",
      "config": {
        "editorSetting": {
          "language": "scala",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "colWidth": 12,
        "editorMode": "ace/mode/scala",
        "fontSize": 9,
        "results": {},
        "enabled": true
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "TEXT",
            "data": "\u001b[1m\u001b[34musertop10\u001b[0m: \u001b[1m\u001b[32morg.apache.spark.sql.DataFrame\u001b[0m = [uprediction: int, recommendations: array<struct<mprediction:int,rating:float>>]\n"
          }
        ]
      },
      "apps": [],
      "runtimeInfos": {},
      "progressUpdateIntervalMs": 500,
      "jobName": "paragraph_1618453647612_1451134626",
      "id": "paragraph_1617624438169_2049725880",
      "dateCreated": "2021-04-15T02:27:27+0000",
      "dateStarted": "2021-04-15T03:28:19+0000",
      "dateFinished": "2021-04-15T03:28:19+0000",
      "status": "FINISHED",
      "$$hashKey": "object:80111"
    },
    {
      "text": "//showing top 10 movie recommendation result for each user cluster\nusertop10.show(false)",
      "user": "anonymous",
      "dateUpdated": "2021-04-15T03:28:20+0000",
      "config": {
        "editorSetting": {
          "language": "scala",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "colWidth": 12,
        "editorMode": "ace/mode/scala",
        "fontSize": 9,
        "results": {},
        "enabled": true
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "TEXT",
            "data": "+-----------+-----------------------------------------------------------------------------------------------------------------------------------------------------------------+\n|uprediction|recommendations                                                                                                                                                  |\n+-----------+-----------------------------------------------------------------------------------------------------------------------------------------------------------------+\n|1          |[[9, 3.7344522], [11, 3.6895113], [3, 3.615375], [2, 3.6074083], [6, 3.5942976], [1, 3.594172], [10, 3.5720842], [12, 3.5700755], [7, 3.5671098], [5, 3.5526936]]|\n|6          |[[9, 3.5733366], [11, 3.5535243], [6, 3.4789753], [2, 3.4599915], [1, 3.446721], [3, 3.442603], [12, 3.4353168], [10, 3.4223464], [7, 3.4148195], [5, 3.407454]] |\n|3          |[[9, 3.7508137], [11, 3.6916137], [2, 3.6202917], [3, 3.6086602], [1, 3.6059725], [6, 3.591074], [7, 3.581559], [12, 3.5647995], [10, 3.56383], [5, 3.543287]]   |\n|5          |[[9, 3.717762], [11, 3.6993835], [1, 3.6192856], [6, 3.6187718], [2, 3.6163058], [12, 3.5847652], [5, 3.5810058], [3, 3.5808816], [10, 3.541251], [7, 3.5358078]]|\n|9          |[[11, 3.4820056], [9, 3.4774356], [1, 3.450091], [12, 3.4398704], [6, 3.4282978], [5, 3.4192297], [3, 3.4187653], [2, 3.406375], [7, 3.396714], [4, 3.3882046]]  |\n|4          |[[9, 3.7251403], [11, 3.6991546], [2, 3.6167424], [6, 3.61387], [1, 3.6034257], [3, 3.5884643], [5, 3.5534854], [12, 3.548649], [10, 3.5470765], [7, 3.529764]]  |\n|8          |[[9, 3.6075418], [11, 3.574305], [2, 3.4871345], [6, 3.4867802], [1, 3.4680483], [3, 3.456501], [12, 3.4467638], [5, 3.4301207], [10, 3.4295683], [7, 3.4169679]]|\n|7          |[[9, 3.5811958], [11, 3.540802], [3, 3.4747171], [2, 3.464569], [7, 3.4633782], [6, 3.461431], [1, 3.4570637], [10, 3.435957], [12, 3.4235988], [5, 3.3903081]]  |\n|10         |[[9, 3.7247577], [11, 3.7088103], [6, 3.634369], [2, 3.6239724], [1, 3.610209], [3, 3.586355], [10, 3.5486183], [5, 3.5473657], [12, 3.543319], [7, 3.538237]]   |\n|2          |[[9, 3.782431], [11, 3.7645237], [6, 3.6924336], [2, 3.6609268], [1, 3.6389449], [12, 3.623948], [3, 3.6185083], [7, 3.6099305], [10, 3.6091387], [5, 3.585298]] |\n|0          |[[11, 3.7943492], [9, 3.7940483], [6, 3.7207386], [2, 3.6947098], [1, 3.6783404], [3, 3.651936], [5, 3.648193], [12, 3.6299126], [10, 3.6179707], [4, 3.5987997]]|\n+-----------+-----------------------------------------------------------------------------------------------------------------------------------------------------------------+\n\n"
          }
        ]
      },
      "apps": [],
      "runtimeInfos": {
        "jobUrl": {
          "propertyName": "jobUrl",
          "label": "SPARK JOB",
          "tooltip": "View in Spark web UI",
          "group": "spark",
          "values": [
            {
              "jobUrl": "http://e67d52a5ef45:4040/jobs/job?id=1101",
              "$$hashKey": "object:88939"
            },
            {
              "jobUrl": "http://e67d52a5ef45:4040/jobs/job?id=1102",
              "$$hashKey": "object:88940"
            },
            {
              "jobUrl": "http://e67d52a5ef45:4040/jobs/job?id=1103",
              "$$hashKey": "object:88941"
            },
            {
              "jobUrl": "http://e67d52a5ef45:4040/jobs/job?id=1104",
              "$$hashKey": "object:88942"
            },
            {
              "jobUrl": "http://e67d52a5ef45:4040/jobs/job?id=1105",
              "$$hashKey": "object:88943"
            }
          ],
          "interpreterSettingId": "spark"
        }
      },
      "progressUpdateIntervalMs": 500,
      "jobName": "paragraph_1618453647612_39459044",
      "id": "paragraph_1617624580342_1786390715",
      "dateCreated": "2021-04-15T02:27:27+0000",
      "dateStarted": "2021-04-15T03:28:20+0000",
      "dateFinished": "2021-04-15T03:28:23+0000",
      "status": "FINISHED",
      "$$hashKey": "object:80112"
    },
    {
      "text": "//showing user to movie recommendations. From the recommndations list values are listed in order of ratings \n//position 0 is ther movie id and and position 1 is the predicted rating a user would give\nval idusr = ratings_nw.select(\"userid\", \"uprediction\")\nval idusers = idusr.withColumnRenamed(\"uprediction\", \"u_prediction\")\nval userrec10  = idusers.join(usertop10, idusers(\"u_prediction\") === usertop10(\"uprediction\"))\nval userrecs = userrec10.drop(\"u_prediction\")\nuserrecs.show(false)",
      "user": "anonymous",
      "dateUpdated": "2021-04-15T03:28:24+0000",
      "config": {
        "editorSetting": {
          "language": "scala",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "colWidth": 12,
        "editorMode": "ace/mode/scala",
        "fontSize": 9,
        "results": {},
        "enabled": true
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "TEXT",
            "data": "+------+-----------+-----------------------------------------------------------------------------------------------------------------------------------------------------------------+\n|userid|uprediction|recommendations                                                                                                                                                  |\n+------+-----------+-----------------------------------------------------------------------------------------------------------------------------------------------------------------+\n|72    |1          |[[9, 3.7344522], [11, 3.6895113], [3, 3.615375], [2, 3.6074083], [6, 3.5942976], [1, 3.594172], [10, 3.5720842], [12, 3.5700755], [7, 3.5671098], [5, 3.5526936]]|\n|87    |1          |[[9, 3.7344522], [11, 3.6895113], [3, 3.615375], [2, 3.6074083], [6, 3.5942976], [1, 3.594172], [10, 3.5720842], [12, 3.5700755], [7, 3.5671098], [5, 3.5526936]]|\n|42    |1          |[[9, 3.7344522], [11, 3.6895113], [3, 3.615375], [2, 3.6074083], [6, 3.5942976], [1, 3.594172], [10, 3.5720842], [12, 3.5700755], [7, 3.5671098], [5, 3.5526936]]|\n|222   |1          |[[9, 3.7344522], [11, 3.6895113], [3, 3.615375], [2, 3.6074083], [6, 3.5942976], [1, 3.594172], [10, 3.5720842], [12, 3.5700755], [7, 3.5671098], [5, 3.5526936]]|\n|42    |1          |[[9, 3.7344522], [11, 3.6895113], [3, 3.615375], [2, 3.6074083], [6, 3.5942976], [1, 3.594172], [10, 3.5720842], [12, 3.5700755], [7, 3.5671098], [5, 3.5526936]]|\n|87    |1          |[[9, 3.7344522], [11, 3.6895113], [3, 3.615375], [2, 3.6074083], [6, 3.5942976], [1, 3.594172], [10, 3.5720842], [12, 3.5700755], [7, 3.5671098], [5, 3.5526936]]|\n|145   |1          |[[9, 3.7344522], [11, 3.6895113], [3, 3.615375], [2, 3.6074083], [6, 3.5942976], [1, 3.594172], [10, 3.5720842], [12, 3.5700755], [7, 3.5671098], [5, 3.5526936]]|\n|135   |1          |[[9, 3.7344522], [11, 3.6895113], [3, 3.615375], [2, 3.6074083], [6, 3.5942976], [1, 3.594172], [10, 3.5720842], [12, 3.5700755], [7, 3.5671098], [5, 3.5526936]]|\n|271   |1          |[[9, 3.7344522], [11, 3.6895113], [3, 3.615375], [2, 3.6074083], [6, 3.5942976], [1, 3.594172], [10, 3.5720842], [12, 3.5700755], [7, 3.5671098], [5, 3.5526936]]|\n|42    |1          |[[9, 3.7344522], [11, 3.6895113], [3, 3.615375], [2, 3.6074083], [6, 3.5942976], [1, 3.594172], [10, 3.5720842], [12, 3.5700755], [7, 3.5671098], [5, 3.5526936]]|\n|271   |1          |[[9, 3.7344522], [11, 3.6895113], [3, 3.615375], [2, 3.6074083], [6, 3.5942976], [1, 3.594172], [10, 3.5720842], [12, 3.5700755], [7, 3.5671098], [5, 3.5526936]]|\n|94    |1          |[[9, 3.7344522], [11, 3.6895113], [3, 3.615375], [2, 3.6074083], [6, 3.5942976], [1, 3.594172], [10, 3.5720842], [12, 3.5700755], [7, 3.5671098], [5, 3.5526936]]|\n|72    |1          |[[9, 3.7344522], [11, 3.6895113], [3, 3.615375], [2, 3.6074083], [6, 3.5942976], [1, 3.594172], [10, 3.5720842], [12, 3.5700755], [7, 3.5671098], [5, 3.5526936]]|\n|222   |1          |[[9, 3.7344522], [11, 3.6895113], [3, 3.615375], [2, 3.6074083], [6, 3.5942976], [1, 3.594172], [10, 3.5720842], [12, 3.5700755], [7, 3.5671098], [5, 3.5526936]]|\n|87    |1          |[[9, 3.7344522], [11, 3.6895113], [3, 3.615375], [2, 3.6074083], [6, 3.5942976], [1, 3.594172], [10, 3.5720842], [12, 3.5700755], [7, 3.5671098], [5, 3.5526936]]|\n|42    |1          |[[9, 3.7344522], [11, 3.6895113], [3, 3.615375], [2, 3.6074083], [6, 3.5942976], [1, 3.594172], [10, 3.5720842], [12, 3.5700755], [7, 3.5671098], [5, 3.5526936]]|\n|172   |1          |[[9, 3.7344522], [11, 3.6895113], [3, 3.615375], [2, 3.6074083], [6, 3.5942976], [1, 3.594172], [10, 3.5720842], [12, 3.5700755], [7, 3.5671098], [5, 3.5526936]]|\n|19    |1          |[[9, 3.7344522], [11, 3.6895113], [3, 3.615375], [2, 3.6074083], [6, 3.5942976], [1, 3.594172], [10, 3.5720842], [12, 3.5700755], [7, 3.5671098], [5, 3.5526936]]|\n|18    |1          |[[9, 3.7344522], [11, 3.6895113], [3, 3.615375], [2, 3.6074083], [6, 3.5942976], [1, 3.594172], [10, 3.5720842], [12, 3.5700755], [7, 3.5671098], [5, 3.5526936]]|\n|222   |1          |[[9, 3.7344522], [11, 3.6895113], [3, 3.615375], [2, 3.6074083], [6, 3.5942976], [1, 3.594172], [10, 3.5720842], [12, 3.5700755], [7, 3.5671098], [5, 3.5526936]]|\n+------+-----------+-----------------------------------------------------------------------------------------------------------------------------------------------------------------+\nonly showing top 20 rows\n\n\u001b[1m\u001b[34midusr\u001b[0m: \u001b[1m\u001b[32morg.apache.spark.sql.DataFrame\u001b[0m = [userid: int, uprediction: int]\n\u001b[1m\u001b[34midusers\u001b[0m: \u001b[1m\u001b[32morg.apache.spark.sql.DataFrame\u001b[0m = [userid: int, u_prediction: int]\n\u001b[1m\u001b[34muserrec10\u001b[0m: \u001b[1m\u001b[32morg.apache.spark.sql.DataFrame\u001b[0m = [userid: int, u_prediction: int ... 2 more fields]\n\u001b[1m\u001b[34muserrecs\u001b[0m: \u001b[1m\u001b[32morg.apache.spark.sql.DataFrame\u001b[0m = [userid: int, uprediction: int ... 1 more field]\n"
          }
        ]
      },
      "apps": [],
      "runtimeInfos": {
        "jobUrl": {
          "propertyName": "jobUrl",
          "label": "SPARK JOB",
          "tooltip": "View in Spark web UI",
          "group": "spark",
          "values": [
            {
              "jobUrl": "http://e67d52a5ef45:4040/jobs/job?id=1106",
              "$$hashKey": "object:89025"
            },
            {
              "jobUrl": "http://e67d52a5ef45:4040/jobs/job?id=1107",
              "$$hashKey": "object:89026"
            },
            {
              "jobUrl": "http://e67d52a5ef45:4040/jobs/job?id=1108",
              "$$hashKey": "object:89027"
            },
            {
              "jobUrl": "http://e67d52a5ef45:4040/jobs/job?id=1109",
              "$$hashKey": "object:89028"
            },
            {
              "jobUrl": "http://e67d52a5ef45:4040/jobs/job?id=1110",
              "$$hashKey": "object:89029"
            },
            {
              "jobUrl": "http://e67d52a5ef45:4040/jobs/job?id=1111",
              "$$hashKey": "object:89030"
            }
          ],
          "interpreterSettingId": "spark"
        }
      },
      "progressUpdateIntervalMs": 500,
      "jobName": "paragraph_1618453647612_531157234",
      "id": "paragraph_1618148115706_146609220",
      "dateCreated": "2021-04-15T02:27:27+0000",
      "dateStarted": "2021-04-15T03:28:24+0000",
      "dateFinished": "2021-04-15T03:28:30+0000",
      "status": "FINISHED",
      "$$hashKey": "object:80113"
    },
    {
      "text": "//random display of cluster 4 predictions\nuserrecs.filter(userrecs(\"uprediction\") === 4).show(false)",
      "user": "anonymous",
      "dateUpdated": "2021-04-15T03:28:30+0000",
      "config": {
        "editorSetting": {
          "language": "scala",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "colWidth": 12,
        "editorMode": "ace/mode/scala",
        "fontSize": 9,
        "results": {},
        "enabled": true
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "TEXT",
            "data": "+------+-----------+---------------------------------------------------------------------------------------------------------------------------------------------------------------+\n|userid|uprediction|recommendations                                                                                                                                                |\n+------+-----------+---------------------------------------------------------------------------------------------------------------------------------------------------------------+\n|210   |4          |[[9, 3.7251403], [11, 3.6991546], [2, 3.6167424], [6, 3.61387], [1, 3.6034257], [3, 3.5884643], [5, 3.5534854], [12, 3.548649], [10, 3.5470765], [7, 3.529764]]|\n|303   |4          |[[9, 3.7251403], [11, 3.6991546], [2, 3.6167424], [6, 3.61387], [1, 3.6034257], [3, 3.5884643], [5, 3.5534854], [12, 3.548649], [10, 3.5470765], [7, 3.529764]]|\n|234   |4          |[[9, 3.7251403], [11, 3.6991546], [2, 3.6167424], [6, 3.61387], [1, 3.6034257], [3, 3.5884643], [5, 3.5534854], [12, 3.548649], [10, 3.5470765], [7, 3.529764]]|\n|95    |4          |[[9, 3.7251403], [11, 3.6991546], [2, 3.6167424], [6, 3.61387], [1, 3.6034257], [3, 3.5884643], [5, 3.5534854], [12, 3.548649], [10, 3.5470765], [7, 3.529764]]|\n|160   |4          |[[9, 3.7251403], [11, 3.6991546], [2, 3.6167424], [6, 3.61387], [1, 3.6034257], [3, 3.5884643], [5, 3.5534854], [12, 3.548649], [10, 3.5470765], [7, 3.529764]]|\n|225   |4          |[[9, 3.7251403], [11, 3.6991546], [2, 3.6167424], [6, 3.61387], [1, 3.6034257], [3, 3.5884643], [5, 3.5534854], [12, 3.548649], [10, 3.5470765], [7, 3.529764]]|\n|10    |4          |[[9, 3.7251403], [11, 3.6991546], [2, 3.6167424], [6, 3.61387], [1, 3.6034257], [3, 3.5884643], [5, 3.5534854], [12, 3.548649], [10, 3.5470765], [7, 3.529764]]|\n|242   |4          |[[9, 3.7251403], [11, 3.6991546], [2, 3.6167424], [6, 3.61387], [1, 3.6034257], [3, 3.5884643], [5, 3.5534854], [12, 3.548649], [10, 3.5470765], [7, 3.529764]]|\n|99    |4          |[[9, 3.7251403], [11, 3.6991546], [2, 3.6167424], [6, 3.61387], [1, 3.6034257], [3, 3.5884643], [5, 3.5534854], [12, 3.548649], [10, 3.5470765], [7, 3.529764]]|\n|260   |4          |[[9, 3.7251403], [11, 3.6991546], [2, 3.6167424], [6, 3.61387], [1, 3.6034257], [3, 3.5884643], [5, 3.5534854], [12, 3.548649], [10, 3.5470765], [7, 3.529764]]|\n|25    |4          |[[9, 3.7251403], [11, 3.6991546], [2, 3.6167424], [6, 3.61387], [1, 3.6034257], [3, 3.5884643], [5, 3.5534854], [12, 3.548649], [10, 3.5470765], [7, 3.529764]]|\n|59    |4          |[[9, 3.7251403], [11, 3.6991546], [2, 3.6167424], [6, 3.61387], [1, 3.6034257], [3, 3.5884643], [5, 3.5534854], [12, 3.548649], [10, 3.5470765], [7, 3.529764]]|\n|225   |4          |[[9, 3.7251403], [11, 3.6991546], [2, 3.6167424], [6, 3.61387], [1, 3.6034257], [3, 3.5884643], [5, 3.5534854], [12, 3.548649], [10, 3.5470765], [7, 3.529764]]|\n|225   |4          |[[9, 3.7251403], [11, 3.6991546], [2, 3.6167424], [6, 3.61387], [1, 3.6034257], [3, 3.5884643], [5, 3.5534854], [12, 3.548649], [10, 3.5470765], [7, 3.529764]]|\n|95    |4          |[[9, 3.7251403], [11, 3.6991546], [2, 3.6167424], [6, 3.61387], [1, 3.6034257], [3, 3.5884643], [5, 3.5534854], [12, 3.548649], [10, 3.5470765], [7, 3.529764]]|\n|160   |4          |[[9, 3.7251403], [11, 3.6991546], [2, 3.6167424], [6, 3.61387], [1, 3.6034257], [3, 3.5884643], [5, 3.5534854], [12, 3.548649], [10, 3.5470765], [7, 3.529764]]|\n|59    |4          |[[9, 3.7251403], [11, 3.6991546], [2, 3.6167424], [6, 3.61387], [1, 3.6034257], [3, 3.5884643], [5, 3.5534854], [12, 3.548649], [10, 3.5470765], [7, 3.529764]]|\n|174   |4          |[[9, 3.7251403], [11, 3.6991546], [2, 3.6167424], [6, 3.61387], [1, 3.6034257], [3, 3.5884643], [5, 3.5534854], [12, 3.548649], [10, 3.5470765], [7, 3.529764]]|\n|95    |4          |[[9, 3.7251403], [11, 3.6991546], [2, 3.6167424], [6, 3.61387], [1, 3.6034257], [3, 3.5884643], [5, 3.5534854], [12, 3.548649], [10, 3.5470765], [7, 3.529764]]|\n|160   |4          |[[9, 3.7251403], [11, 3.6991546], [2, 3.6167424], [6, 3.61387], [1, 3.6034257], [3, 3.5884643], [5, 3.5534854], [12, 3.548649], [10, 3.5470765], [7, 3.529764]]|\n+------+-----------+---------------------------------------------------------------------------------------------------------------------------------------------------------------+\nonly showing top 20 rows\n\n"
          }
        ]
      },
      "apps": [],
      "runtimeInfos": {
        "jobUrl": {
          "propertyName": "jobUrl",
          "label": "SPARK JOB",
          "tooltip": "View in Spark web UI",
          "group": "spark",
          "values": [
            {
              "jobUrl": "http://e67d52a5ef45:4040/jobs/job?id=1112",
              "$$hashKey": "object:89116"
            },
            {
              "jobUrl": "http://e67d52a5ef45:4040/jobs/job?id=1113",
              "$$hashKey": "object:89117"
            },
            {
              "jobUrl": "http://e67d52a5ef45:4040/jobs/job?id=1114",
              "$$hashKey": "object:89118"
            },
            {
              "jobUrl": "http://e67d52a5ef45:4040/jobs/job?id=1115",
              "$$hashKey": "object:89119"
            },
            {
              "jobUrl": "http://e67d52a5ef45:4040/jobs/job?id=1116",
              "$$hashKey": "object:89120"
            },
            {
              "jobUrl": "http://e67d52a5ef45:4040/jobs/job?id=1117",
              "$$hashKey": "object:89121"
            }
          ],
          "interpreterSettingId": "spark"
        }
      },
      "progressUpdateIntervalMs": 500,
      "jobName": "paragraph_1618453647614_1651741407",
      "id": "paragraph_1618164047762_1896996490",
      "dateCreated": "2021-04-15T02:27:27+0000",
      "dateStarted": "2021-04-15T03:28:30+0000",
      "dateFinished": "2021-04-15T03:28:47+0000",
      "status": "FINISHED",
      "$$hashKey": "object:80114"
    },
    {
      "text": "// Validate distribution of all user classification\r\nuserrecs.select(\"uprediction\").groupBy(\"uprediction\").agg(count(userrecs(\"uprediction\")).\r\nalias(\"Count\")).orderBy(desc(\"Count\")).show(1000)\r\n// usertypes denoted  classification 6 has the most users of this category",
      "user": "anonymous",
      "dateUpdated": "2021-04-15T03:28:47+0000",
      "config": {
        "editorSetting": {
          "language": "scala",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "colWidth": 12,
        "editorMode": "ace/mode/scala",
        "fontSize": 9,
        "results": {},
        "enabled": true
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "TEXT",
            "data": "+-----------+-----+\n|uprediction|Count|\n+-----------+-----+\n|          6|12904|\n|          4|10571|\n|          8| 9652|\n|          3| 9449|\n|          7| 9122|\n|          9| 9084|\n|          1| 8311|\n|          5| 8252|\n|          2| 7947|\n|         10| 7704|\n|          0| 7004|\n+-----------+-----+\n\n"
          }
        ]
      },
      "apps": [],
      "runtimeInfos": {
        "jobUrl": {
          "propertyName": "jobUrl",
          "label": "SPARK JOB",
          "tooltip": "View in Spark web UI",
          "group": "spark",
          "values": [
            {
              "jobUrl": "http://e67d52a5ef45:4040/jobs/job?id=1118",
              "$$hashKey": "object:89207"
            },
            {
              "jobUrl": "http://e67d52a5ef45:4040/jobs/job?id=1119",
              "$$hashKey": "object:89208"
            },
            {
              "jobUrl": "http://e67d52a5ef45:4040/jobs/job?id=1120",
              "$$hashKey": "object:89209"
            }
          ],
          "interpreterSettingId": "spark"
        }
      },
      "progressUpdateIntervalMs": 500,
      "jobName": "paragraph_1618453647615_993078833",
      "id": "paragraph_1618161995648_1058172938",
      "dateCreated": "2021-04-15T02:27:27+0000",
      "dateStarted": "2021-04-15T03:28:47+0000",
      "dateFinished": "2021-04-15T03:28:54+0000",
      "status": "FINISHED",
      "$$hashKey": "object:80115"
    },
    {
      "text": "// Generate top 10 user recommendations for each movie (User to Item)\r\nval movietop10 = model.recommendForAllItems(10)",
      "user": "anonymous",
      "dateUpdated": "2021-04-15T03:28:54+0000",
      "config": {
        "editorSetting": {
          "language": "scala",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "colWidth": 12,
        "editorMode": "ace/mode/scala",
        "fontSize": 9,
        "results": {},
        "enabled": true
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "TEXT",
            "data": "\u001b[1m\u001b[34mmovietop10\u001b[0m: \u001b[1m\u001b[32morg.apache.spark.sql.DataFrame\u001b[0m = [mprediction: int, recommendations: array<struct<uprediction:int,rating:float>>]\n"
          }
        ]
      },
      "apps": [],
      "runtimeInfos": {},
      "progressUpdateIntervalMs": 500,
      "jobName": "paragraph_1618453647615_1187458867",
      "id": "paragraph_1617624490128_1708582836",
      "dateCreated": "2021-04-15T02:27:27+0000",
      "dateStarted": "2021-04-15T03:28:54+0000",
      "dateFinished": "2021-04-15T03:28:55+0000",
      "status": "FINISHED",
      "$$hashKey": "object:80116"
    },
    {
      "text": "//showing movie to user recommendations. From the recommndations list values are listed in order of ratings \n//position 0 is ther user id and and position 1 is the predicted rating a user would give\nval idmvi = ratings_nw.select(\"movieid\", \"mprediction\")\nval idmvis = idmvi.withColumnRenamed(\"mprediction\", \"m_prediction\")\nval movierec10  = idmvis.join(movietop10, idmvis(\"m_prediction\") === movietop10(\"mprediction\"))\nval movierecs = movierec10.drop(\"m_prediction\")\nmovierecs.show(false)",
      "user": "anonymous",
      "dateUpdated": "2021-04-15T03:28:55+0000",
      "config": {
        "editorSetting": {
          "language": "scala",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "colWidth": 12,
        "editorMode": "ace/mode/scala",
        "fontSize": 9,
        "results": {},
        "enabled": true
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "TEXT",
            "data": "+-------+-----------+--------------------------------------------------------------------------------------------------------------------------------------------------------------+\n|movieid|mprediction|recommendations                                                                                                                                               |\n+-------+-----------+--------------------------------------------------------------------------------------------------------------------------------------------------------------+\n|302    |12         |[[0, 3.6299126], [2, 3.623948], [5, 3.5847652], [1, 3.5700755], [3, 3.5647995], [4, 3.548649], [10, 3.543319], [8, 3.4467638], [9, 3.4398704], [6, 3.4353168]]|\n|51     |12         |[[0, 3.6299126], [2, 3.623948], [5, 3.5847652], [1, 3.5700755], [3, 3.5647995], [4, 3.548649], [10, 3.543319], [8, 3.4467638], [9, 3.4398704], [6, 3.4353168]]|\n|465    |12         |[[0, 3.6299126], [2, 3.623948], [5, 3.5847652], [1, 3.5700755], [3, 3.5647995], [4, 3.548649], [10, 3.543319], [8, 3.4467638], [9, 3.4398704], [6, 3.4353168]]|\n|118    |12         |[[0, 3.6299126], [2, 3.623948], [5, 3.5847652], [1, 3.5700755], [3, 3.5647995], [4, 3.548649], [10, 3.543319], [8, 3.4467638], [9, 3.4398704], [6, 3.4353168]]|\n|332    |12         |[[0, 3.6299126], [2, 3.623948], [5, 3.5847652], [1, 3.5700755], [3, 3.5647995], [4, 3.548649], [10, 3.543319], [8, 3.4467638], [9, 3.4398704], [6, 3.4353168]]|\n|432    |12         |[[0, 3.6299126], [2, 3.623948], [5, 3.5847652], [1, 3.5700755], [3, 3.5647995], [4, 3.548649], [10, 3.543319], [8, 3.4467638], [9, 3.4398704], [6, 3.4353168]]|\n|384    |12         |[[0, 3.6299126], [2, 3.623948], [5, 3.5847652], [1, 3.5700755], [3, 3.5647995], [4, 3.548649], [10, 3.543319], [8, 3.4467638], [9, 3.4398704], [6, 3.4353168]]|\n|219    |12         |[[0, 3.6299126], [2, 3.623948], [5, 3.5847652], [1, 3.5700755], [3, 3.5647995], [4, 3.548649], [10, 3.543319], [8, 3.4467638], [9, 3.4398704], [6, 3.4353168]]|\n|229    |12         |[[0, 3.6299126], [2, 3.623948], [5, 3.5847652], [1, 3.5700755], [3, 3.5647995], [4, 3.548649], [10, 3.543319], [8, 3.4467638], [9, 3.4398704], [6, 3.4353168]]|\n|229    |12         |[[0, 3.6299126], [2, 3.623948], [5, 3.5847652], [1, 3.5700755], [3, 3.5647995], [4, 3.548649], [10, 3.543319], [8, 3.4467638], [9, 3.4398704], [6, 3.4353168]]|\n|208    |12         |[[0, 3.6299126], [2, 3.623948], [5, 3.5847652], [1, 3.5700755], [3, 3.5647995], [4, 3.548649], [10, 3.543319], [8, 3.4467638], [9, 3.4398704], [6, 3.4353168]]|\n|118    |12         |[[0, 3.6299126], [2, 3.623948], [5, 3.5847652], [1, 3.5700755], [3, 3.5647995], [4, 3.548649], [10, 3.543319], [8, 3.4467638], [9, 3.4398704], [6, 3.4353168]]|\n|514    |12         |[[0, 3.6299126], [2, 3.623948], [5, 3.5847652], [1, 3.5700755], [3, 3.5647995], [4, 3.548649], [10, 3.543319], [8, 3.4467638], [9, 3.4398704], [6, 3.4353168]]|\n|317    |12         |[[0, 3.6299126], [2, 3.623948], [5, 3.5847652], [1, 3.5700755], [3, 3.5647995], [4, 3.548649], [10, 3.543319], [8, 3.4467638], [9, 3.4398704], [6, 3.4353168]]|\n|385    |12         |[[0, 3.6299126], [2, 3.623948], [5, 3.5847652], [1, 3.5700755], [3, 3.5647995], [4, 3.548649], [10, 3.543319], [8, 3.4467638], [9, 3.4398704], [6, 3.4353168]]|\n|272    |12         |[[0, 3.6299126], [2, 3.623948], [5, 3.5847652], [1, 3.5700755], [3, 3.5647995], [4, 3.548649], [10, 3.543319], [8, 3.4467638], [9, 3.4398704], [6, 3.4353168]]|\n|514    |12         |[[0, 3.6299126], [2, 3.623948], [5, 3.5847652], [1, 3.5700755], [3, 3.5647995], [4, 3.548649], [10, 3.543319], [8, 3.4467638], [9, 3.4398704], [6, 3.4353168]]|\n|137    |12         |[[0, 3.6299126], [2, 3.623948], [5, 3.5847652], [1, 3.5700755], [3, 3.5647995], [4, 3.548649], [10, 3.543319], [8, 3.4467638], [9, 3.4398704], [6, 3.4353168]]|\n|673    |12         |[[0, 3.6299126], [2, 3.623948], [5, 3.5847652], [1, 3.5700755], [3, 3.5647995], [4, 3.548649], [10, 3.543319], [8, 3.4467638], [9, 3.4398704], [6, 3.4353168]]|\n|1091   |12         |[[0, 3.6299126], [2, 3.623948], [5, 3.5847652], [1, 3.5700755], [3, 3.5647995], [4, 3.548649], [10, 3.543319], [8, 3.4467638], [9, 3.4398704], [6, 3.4353168]]|\n+-------+-----------+--------------------------------------------------------------------------------------------------------------------------------------------------------------+\nonly showing top 20 rows\n\n\u001b[1m\u001b[34midmvi\u001b[0m: \u001b[1m\u001b[32morg.apache.spark.sql.DataFrame\u001b[0m = [movieid: int, mprediction: int]\n\u001b[1m\u001b[34midmvis\u001b[0m: \u001b[1m\u001b[32morg.apache.spark.sql.DataFrame\u001b[0m = [movieid: int, m_prediction: int]\n\u001b[1m\u001b[34mmovierec10\u001b[0m: \u001b[1m\u001b[32morg.apache.spark.sql.DataFrame\u001b[0m = [movieid: int, m_prediction: int ... 2 more fields]\n\u001b[1m\u001b[34mmovierecs\u001b[0m: \u001b[1m\u001b[32morg.apache.spark.sql.DataFrame\u001b[0m = [movieid: int, mprediction: int ... 1 more field]\n"
          }
        ]
      },
      "apps": [],
      "runtimeInfos": {
        "jobUrl": {
          "propertyName": "jobUrl",
          "label": "SPARK JOB",
          "tooltip": "View in Spark web UI",
          "group": "spark",
          "values": [
            {
              "jobUrl": "http://e67d52a5ef45:4040/jobs/job?id=1121",
              "$$hashKey": "object:89343"
            },
            {
              "jobUrl": "http://e67d52a5ef45:4040/jobs/job?id=1122",
              "$$hashKey": "object:89344"
            },
            {
              "jobUrl": "http://e67d52a5ef45:4040/jobs/job?id=1123",
              "$$hashKey": "object:89345"
            },
            {
              "jobUrl": "http://e67d52a5ef45:4040/jobs/job?id=1124",
              "$$hashKey": "object:89346"
            },
            {
              "jobUrl": "http://e67d52a5ef45:4040/jobs/job?id=1125",
              "$$hashKey": "object:89347"
            }
          ],
          "interpreterSettingId": "spark"
        }
      },
      "progressUpdateIntervalMs": 500,
      "jobName": "paragraph_1618453647615_1328669676",
      "id": "paragraph_1618163989391_1909773109",
      "dateCreated": "2021-04-15T02:27:27+0000",
      "dateStarted": "2021-04-15T03:28:55+0000",
      "dateFinished": "2021-04-15T03:29:02+0000",
      "status": "FINISHED",
      "$$hashKey": "object:80117"
    },
    {
      "text": "// Validate distribution of all use classification\r\nmovierecs.select(\"mprediction\").groupBy(\"mprediction\").agg(count(movierecs(\"mprediction\")).\r\nalias(\"Count\")).orderBy(desc(\"Count\")).show(1000)\r\n// movie types denoted  as classification 3 has the most users of this category",
      "user": "anonymous",
      "dateUpdated": "2021-04-15T03:29:02+0000",
      "config": {
        "editorSetting": {
          "language": "scala",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "colWidth": 12,
        "editorMode": "ace/mode/scala",
        "fontSize": 9,
        "results": {},
        "enabled": true
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "TEXT",
            "data": "+-----------+-----+\n|mprediction|Count|\n+-----------+-----+\n|          2|10387|\n|         12| 9440|\n|          3| 8701|\n|          4| 8307|\n|          9| 8063|\n|          6| 7983|\n|         10| 7944|\n|         11| 7762|\n|          1| 7128|\n|          0| 6586|\n|          7| 6140|\n|          5| 6069|\n|          8| 5490|\n+-----------+-----+\n\n"
          }
        ]
      },
      "apps": [],
      "runtimeInfos": {
        "jobUrl": {
          "propertyName": "jobUrl",
          "label": "SPARK JOB",
          "tooltip": "View in Spark web UI",
          "group": "spark",
          "values": [
            {
              "jobUrl": "http://e67d52a5ef45:4040/jobs/job?id=1126",
              "$$hashKey": "object:89429"
            },
            {
              "jobUrl": "http://e67d52a5ef45:4040/jobs/job?id=1127",
              "$$hashKey": "object:89430"
            },
            {
              "jobUrl": "http://e67d52a5ef45:4040/jobs/job?id=1128",
              "$$hashKey": "object:89431"
            }
          ],
          "interpreterSettingId": "spark"
        }
      },
      "progressUpdateIntervalMs": 500,
      "jobName": "paragraph_1618453647616_1091322367",
      "id": "paragraph_1618164382735_1163663814",
      "dateCreated": "2021-04-15T02:27:27+0000",
      "dateStarted": "2021-04-15T03:29:03+0000",
      "dateFinished": "2021-04-15T03:29:11+0000",
      "status": "FINISHED",
      "$$hashKey": "object:80118"
    },
    {
      "title": "Applying Collaberative Filtering to 1M Movie lens Data",
      "text": "",
      "user": "anonymous",
      "dateUpdated": "2021-04-15T03:29:12+0000",
      "config": {
        "editorSetting": {
          "language": "scala",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "colWidth": 12,
        "editorMode": "ace/mode/scala",
        "fontSize": 9,
        "title": true,
        "results": {},
        "enabled": true
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "apps": [],
      "runtimeInfos": {},
      "progressUpdateIntervalMs": 500,
      "jobName": "paragraph_1618453647616_1250256380",
      "id": "paragraph_1618167818724_1392841307",
      "dateCreated": "2021-04-15T02:27:27+0000",
      "status": "FINISHED",
      "$$hashKey": "object:80119"
    },
    {
      "title": "Upload Movie Data",
      "text": "%sh wget https://raw.githubusercontent.com/jcsamuels/UWI-BigData-project1/ML-1M/movies.dat\n",
      "user": "anonymous",
      "dateUpdated": "2021-04-15T03:29:12+0000",
      "config": {
        "editorSetting": {
          "language": "sh",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": false
        },
        "colWidth": 12,
        "editorMode": "ace/mode/sh",
        "fontSize": 9,
        "title": true,
        "results": {},
        "enabled": true
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "TEXT",
            "data": "--2021-04-15 03:29:12--  https://raw.githubusercontent.com/jcsamuels/UWI-BigData-project1/ML-1M/movies.dat\nResolving raw.githubusercontent.com (raw.githubusercontent.com)... 185.199.109.133, 185.199.108.133, 185.199.110.133, ...\nConnecting to raw.githubusercontent.com (raw.githubusercontent.com)|185.199.109.133|:443... connected.\nHTTP request sent, awaiting response... 200 OK\nLength: 171308 (167K) [text/plain]\nSaving to: ‘movies.dat.3’\n\n     0K .......... .......... .......... .......... .......... 29%  571K 0s\n    50K .......... .......... .......... .......... .......... 59% 1.45M 0s\n   100K .......... .......... .......... .......... .......... 89%  771K 0s\n   150K .......... .......                                    100% 1.48M=0.2s\n\n2021-04-15 03:29:14 (847 KB/s) - ‘movies.dat.3’ saved [171308/171308]\n\n"
          }
        ]
      },
      "apps": [],
      "runtimeInfos": {},
      "progressUpdateIntervalMs": 500,
      "jobName": "paragraph_1618453647616_20650033",
      "id": "paragraph_1617949796644_590906136",
      "dateCreated": "2021-04-15T02:27:27+0000",
      "dateStarted": "2021-04-15T03:29:12+0000",
      "dateFinished": "2021-04-15T03:29:14+0000",
      "status": "FINISHED",
      "$$hashKey": "object:80120"
    },
    {
      "text": "\n//importing data that has duplicqates and thefiltering for distinct\nval movies1M = sqlContext.read.format(\"com.databricks.spark.csv\").option(\"sep\", \",\").option(\"header\", false).option(\"inferSchema\", true).load(\"movies.dat\")\nval movies_dupl = movies1M.select(split(col(\"_c0\"),\"::\").getItem(0).as(\"movieid\"),split(col(\"_c0\"),\"::\").getItem(1).as(\"title\"),split(col(\"_c0\"),\"::\").getItem(2).as(\"genre\")).drop(\"_c0\")\nval movies = movies_dupl.distinct()\nval movies2 = movies.dropDuplicates()\nmovies.show(5, false)",
      "user": "anonymous",
      "dateUpdated": "2021-04-15T03:29:14+0000",
      "config": {
        "editorSetting": {
          "language": "scala",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "colWidth": 12,
        "editorMode": "ace/mode/scala",
        "fontSize": 9,
        "results": {},
        "enabled": true
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "TEXT",
            "data": "+-------+--------------------------------------------+-----------------------------------+\n|movieid|title                                       |genre                              |\n+-------+--------------------------------------------+-----------------------------------+\n|392    |Secret Adventures of Tom Thumb              |null                               |\n|715    |Horseman on the Roof                        |null                               |\n|762    |Striptease (1996)                           |Comedy|Crime                       |\n|1073   |Willy Wonka and the Chocolate Factory (1971)|Adventure|Children's|Comedy|Fantasy|\n|1821   |Object of My Affection                      |null                               |\n+-------+--------------------------------------------+-----------------------------------+\nonly showing top 5 rows\n\n\u001b[1m\u001b[34mmovies1M\u001b[0m: \u001b[1m\u001b[32morg.apache.spark.sql.DataFrame\u001b[0m = [_c0: string]\n\u001b[1m\u001b[34mmovies_dupl\u001b[0m: \u001b[1m\u001b[32morg.apache.spark.sql.DataFrame\u001b[0m = [movieid: string, title: string ... 1 more field]\n\u001b[1m\u001b[34mmovies\u001b[0m: \u001b[1m\u001b[32morg.apache.spark.sql.Dataset[org.apache.spark.sql.Row]\u001b[0m = [movieid: string, title: string ... 1 more field]\n\u001b[1m\u001b[34mmovies2\u001b[0m: \u001b[1m\u001b[32morg.apache.spark.sql.Dataset[org.apache.spark.sql.Row]\u001b[0m = [movieid: string, title: string ... 1 more field]\n"
          }
        ]
      },
      "apps": [],
      "runtimeInfos": {
        "jobUrl": {
          "propertyName": "jobUrl",
          "label": "SPARK JOB",
          "tooltip": "View in Spark web UI",
          "group": "spark",
          "values": [
            {
              "jobUrl": "http://e67d52a5ef45:4040/jobs/job?id=1129",
              "$$hashKey": "object:89615"
            },
            {
              "jobUrl": "http://e67d52a5ef45:4040/jobs/job?id=1130",
              "$$hashKey": "object:89616"
            },
            {
              "jobUrl": "http://e67d52a5ef45:4040/jobs/job?id=1131",
              "$$hashKey": "object:89617"
            }
          ],
          "interpreterSettingId": "spark"
        }
      },
      "progressUpdateIntervalMs": 500,
      "jobName": "paragraph_1618453647616_1354638834",
      "id": "paragraph_1618170248674_2131373307",
      "dateCreated": "2021-04-15T02:27:27+0000",
      "dateStarted": "2021-04-15T03:29:14+0000",
      "dateFinished": "2021-04-15T03:29:16+0000",
      "status": "FINISHED",
      "$$hashKey": "object:80121"
    },
    {
      "text": "// checking number of ropws in movies_dupl\nprintln (movies2.count, movies_dupl.count , movies.count)\n// no change",
      "user": "anonymous",
      "dateUpdated": "2021-04-15T03:29:16+0000",
      "config": {
        "editorSetting": {
          "language": "scala",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "colWidth": 12,
        "editorMode": "ace/mode/scala",
        "fontSize": 9,
        "results": {},
        "enabled": true
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "TEXT",
            "data": "(3883,3883,3883)\n"
          }
        ]
      },
      "apps": [],
      "runtimeInfos": {
        "jobUrl": {
          "propertyName": "jobUrl",
          "label": "SPARK JOB",
          "tooltip": "View in Spark web UI",
          "group": "spark",
          "values": [
            {
              "jobUrl": "http://e67d52a5ef45:4040/jobs/job?id=1132",
              "$$hashKey": "object:89691"
            },
            {
              "jobUrl": "http://e67d52a5ef45:4040/jobs/job?id=1133",
              "$$hashKey": "object:89692"
            },
            {
              "jobUrl": "http://e67d52a5ef45:4040/jobs/job?id=1134",
              "$$hashKey": "object:89693"
            }
          ],
          "interpreterSettingId": "spark"
        }
      },
      "progressUpdateIntervalMs": 500,
      "jobName": "paragraph_1618453647617_1768400805",
      "id": "paragraph_1618176522840_1375598577",
      "dateCreated": "2021-04-15T02:27:27+0000",
      "dateStarted": "2021-04-15T03:29:16+0000",
      "dateFinished": "2021-04-15T03:29:21+0000",
      "status": "FINISHED",
      "$$hashKey": "object:80122"
    },
    {
      "text": "// removing duplicate movies which may span id, title and genre\nval movies0 = movies2.dropDuplicates(\"movieid\", \"title\", \"genre\")\nval movies1 = movies0.dropDuplicates(\"title\", \"genre\")\nval movies = movies1.dropDuplicates(\"title\")\n//results indicate duplicates resided only in title and genre\n\nprintln (movies0.count, movies1.count, movies.count)",
      "user": "anonymous",
      "dateUpdated": "2021-04-15T03:29:22+0000",
      "config": {
        "editorSetting": {
          "language": "scala",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "colWidth": 12,
        "editorMode": "ace/mode/scala",
        "fontSize": 9,
        "results": {},
        "enabled": true
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "TEXT",
            "data": "(3883,3856,3856)\n\u001b[1m\u001b[34mmovies0\u001b[0m: \u001b[1m\u001b[32morg.apache.spark.sql.Dataset[org.apache.spark.sql.Row]\u001b[0m = [movieid: string, title: string ... 1 more field]\n\u001b[1m\u001b[34mmovies1\u001b[0m: \u001b[1m\u001b[32morg.apache.spark.sql.Dataset[org.apache.spark.sql.Row]\u001b[0m = [movieid: string, title: string ... 1 more field]\n\u001b[1m\u001b[34mmovies\u001b[0m: \u001b[1m\u001b[32morg.apache.spark.sql.Dataset[org.apache.spark.sql.Row]\u001b[0m = [movieid: string, title: string ... 1 more field]\n"
          }
        ]
      },
      "apps": [],
      "runtimeInfos": {
        "jobUrl": {
          "propertyName": "jobUrl",
          "label": "SPARK JOB",
          "tooltip": "View in Spark web UI",
          "group": "spark",
          "values": [
            {
              "jobUrl": "http://e67d52a5ef45:4040/jobs/job?id=1135",
              "$$hashKey": "object:89767"
            },
            {
              "jobUrl": "http://e67d52a5ef45:4040/jobs/job?id=1136",
              "$$hashKey": "object:89768"
            },
            {
              "jobUrl": "http://e67d52a5ef45:4040/jobs/job?id=1137",
              "$$hashKey": "object:89769"
            }
          ],
          "interpreterSettingId": "spark"
        }
      },
      "progressUpdateIntervalMs": 500,
      "jobName": "paragraph_1618453647617_1537090714",
      "id": "paragraph_1618176652530_286973573",
      "dateCreated": "2021-04-15T02:27:27+0000",
      "dateStarted": "2021-04-15T03:29:22+0000",
      "dateFinished": "2021-04-15T03:29:36+0000",
      "status": "FINISHED",
      "$$hashKey": "object:80123"
    },
    {
      "text": "// checking for total number of missing values for each column\r\nmovies.select(movies.columns.map(c => sum(col(c).isNull.cast(\"int\")).alias(c)): _*).show\r\n// missing genres of 966",
      "user": "anonymous",
      "dateUpdated": "2021-04-15T03:29:36+0000",
      "config": {
        "editorSetting": {
          "language": "scala",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "colWidth": 12,
        "editorMode": "ace/mode/scala",
        "fontSize": 9,
        "results": {},
        "enabled": true
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "TEXT",
            "data": "+-------+-----+-----+\n|movieid|title|genre|\n+-------+-----+-----+\n|      0|    0|  966|\n+-------+-----+-----+\n\n"
          }
        ]
      },
      "apps": [],
      "runtimeInfos": {
        "jobUrl": {
          "propertyName": "jobUrl",
          "label": "SPARK JOB",
          "tooltip": "View in Spark web UI",
          "group": "spark",
          "values": [
            {
              "jobUrl": "http://e67d52a5ef45:4040/jobs/job?id=1138",
              "$$hashKey": "object:89843"
            }
          ],
          "interpreterSettingId": "spark"
        }
      },
      "progressUpdateIntervalMs": 500,
      "jobName": "paragraph_1618453647617_1560173521",
      "id": "paragraph_1618178138031_1102305883",
      "dateCreated": "2021-04-15T02:27:27+0000",
      "dateStarted": "2021-04-15T03:29:37+0000",
      "dateFinished": "2021-04-15T03:29:44+0000",
      "status": "FINISHED",
      "$$hashKey": "object:80124"
    },
    {
      "text": "//checking for null genres\nmovies.filter(\"genre is null\").show",
      "user": "anonymous",
      "dateUpdated": "2021-04-15T03:29:44+0000",
      "config": {
        "editorSetting": {
          "language": "scala",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "colWidth": 12,
        "editorMode": "ace/mode/scala",
        "fontSize": 9,
        "results": {},
        "enabled": true
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "TEXT",
            "data": "+-------+--------------------+-----+\n|movieid|               title|genre|\n+-------+--------------------+-----+\n|   2793|American Werewolf...| null|\n|   3144|   Glass Bottom Boat| null|\n|   1632|    Smile Like Yours| null|\n|    909|           Apartment| null|\n|   1484|         Daytrippers| null|\n|   1628|             Locusts| null|\n|   1938|        Lost Weekend| null|\n|   3868|Naked Gun: From t...| null|\n|   3556|     Virgin Suicides| null|\n|   1728|        Winter Guest| null|\n|   2182|           Wrong Man| null|\n|   2310|              Mighty| null|\n|   3620|Myth of Fingerprints| null|\n|    984|    Pompatus of Love| null|\n|   1820|         Proposition| null|\n|   1234|               Sting| null|\n|   2765|          Acid House| null|\n|   3125|   End of the Affair| null|\n|    972|Last Time I Saw P...| null|\n|   1699|         Butcher Boy| null|\n+-------+--------------------+-----+\nonly showing top 20 rows\n\n"
          }
        ]
      },
      "apps": [],
      "runtimeInfos": {
        "jobUrl": {
          "propertyName": "jobUrl",
          "label": "SPARK JOB",
          "tooltip": "View in Spark web UI",
          "group": "spark",
          "values": [
            {
              "jobUrl": "http://e67d52a5ef45:4040/jobs/job?id=1139",
              "$$hashKey": "object:89909"
            },
            {
              "jobUrl": "http://e67d52a5ef45:4040/jobs/job?id=1140",
              "$$hashKey": "object:89910"
            }
          ],
          "interpreterSettingId": "spark"
        }
      },
      "progressUpdateIntervalMs": 500,
      "jobName": "paragraph_1618453647617_1437063698",
      "id": "paragraph_1618178598012_618314910",
      "dateCreated": "2021-04-15T02:27:27+0000",
      "dateStarted": "2021-04-15T03:29:44+0000",
      "dateFinished": "2021-04-15T03:29:50+0000",
      "status": "FINISHED",
      "$$hashKey": "object:80125"
    },
    {
      "text": "//dropping all rows with missing genre\nval movies1 = movies.na.drop()",
      "user": "anonymous",
      "dateUpdated": "2021-04-15T03:29:50+0000",
      "config": {
        "editorSetting": {
          "language": "scala",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "colWidth": 12,
        "editorMode": "ace/mode/scala",
        "fontSize": 9,
        "results": {},
        "enabled": true
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "TEXT",
            "data": "\u001b[1m\u001b[34mmovies1\u001b[0m: \u001b[1m\u001b[32morg.apache.spark.sql.DataFrame\u001b[0m = [movieid: string, title: string ... 1 more field]\n"
          }
        ]
      },
      "apps": [],
      "runtimeInfos": {},
      "progressUpdateIntervalMs": 500,
      "jobName": "paragraph_1618453647617_1249866030",
      "id": "paragraph_1618189594922_954579719",
      "dateCreated": "2021-04-15T02:27:27+0000",
      "dateStarted": "2021-04-15T03:29:50+0000",
      "dateFinished": "2021-04-15T03:29:50+0000",
      "status": "FINISHED",
      "$$hashKey": "object:80126"
    },
    {
      "text": "// checking for total number of missing values for each column\r\nmovies1.select(movies1.columns.map(c => sum(col(c).isNull.cast(\"int\")).alias(c)): _*).show\r\n// all na rows dropped",
      "user": "anonymous",
      "dateUpdated": "2021-04-15T03:29:50+0000",
      "config": {
        "editorSetting": {
          "language": "scala",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "colWidth": 12,
        "editorMode": "ace/mode/scala",
        "fontSize": 9,
        "results": {},
        "enabled": true
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "TEXT",
            "data": "+-------+-----+-----+\n|movieid|title|genre|\n+-------+-----+-----+\n|      0|    0|    0|\n+-------+-----+-----+\n\n"
          }
        ]
      },
      "apps": [],
      "runtimeInfos": {
        "jobUrl": {
          "propertyName": "jobUrl",
          "label": "SPARK JOB",
          "tooltip": "View in Spark web UI",
          "group": "spark",
          "values": [
            {
              "jobUrl": "http://e67d52a5ef45:4040/jobs/job?id=1141",
              "$$hashKey": "object:90040"
            }
          ],
          "interpreterSettingId": "spark"
        }
      },
      "progressUpdateIntervalMs": 500,
      "jobName": "paragraph_1618453647617_778824715",
      "id": "paragraph_1618189691090_968252232",
      "dateCreated": "2021-04-15T02:27:27+0000",
      "dateStarted": "2021-04-15T03:29:50+0000",
      "dateFinished": "2021-04-15T03:29:54+0000",
      "status": "FINISHED",
      "$$hashKey": "object:80127"
    },
    {
      "text": "//checking numper of rows n movies1\nmovies1.count",
      "user": "anonymous",
      "dateUpdated": "2021-04-15T03:29:54+0000",
      "config": {
        "editorSetting": {
          "language": "scala",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "colWidth": 12,
        "editorMode": "ace/mode/scala",
        "fontSize": 9,
        "results": {},
        "enabled": true
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "TEXT",
            "data": "\u001b[1m\u001b[34mres309\u001b[0m: \u001b[1m\u001b[32mLong\u001b[0m = 2890\n"
          }
        ]
      },
      "apps": [],
      "runtimeInfos": {
        "jobUrl": {
          "propertyName": "jobUrl",
          "label": "SPARK JOB",
          "tooltip": "View in Spark web UI",
          "group": "spark",
          "values": [
            {
              "jobUrl": "http://e67d52a5ef45:4040/jobs/job?id=1142",
              "$$hashKey": "object:90106"
            }
          ],
          "interpreterSettingId": "spark"
        }
      },
      "progressUpdateIntervalMs": 500,
      "jobName": "paragraph_1618453647618_2128279359",
      "id": "paragraph_1618189780742_1670588252",
      "dateCreated": "2021-04-15T02:27:27+0000",
      "dateStarted": "2021-04-15T03:29:54+0000",
      "dateFinished": "2021-04-15T03:29:57+0000",
      "status": "FINISHED",
      "$$hashKey": "object:80128"
    },
    {
      "text": "// adding index columns for clustering and creating pipeline the index columns are numerical instead being strings\nval mindexers1M = for {column <- List(\"movieid\", \"title\", \"genre\")} yield new StringIndexer().setInputCol(column).setOutputCol(column+\"_index\")\nval pipeline = new Pipeline().setStages(mindexers1M.toArray)",
      "user": "anonymous",
      "dateUpdated": "2021-04-15T03:29:57+0000",
      "config": {
        "editorSetting": {
          "language": "scala",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "colWidth": 12,
        "editorMode": "ace/mode/scala",
        "fontSize": 9,
        "results": {},
        "enabled": true
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "TEXT",
            "data": "\u001b[1m\u001b[34mmindexers1M\u001b[0m: \u001b[1m\u001b[32mList[org.apache.spark.ml.feature.StringIndexer]\u001b[0m = List(strIdx_8382de8cd7a8, strIdx_04f2ada25c7a, strIdx_6c4b0b35dd35)\n\u001b[1m\u001b[34mpipeline\u001b[0m: \u001b[1m\u001b[32morg.apache.spark.ml.Pipeline\u001b[0m = pipeline_a4e54640d8bb\n"
          }
        ]
      },
      "apps": [],
      "runtimeInfos": {},
      "progressUpdateIntervalMs": 500,
      "jobName": "paragraph_1618453647618_782253782",
      "id": "paragraph_1618189830419_268440994",
      "dateCreated": "2021-04-15T02:27:27+0000",
      "dateStarted": "2021-04-15T03:29:57+0000",
      "dateFinished": "2021-04-15T03:29:58+0000",
      "status": "FINISHED",
      "$$hashKey": "object:80129"
    },
    {
      "text": "//fitting dataframe to pipeline\nval movies = pipeline.fit(movies1).transform(movies1)\nmovies.show()",
      "user": "anonymous",
      "dateUpdated": "2021-04-15T03:29:58+0000",
      "config": {
        "editorSetting": {
          "language": "scala",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "colWidth": 12,
        "editorMode": "ace/mode/scala",
        "fontSize": 9,
        "results": {},
        "enabled": true
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "TEXT",
            "data": "+-------+--------------------+--------------------+-------------+-----------+-----------+\n|movieid|               title|               genre|movieid_index|title_index|genre_index|\n+-------+--------------------+--------------------+-------------+-----------+-----------+\n|   1230|   Annie Hall (1977)|      Comedy|Romance|       2009.0|     1715.0|        4.0|\n|    705|         Cosi (1996)|              Comedy|       2300.0|      431.0|        1.0|\n|   2336|    Elizabeth (1998)|               Drama|        628.0|      742.0|        0.0|\n|     71|    Fair Game (1995)|              Action|       1345.0|     2219.0|        8.0|\n|   2899|Gulliver's Travel...|Adventure|Animati...|        759.0|     1470.0|      117.0|\n|    247|Heavenly Creature...|Drama|Fantasy|Rom...|       2331.0|     1949.0|      203.0|\n|    118| If Lucy Fell (1996)|      Comedy|Romance|       2235.0|      416.0|        4.0|\n|   1950|In the Heat of th...|       Drama|Mystery|         84.0|     2877.0|       40.0|\n|    968|Night of the Livi...|       Horror|Sci-Fi|       1545.0|       56.0|       23.0|\n|   2798|Problem Child (1990)|              Comedy|       1157.0|     2115.0|        1.0|\n|   1219|       Psycho (1960)|     Horror|Thriller|        440.0|      979.0|       19.0|\n|   2238|Seven Beauties (P...|        Comedy|Drama|        504.0|      433.0|        2.0|\n|    594|Snow White and th...|Animation|Childre...|       2285.0|     2005.0|       29.0|\n|    201| Three Wishes (1995)|               Drama|        583.0|      347.0|        0.0|\n|   1147|When We Were King...|         Documentary|        275.0|      395.0|        6.0|\n|   2035|Blackbeard's Ghos...|   Children's|Comedy|       2181.0|     2381.0|       12.0|\n|   3373|Buck and the Prea...|             Western|       1059.0|     1266.0|       18.0|\n|   2677|Buena Vista Socia...|         Documentary|       2850.0|     1629.0|        6.0|\n|   2616|   Dick Tracy (1990)|        Action|Crime|       2803.0|     2082.0|       33.0|\n|   3115|     Flawless (1999)|               Drama|        437.0|     1641.0|        0.0|\n+-------+--------------------+--------------------+-------------+-----------+-----------+\nonly showing top 20 rows\n\n\u001b[1m\u001b[34mmovies\u001b[0m: \u001b[1m\u001b[32morg.apache.spark.sql.DataFrame\u001b[0m = [movieid: string, title: string ... 4 more fields]\n"
          }
        ]
      },
      "apps": [],
      "runtimeInfos": {
        "jobUrl": {
          "propertyName": "jobUrl",
          "label": "SPARK JOB",
          "tooltip": "View in Spark web UI",
          "group": "spark",
          "values": [
            {
              "jobUrl": "http://e67d52a5ef45:4040/jobs/job?id=1143",
              "$$hashKey": "object:90232"
            },
            {
              "jobUrl": "http://e67d52a5ef45:4040/jobs/job?id=1144",
              "$$hashKey": "object:90233"
            },
            {
              "jobUrl": "http://e67d52a5ef45:4040/jobs/job?id=1145",
              "$$hashKey": "object:90234"
            },
            {
              "jobUrl": "http://e67d52a5ef45:4040/jobs/job?id=1146",
              "$$hashKey": "object:90235"
            },
            {
              "jobUrl": "http://e67d52a5ef45:4040/jobs/job?id=1147",
              "$$hashKey": "object:90236"
            }
          ],
          "interpreterSettingId": "spark"
        }
      },
      "progressUpdateIntervalMs": 500,
      "jobName": "paragraph_1618453647618_332451173",
      "id": "paragraph_1618189900049_205994084",
      "dateCreated": "2021-04-15T02:27:27+0000",
      "dateStarted": "2021-04-15T03:29:58+0000",
      "dateFinished": "2021-04-15T03:30:13+0000",
      "status": "FINISHED",
      "$$hashKey": "object:80130"
    },
    {
      "text": "//removing columns irrelevant for cluster\nval m_features = movies.drop(\"movieid\", \"movieid_index\", \"title\", \"genre\")\nm_features.columns",
      "user": "anonymous",
      "dateUpdated": "2021-04-15T03:30:13+0000",
      "config": {
        "editorSetting": {
          "language": "scala",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "colWidth": 12,
        "editorMode": "ace/mode/scala",
        "fontSize": 9,
        "results": {},
        "enabled": true
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "TEXT",
            "data": "\u001b[1m\u001b[34mm_features\u001b[0m: \u001b[1m\u001b[32morg.apache.spark.sql.DataFrame\u001b[0m = [title_index: double, genre_index: double]\n\u001b[1m\u001b[34mres311\u001b[0m: \u001b[1m\u001b[32mArray[String]\u001b[0m = Array(title_index, genre_index)\n"
          }
        ]
      },
      "apps": [],
      "runtimeInfos": {},
      "progressUpdateIntervalMs": 500,
      "jobName": "paragraph_1618453647618_1612714333",
      "id": "paragraph_1618190055439_1955480639",
      "dateCreated": "2021-04-15T02:27:27+0000",
      "dateStarted": "2021-04-15T03:30:13+0000",
      "dateFinished": "2021-04-15T03:30:13+0000",
      "status": "FINISHED",
      "$$hashKey": "object:80131"
    },
    {
      "text": "// create reference for columns that will used for clustering in this case that is the movieid by dropping irrelevant columns\nval minfo = movies.drop(\"movieid_index\", \"title\", \"genre\")\nminfo.columns",
      "user": "anonymous",
      "dateUpdated": "2021-04-15T03:30:14+0000",
      "config": {
        "editorSetting": {
          "language": "scala",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "colWidth": 12,
        "editorMode": "ace/mode/scala",
        "fontSize": 9,
        "results": {},
        "enabled": true
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "TEXT",
            "data": "\u001b[1m\u001b[34mminfo\u001b[0m: \u001b[1m\u001b[32morg.apache.spark.sql.DataFrame\u001b[0m = [movieid: string, title_index: double ... 1 more field]\n\u001b[1m\u001b[34mres312\u001b[0m: \u001b[1m\u001b[32mArray[String]\u001b[0m = Array(movieid, title_index, genre_index)\n"
          }
        ]
      },
      "apps": [],
      "runtimeInfos": {},
      "progressUpdateIntervalMs": 500,
      "jobName": "paragraph_1618453647618_1495799034",
      "id": "paragraph_1618190191843_1428275295",
      "dateCreated": "2021-04-15T02:27:27+0000",
      "dateStarted": "2021-04-15T03:30:14+0000",
      "dateFinished": "2021-04-15T03:30:14+0000",
      "status": "FINISHED",
      "$$hashKey": "object:80132"
    },
    {
      "text": "// assigning all row values to one column and maintaining movieid as a reference column\nval assembler = new VectorAssembler().setInputCols(m_features.columns).setOutputCol(\"features\")\nval movies_output = assembler.transform(minfo).select(\"movieid\", \"features\")\nmovies_output.show(10 , false)",
      "user": "anonymous",
      "dateUpdated": "2021-04-15T03:30:14+0000",
      "config": {
        "editorSetting": {
          "language": "scala",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "colWidth": 12,
        "editorMode": "ace/mode/scala",
        "fontSize": 9,
        "results": {},
        "enabled": true
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "TEXT",
            "data": "+-------+--------------+\n|movieid|features      |\n+-------+--------------+\n|1230   |[1715.0,4.0]  |\n|705    |[431.0,1.0]   |\n|2336   |[742.0,0.0]   |\n|71     |[2219.0,8.0]  |\n|2899   |[1470.0,117.0]|\n|247    |[1949.0,203.0]|\n|118    |[416.0,4.0]   |\n|1950   |[2877.0,40.0] |\n|968    |[56.0,23.0]   |\n|2798   |[2115.0,1.0]  |\n+-------+--------------+\nonly showing top 10 rows\n\n\u001b[1m\u001b[34massembler\u001b[0m: \u001b[1m\u001b[32morg.apache.spark.ml.feature.VectorAssembler\u001b[0m = vecAssembler_9430d5164a34\n\u001b[1m\u001b[34mmovies_output\u001b[0m: \u001b[1m\u001b[32morg.apache.spark.sql.DataFrame\u001b[0m = [movieid: string, features: vector]\n"
          }
        ]
      },
      "apps": [],
      "runtimeInfos": {
        "jobUrl": {
          "propertyName": "jobUrl",
          "label": "SPARK JOB",
          "tooltip": "View in Spark web UI",
          "group": "spark",
          "values": [
            {
              "jobUrl": "http://e67d52a5ef45:4040/jobs/job?id=1148",
              "$$hashKey": "object:90438"
            }
          ],
          "interpreterSettingId": "spark"
        }
      },
      "progressUpdateIntervalMs": 500,
      "jobName": "paragraph_1618453647618_1793539462",
      "id": "paragraph_1618190050476_1749745977",
      "dateCreated": "2021-04-15T02:27:27+0000",
      "dateStarted": "2021-04-15T03:30:14+0000",
      "dateFinished": "2021-04-15T03:30:17+0000",
      "status": "FINISHED",
      "$$hashKey": "object:80133"
    },
    {
      "text": "//split data set testing and training\r\nval Array(mtraining, mtesting) = movies_output.randomSplit(Array(0.7, 0.3), seed = 1234)",
      "user": "anonymous",
      "dateUpdated": "2021-04-15T03:30:17+0000",
      "config": {
        "editorSetting": {
          "language": "scala",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "colWidth": 12,
        "editorMode": "ace/mode/scala",
        "fontSize": 9,
        "results": {},
        "enabled": true
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "TEXT",
            "data": "\u001b[1m\u001b[34mmtraining\u001b[0m: \u001b[1m\u001b[32morg.apache.spark.sql.Dataset[org.apache.spark.sql.Row]\u001b[0m = [movieid: string, features: vector]\n\u001b[1m\u001b[34mmtesting\u001b[0m: \u001b[1m\u001b[32morg.apache.spark.sql.Dataset[org.apache.spark.sql.Row]\u001b[0m = [movieid: string, features: vector]\n"
          }
        ]
      },
      "apps": [],
      "runtimeInfos": {},
      "progressUpdateIntervalMs": 500,
      "jobName": "paragraph_1618453647619_1439906007",
      "id": "paragraph_1618190834507_711060291",
      "dateCreated": "2021-04-15T02:27:27+0000",
      "dateStarted": "2021-04-15T03:30:17+0000",
      "dateFinished": "2021-04-15T03:30:18+0000",
      "status": "FINISHED",
      "$$hashKey": "object:80134"
    },
    {
      "text": "// using kmeans to model with 13 clusters and fit to training\r\nval model1 = new KMeans()\r\n    .setK(13)\r\n    .setFeaturesCol(\"features\")\r\n    .setPredictionCol(\"prediction\")\r\n    .fit(mtraining)",
      "user": "anonymous",
      "dateUpdated": "2021-04-15T03:30:18+0000",
      "config": {
        "editorSetting": {
          "language": "scala",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "colWidth": 12,
        "editorMode": "ace/mode/scala",
        "fontSize": 9,
        "results": {},
        "enabled": true
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "apps": [],
      "runtimeInfos": {
        "jobUrl": {
          "propertyName": "jobUrl",
          "label": "SPARK JOB",
          "tooltip": "View in Spark web UI",
          "group": "spark",
          "values": [
            {
              "jobUrl": "http://e67d52a5ef45:4040/jobs/job?id=1149",
              "$$hashKey": "object:94002"
            },
            {
              "jobUrl": "http://e67d52a5ef45:4040/jobs/job?id=1150",
              "$$hashKey": "object:94003"
            },
            {
              "jobUrl": "http://e67d52a5ef45:4040/jobs/job?id=1151",
              "$$hashKey": "object:94004"
            },
            {
              "jobUrl": "http://e67d52a5ef45:4040/jobs/job?id=1152",
              "$$hashKey": "object:94005"
            },
            {
              "jobUrl": "http://e67d52a5ef45:4040/jobs/job?id=1153",
              "$$hashKey": "object:94006"
            },
            {
              "jobUrl": "http://e67d52a5ef45:4040/jobs/job?id=1154",
              "$$hashKey": "object:94007"
            },
            {
              "jobUrl": "http://e67d52a5ef45:4040/jobs/job?id=1155",
              "$$hashKey": "object:94008"
            },
            {
              "jobUrl": "http://e67d52a5ef45:4040/jobs/job?id=1156",
              "$$hashKey": "object:94009"
            },
            {
              "jobUrl": "http://e67d52a5ef45:4040/jobs/job?id=1157",
              "$$hashKey": "object:94010"
            },
            {
              "jobUrl": "http://e67d52a5ef45:4040/jobs/job?id=1158",
              "$$hashKey": "object:94011"
            },
            {
              "jobUrl": "http://e67d52a5ef45:4040/jobs/job?id=1159",
              "$$hashKey": "object:94012"
            },
            {
              "jobUrl": "http://e67d52a5ef45:4040/jobs/job?id=1160",
              "$$hashKey": "object:94013"
            },
            {
              "jobUrl": "http://e67d52a5ef45:4040/jobs/job?id=1161",
              "$$hashKey": "object:94014"
            },
            {
              "jobUrl": "http://e67d52a5ef45:4040/jobs/job?id=1162",
              "$$hashKey": "object:94015"
            },
            {
              "jobUrl": "http://e67d52a5ef45:4040/jobs/job?id=1163",
              "$$hashKey": "object:94016"
            },
            {
              "jobUrl": "http://e67d52a5ef45:4040/jobs/job?id=1164",
              "$$hashKey": "object:94017"
            },
            {
              "jobUrl": "http://e67d52a5ef45:4040/jobs/job?id=1165",
              "$$hashKey": "object:94018"
            },
            {
              "jobUrl": "http://e67d52a5ef45:4040/jobs/job?id=1166",
              "$$hashKey": "object:94019"
            },
            {
              "jobUrl": "http://e67d52a5ef45:4040/jobs/job?id=1167",
              "$$hashKey": "object:94020"
            },
            {
              "jobUrl": "http://e67d52a5ef45:4040/jobs/job?id=1168",
              "$$hashKey": "object:94021"
            },
            {
              "jobUrl": "http://e67d52a5ef45:4040/jobs/job?id=1169",
              "$$hashKey": "object:94022"
            },
            {
              "jobUrl": "http://e67d52a5ef45:4040/jobs/job?id=1170",
              "$$hashKey": "object:94023"
            },
            {
              "jobUrl": "http://e67d52a5ef45:4040/jobs/job?id=1171",
              "$$hashKey": "object:94024"
            },
            {
              "jobUrl": "http://e67d52a5ef45:4040/jobs/job?id=1172",
              "$$hashKey": "object:94025"
            },
            {
              "jobUrl": "http://e67d52a5ef45:4040/jobs/job?id=1173",
              "$$hashKey": "object:94026"
            },
            {
              "jobUrl": "http://e67d52a5ef45:4040/jobs/job?id=1174",
              "$$hashKey": "object:94027"
            },
            {
              "jobUrl": "http://e67d52a5ef45:4040/jobs/job?id=1175",
              "$$hashKey": "object:94028"
            },
            {
              "jobUrl": "http://e67d52a5ef45:4040/jobs/job?id=1176",
              "$$hashKey": "object:94029"
            }
          ],
          "interpreterSettingId": "spark"
        }
      },
      "progressUpdateIntervalMs": 500,
      "jobName": "paragraph_1618453647619_1072146667",
      "id": "paragraph_1618190046323_1571550492",
      "dateCreated": "2021-04-15T02:27:27+0000",
      "dateStarted": "2021-04-15T03:30:18+0000",
      "dateFinished": "2021-04-15T03:30:43+0000",
      "status": "FINISHED",
      "$$hashKey": "object:80135",
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "TEXT",
            "data": "\u001b[1m\u001b[34mmodel1\u001b[0m: \u001b[1m\u001b[32morg.apache.spark.ml.clustering.KMeansModel\u001b[0m = kmeans_fba73ee952e1\n"
          }
        ]
      }
    },
    {
      "text": "// test model with testing set\r\n   val movie_predict1 = model1.transform(mtesting)\r\n   val movie_predtrain = model1.transform(mtraining)\r\n   println(\"View predictions on test set\")\r\n   movie_predict1.show(20, false)",
      "user": "anonymous",
      "dateUpdated": "2021-04-15T03:30:43+0000",
      "config": {
        "editorSetting": {
          "language": "scala",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "colWidth": 12,
        "editorMode": "ace/mode/scala",
        "fontSize": 9,
        "results": {},
        "enabled": true
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "TEXT",
            "data": "View predictions on test set\n+-------+--------------+----------+\n|movieid|features      |prediction|\n+-------+--------------+----------+\n|1147   |[395.0,6.0]   |12        |\n|118    |[416.0,4.0]   |4         |\n|1219   |[979.0,19.0]  |1         |\n|71     |[2219.0,8.0]  |5         |\n|1577   |[1174.0,0.0]  |9         |\n|2597   |[1444.0,4.0]  |7         |\n|2616   |[2082.0,33.0] |0         |\n|3489   |[2117.0,202.0]|5         |\n|574    |[2537.0,2.0]  |2         |\n|372    |[2594.0,2.0]  |2         |\n|550    |[597.0,4.0]   |4         |\n|1498   |[1491.0,5.0]  |7         |\n|1819   |[1005.0,0.0]  |1         |\n|2794   |[64.0,1.0]    |3         |\n|2996   |[113.0,0.0]   |3         |\n|3431   |[9.0,14.0]    |3         |\n|857    |[2127.0,0.0]  |5         |\n|1367   |[1811.0,12.0] |11        |\n|3110   |[255.0,0.0]   |12        |\n|3593   |[1856.0,17.0] |0         |\n+-------+--------------+----------+\nonly showing top 20 rows\n\n\u001b[1m\u001b[34mmovie_predict1\u001b[0m: \u001b[1m\u001b[32morg.apache.spark.sql.DataFrame\u001b[0m = [movieid: string, features: vector ... 1 more field]\n\u001b[1m\u001b[34mmovie_predtrain\u001b[0m: \u001b[1m\u001b[32morg.apache.spark.sql.DataFrame\u001b[0m = [movieid: string, features: vector ... 1 more field]\n"
          }
        ]
      },
      "apps": [],
      "runtimeInfos": {
        "jobUrl": {
          "propertyName": "jobUrl",
          "label": "SPARK JOB",
          "tooltip": "View in Spark web UI",
          "group": "spark",
          "values": [
            {
              "jobUrl": "http://e67d52a5ef45:4040/jobs/job?id=1177",
              "$$hashKey": "object:94206"
            },
            {
              "jobUrl": "http://e67d52a5ef45:4040/jobs/job?id=1178",
              "$$hashKey": "object:94207"
            }
          ],
          "interpreterSettingId": "spark"
        }
      },
      "progressUpdateIntervalMs": 500,
      "jobName": "paragraph_1618453647619_781874753",
      "id": "paragraph_1618190041594_299633334",
      "dateCreated": "2021-04-15T02:27:27+0000",
      "dateStarted": "2021-04-15T03:30:44+0000",
      "dateFinished": "2021-04-15T03:30:48+0000",
      "status": "FINISHED",
      "$$hashKey": "object:80136"
    },
    {
      "text": "//Combining test prediction to training prediction\nval movie_predict = movie_predict1.union(movie_predtrain) ",
      "user": "anonymous",
      "dateUpdated": "2021-04-15T03:30:48+0000",
      "config": {
        "colWidth": 12,
        "fontSize": 9,
        "enabled": true,
        "results": {},
        "editorSetting": {
          "language": "scala",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "editorMode": "ace/mode/scala"
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "apps": [],
      "runtimeInfos": {},
      "progressUpdateIntervalMs": 500,
      "jobName": "paragraph_1618456976937_1110048120",
      "id": "paragraph_1618456976937_1110048120",
      "dateCreated": "2021-04-15T03:22:56+0000",
      "status": "FINISHED",
      "$$hashKey": "object:80137",
      "dateFinished": "2021-04-15T03:30:49+0000",
      "dateStarted": "2021-04-15T03:30:48+0000",
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "TEXT",
            "data": "\u001b[1m\u001b[34mmovie_predict\u001b[0m: \u001b[1m\u001b[32morg.apache.spark.sql.Dataset[org.apache.spark.sql.Row]\u001b[0m = [movieid: string, features: vector ... 1 more field]\n"
          }
        ]
      }
    },
    {
      "text": "//renaming columns relevant to movies dataset\nval movieprd = movie_predict.withColumnRenamed(\"movieid\", \"movie_id\").withColumnRenamed(\"features\", \"mfeatures\").withColumnRenamed(\"prediction\", \"mprediction\")\nmovieprd.show(5)",
      "user": "anonymous",
      "dateUpdated": "2021-04-15T03:30:49+0000",
      "config": {
        "editorSetting": {
          "language": "scala",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "colWidth": 12,
        "editorMode": "ace/mode/scala",
        "fontSize": 9,
        "results": {},
        "enabled": true
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "TEXT",
            "data": "+--------+------------+-----------+\n|movie_id|   mfeatures|mprediction|\n+--------+------------+-----------+\n|    1147| [395.0,6.0]|         12|\n|     118| [416.0,4.0]|          4|\n|    1219|[979.0,19.0]|          1|\n|      71|[2219.0,8.0]|          5|\n|    1577|[1174.0,0.0]|          9|\n+--------+------------+-----------+\nonly showing top 5 rows\n\n\u001b[1m\u001b[34mmovieprd\u001b[0m: \u001b[1m\u001b[32morg.apache.spark.sql.DataFrame\u001b[0m = [movie_id: string, mfeatures: vector ... 1 more field]\n"
          }
        ]
      },
      "apps": [],
      "runtimeInfos": {
        "jobUrl": {
          "propertyName": "jobUrl",
          "label": "SPARK JOB",
          "tooltip": "View in Spark web UI",
          "group": "spark",
          "values": [
            {
              "jobUrl": "http://e67d52a5ef45:4040/jobs/job?id=1179",
              "$$hashKey": "object:94303"
            },
            {
              "jobUrl": "http://e67d52a5ef45:4040/jobs/job?id=1180",
              "$$hashKey": "object:94304"
            }
          ],
          "interpreterSettingId": "spark"
        }
      },
      "progressUpdateIntervalMs": 500,
      "jobName": "paragraph_1618453647619_1660596376",
      "id": "paragraph_1618190735547_2127474944",
      "dateCreated": "2021-04-15T02:27:27+0000",
      "dateStarted": "2021-04-15T03:30:49+0000",
      "dateFinished": "2021-04-15T03:30:54+0000",
      "status": "FINISHED",
      "$$hashKey": "object:80138"
    },
    {
      "text": "val evaluator = new ClusteringEvaluator()\n//A score of 0.6 since it is closer to 1, suggest that the clusters are fairly well apart from each other\nval silhouette = evaluator.evaluate(movie_predict1)\nprintln(s\"Silhouette with squared euclidean distance = $silhouette\")",
      "user": "anonymous",
      "dateUpdated": "2021-04-15T03:30:54+0000",
      "config": {
        "editorSetting": {
          "language": "scala",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "colWidth": 12,
        "editorMode": "ace/mode/scala",
        "fontSize": 9,
        "results": {},
        "enabled": true
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "TEXT",
            "data": "Silhouette with squared euclidean distance = 0.6319456327728225\n\u001b[1m\u001b[34mevaluator\u001b[0m: \u001b[1m\u001b[32morg.apache.spark.ml.evaluation.ClusteringEvaluator\u001b[0m = cluEval_7bc644b6cf41\n\u001b[1m\u001b[34msilhouette\u001b[0m: \u001b[1m\u001b[32mDouble\u001b[0m = 0.6319456327728225\n"
          }
        ]
      },
      "apps": [],
      "runtimeInfos": {
        "jobUrl": {
          "propertyName": "jobUrl",
          "label": "SPARK JOB",
          "tooltip": "View in Spark web UI",
          "group": "spark",
          "values": [
            {
              "jobUrl": "http://e67d52a5ef45:4040/jobs/job?id=1181",
              "$$hashKey": "object:94379"
            },
            {
              "jobUrl": "http://e67d52a5ef45:4040/jobs/job?id=1182",
              "$$hashKey": "object:94380"
            }
          ],
          "interpreterSettingId": "spark"
        }
      },
      "progressUpdateIntervalMs": 500,
      "jobName": "paragraph_1618453647620_1734797038",
      "id": "paragraph_1618190959713_865495099",
      "dateCreated": "2021-04-15T02:27:27+0000",
      "dateStarted": "2021-04-15T03:30:54+0000",
      "dateFinished": "2021-04-15T03:31:05+0000",
      "status": "FINISHED",
      "$$hashKey": "object:80139"
    },
    {
      "title": "Upload User data",
      "text": "%sh wget https://raw.githubusercontent.com/jcsamuels/UWI-BigData-project1/ML-1M/users.dat\n\n",
      "user": "anonymous",
      "dateUpdated": "2021-04-15T03:31:05+0000",
      "config": {
        "editorSetting": {
          "language": "sh",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": false
        },
        "colWidth": 12,
        "editorMode": "ace/mode/sh",
        "fontSize": 9,
        "title": true,
        "results": {},
        "enabled": true
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "TEXT",
            "data": "--2021-04-15 03:31:05--  https://raw.githubusercontent.com/jcsamuels/UWI-BigData-project1/ML-1M/users.dat\nResolving raw.githubusercontent.com (raw.githubusercontent.com)... 185.199.109.133, 185.199.108.133, 185.199.110.133, ...\nConnecting to raw.githubusercontent.com (raw.githubusercontent.com)|185.199.109.133|:443... connected.\nHTTP request sent, awaiting response... 200 OK\nLength: 134368 (131K) [text/plain]\nSaving to: ‘users.dat.3’\n\n     0K .......... .......... .......... .......... .......... 38%  554K 0s\n    50K .......... .......... .......... .......... .......... 76% 1.93M 0s\n   100K .......... .......... .......... .                    100%  604K=0.2s\n\n2021-04-15 03:31:06 (785 KB/s) - ‘users.dat.3’ saved [134368/134368]\n\n"
          }
        ]
      },
      "apps": [],
      "runtimeInfos": {},
      "progressUpdateIntervalMs": 500,
      "jobName": "paragraph_1618453647620_1115930994",
      "id": "paragraph_1618169871410_933590645",
      "dateCreated": "2021-04-15T02:27:27+0000",
      "dateStarted": "2021-04-15T03:31:05+0000",
      "dateFinished": "2021-04-15T03:31:06+0000",
      "status": "FINISHED",
      "$$hashKey": "object:80140"
    },
    {
      "text": "//split data column _co into constiuent columns\nval users1M = sqlContext.read.format(\"com.databricks.spark.csv\").option(\"sep\", \",\").option(\"header\", false).option(\"inferSchema\", true).load(\"users.dat\")\nval users = users1M.select(split(col(\"_c0\"),\"::\").getItem(0).as(\"userid\"),split(col(\"_c0\"),\"::\").getItem(1).as(\"gender\"),split(col(\"_c0\"),\"::\").getItem(2).as(\"age\"),split(col(\"_c0\"),\"::\").getItem(3).as(\"occupation\"),split(col(\"_c0\"),\"::\").getItem(4).as(\"zipcode\")).drop(\"_c0\")\nusers.show(5, false)",
      "user": "anonymous",
      "dateUpdated": "2021-04-15T03:31:07+0000",
      "config": {
        "editorSetting": {
          "language": "sh",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": false
        },
        "colWidth": 12,
        "editorMode": "ace/mode/sh",
        "fontSize": 9,
        "results": {},
        "enabled": true
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "TEXT",
            "data": "+------+------+---+----------+-------+\n|userid|gender|age|occupation|zipcode|\n+------+------+---+----------+-------+\n|1     |F     |1  |10        |48067  |\n|2     |M     |56 |16        |70072  |\n|3     |M     |25 |15        |55117  |\n|4     |M     |45 |7         |02460  |\n|5     |M     |25 |20        |55455  |\n+------+------+---+----------+-------+\nonly showing top 5 rows\n\n\u001b[1m\u001b[34musers1M\u001b[0m: \u001b[1m\u001b[32morg.apache.spark.sql.DataFrame\u001b[0m = [_c0: string]\n\u001b[1m\u001b[34musers\u001b[0m: \u001b[1m\u001b[32morg.apache.spark.sql.DataFrame\u001b[0m = [userid: string, gender: string ... 3 more fields]\n"
          }
        ]
      },
      "apps": [],
      "runtimeInfos": {
        "jobUrl": {
          "propertyName": "jobUrl",
          "label": "SPARK JOB",
          "tooltip": "View in Spark web UI",
          "group": "spark",
          "values": [
            {
              "jobUrl": "http://e67d52a5ef45:4040/jobs/job?id=1183",
              "$$hashKey": "object:94463"
            },
            {
              "jobUrl": "http://e67d52a5ef45:4040/jobs/job?id=1184",
              "$$hashKey": "object:94464"
            },
            {
              "jobUrl": "http://e67d52a5ef45:4040/jobs/job?id=1185",
              "$$hashKey": "object:94465"
            }
          ],
          "interpreterSettingId": "spark"
        }
      },
      "progressUpdateIntervalMs": 500,
      "jobName": "paragraph_1618453647620_937069282",
      "id": "paragraph_1618191111282_1857587175",
      "dateCreated": "2021-04-15T02:27:27+0000",
      "dateStarted": "2021-04-15T03:31:07+0000",
      "dateFinished": "2021-04-15T03:31:07+0000",
      "status": "FINISHED",
      "$$hashKey": "object:80141"
    },
    {
      "text": "// checking for total number of missing values for each column\r\nusers.select(users.columns.map(c => sum(col(c).isNull.cast(\"int\")).alias(c)): _*).show\r\n// No missing values identified",
      "user": "anonymous",
      "dateUpdated": "2021-04-15T03:31:08+0000",
      "config": {
        "editorSetting": {
          "language": "scala",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "colWidth": 12,
        "editorMode": "ace/mode/scala",
        "fontSize": 9,
        "results": {},
        "enabled": true
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "TEXT",
            "data": "+------+------+---+----------+-------+\n|userid|gender|age|occupation|zipcode|\n+------+------+---+----------+-------+\n|     0|     0|  0|         0|      0|\n+------+------+---+----------+-------+\n\n"
          }
        ]
      },
      "apps": [],
      "runtimeInfos": {
        "jobUrl": {
          "propertyName": "jobUrl",
          "label": "SPARK JOB",
          "tooltip": "View in Spark web UI",
          "group": "spark",
          "values": [
            {
              "jobUrl": "http://e67d52a5ef45:4040/jobs/job?id=1186",
              "$$hashKey": "object:94494"
            }
          ],
          "interpreterSettingId": "spark"
        }
      },
      "progressUpdateIntervalMs": 500,
      "jobName": "paragraph_1618453647620_1638124945",
      "id": "paragraph_1618191882023_1508576826",
      "dateCreated": "2021-04-15T02:27:27+0000",
      "dateStarted": "2021-04-15T03:31:08+0000",
      "dateFinished": "2021-04-15T03:31:09+0000",
      "status": "FINISHED",
      "$$hashKey": "object:80142"
    },
    {
      "text": "//creating indexer columns for modeling and assigning to a pipeline\nval indexers = for {column <- List(\"userid\", \"age\", \"gender\", \"occupation\", \"zipcode\")} yield new StringIndexer().setInputCol(column).setOutputCol(column+\"_index\")\nval pipeline = new Pipeline().setStages(indexers.toArray)",
      "user": "anonymous",
      "dateUpdated": "2021-04-15T03:31:09+0000",
      "config": {
        "editorSetting": {
          "language": "scala",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "colWidth": 12,
        "editorMode": "ace/mode/scala",
        "fontSize": 9,
        "results": {},
        "enabled": true
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "TEXT",
            "data": "\u001b[1m\u001b[34mindexers\u001b[0m: \u001b[1m\u001b[32mList[org.apache.spark.ml.feature.StringIndexer]\u001b[0m = List(strIdx_1acec26d19fd, strIdx_36fd98d55bb4, strIdx_130a829888e6, strIdx_abbf771e9c47, strIdx_3f3d634baa2e)\n\u001b[1m\u001b[34mpipeline\u001b[0m: \u001b[1m\u001b[32morg.apache.spark.ml.Pipeline\u001b[0m = pipeline_b8d17bb24569\n"
          }
        ]
      },
      "apps": [],
      "runtimeInfos": {},
      "progressUpdateIntervalMs": 500,
      "jobName": "paragraph_1618453647620_966581724",
      "id": "paragraph_1618191907711_72885340",
      "dateCreated": "2021-04-15T02:27:27+0000",
      "dateStarted": "2021-04-15T03:31:09+0000",
      "dateFinished": "2021-04-15T03:31:10+0000",
      "status": "FINISHED",
      "$$hashKey": "object:80143"
    },
    {
      "text": "//fit indexer columns to dataset\nval users1 = pipeline.fit(users).transform(users)\nusers1.show()",
      "user": "anonymous",
      "dateUpdated": "2021-04-15T03:31:10+0000",
      "config": {
        "editorSetting": {
          "language": "scala",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "colWidth": 12,
        "editorMode": "ace/mode/scala",
        "fontSize": 9,
        "results": {},
        "enabled": true
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "TEXT",
            "data": "+------+------+---+----------+-------+------------+---------+------------+----------------+-------------+\n|userid|gender|age|occupation|zipcode|userid_index|age_index|gender_index|occupation_index|zipcode_index|\n+------+------+---+----------+-------+------------+---------+------------+----------------+-------------+\n|     1|     F|  1|        10|  48067|      3324.0|      6.0|         1.0|            11.0|        111.0|\n|     2|     M| 56|        16|  70072|      4353.0|      5.0|         0.0|             9.0|       3118.0|\n|     3|     M| 25|        15|  55117|      5357.0|      0.0|         0.0|            13.0|         35.0|\n|     4|     M| 45|         7|  02460|       742.0|      3.0|         0.0|             2.0|        511.0|\n|     5|     M| 25|        20|  55455|      2210.0|      0.0|         0.0|             7.0|          5.0|\n|     6|     F| 50|         9|  55117|      3243.0|      4.0|         1.0|            17.0|         35.0|\n|     7|     M| 35|         1|  06810|      5018.0|      1.0|         0.0|             3.0|        352.0|\n|     8|     M| 25|        12|  11413|       403.0|      0.0|         0.0|             5.0|       2621.0|\n|     9|     M| 25|        17|  61614|      1104.0|      0.0|         0.0|             4.0|        650.0|\n|    10|     F| 35|         1|  95370|      2289.0|      1.0|         1.0|             3.0|        667.0|\n|    11|     F| 25|         1|  04093|      1066.0|      0.0|         1.0|             3.0|       1726.0|\n|    12|     M| 25|        12|  32793|       285.0|      0.0|         0.0|             5.0|       3263.0|\n|    13|     M| 45|         1|  93304|      1791.0|      3.0|         0.0|             3.0|       1172.0|\n|    14|     M| 35|         0|  60126|      3581.0|      1.0|         0.0|             1.0|        734.0|\n|    15|     M| 25|         7|  22903|      1043.0|      0.0|         0.0|             2.0|          1.0|\n|    16|     F| 35|         0|  20670|      2059.0|      1.0|         1.0|             1.0|       2193.0|\n|    17|     M| 50|         1|  95350|      3499.0|      4.0|         0.0|             3.0|       2150.0|\n|    18|     F| 18|         3|  95825|      4876.0|      2.0|         1.0|            12.0|        932.0|\n|    19|     M|  1|        10|  48073|       627.0|      6.0|         0.0|            11.0|         81.0|\n|    20|     M| 25|        14|  55113|      4182.0|      0.0|         0.0|             6.0|         20.0|\n+------+------+---+----------+-------+------------+---------+------------+----------------+-------------+\nonly showing top 20 rows\n\n\u001b[1m\u001b[34musers1\u001b[0m: \u001b[1m\u001b[32morg.apache.spark.sql.DataFrame\u001b[0m = [userid: string, gender: string ... 8 more fields]\n"
          }
        ]
      },
      "apps": [],
      "runtimeInfos": {
        "jobUrl": {
          "propertyName": "jobUrl",
          "label": "SPARK JOB",
          "tooltip": "View in Spark web UI",
          "group": "spark",
          "values": [
            {
              "jobUrl": "http://e67d52a5ef45:4040/jobs/job?id=1187",
              "$$hashKey": "object:94622"
            },
            {
              "jobUrl": "http://e67d52a5ef45:4040/jobs/job?id=1188",
              "$$hashKey": "object:94623"
            },
            {
              "jobUrl": "http://e67d52a5ef45:4040/jobs/job?id=1189",
              "$$hashKey": "object:94624"
            },
            {
              "jobUrl": "http://e67d52a5ef45:4040/jobs/job?id=1190",
              "$$hashKey": "object:94625"
            },
            {
              "jobUrl": "http://e67d52a5ef45:4040/jobs/job?id=1191",
              "$$hashKey": "object:94626"
            },
            {
              "jobUrl": "http://e67d52a5ef45:4040/jobs/job?id=1192",
              "$$hashKey": "object:94627"
            }
          ],
          "interpreterSettingId": "spark"
        }
      },
      "progressUpdateIntervalMs": 500,
      "jobName": "paragraph_1618453647620_1551589994",
      "id": "paragraph_1618191954540_1400654613",
      "dateCreated": "2021-04-15T02:27:27+0000",
      "dateStarted": "2021-04-15T03:31:10+0000",
      "dateFinished": "2021-04-15T03:31:13+0000",
      "status": "FINISHED",
      "$$hashKey": "object:80144"
    },
    {
      "text": "//combining test and training dataframe prediction\nval users = users1",
      "user": "anonymous",
      "dateUpdated": "2021-04-15T03:36:53+0000",
      "config": {
        "editorSetting": {
          "language": "scala",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "colWidth": 12,
        "editorMode": "ace/mode/scala",
        "fontSize": 9,
        "results": {},
        "enabled": true
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "TEXT",
            "data": "\u001b[1m\u001b[34musers\u001b[0m: \u001b[1m\u001b[32morg.apache.spark.sql.DataFrame\u001b[0m = [userid: string, gender: string ... 8 more fields]\n"
          }
        ]
      },
      "apps": [],
      "runtimeInfos": {},
      "progressUpdateIntervalMs": 500,
      "jobName": "paragraph_1618453647621_867208314",
      "id": "paragraph_1618192237152_163473688",
      "dateCreated": "2021-04-15T02:27:27+0000",
      "dateStarted": "2021-04-15T03:31:13+0000",
      "dateFinished": "2021-04-15T03:31:13+0000",
      "status": "FINISHED",
      "$$hashKey": "object:80145"
    },
    {
      "text": "//drop irrelevant columns for modeling\nval u_features = users1.drop(\"userid\", \"userid_index\", \"age\", \"gender\", \"occupation\", \"zipcode\")\nu_features.show(5)",
      "user": "anonymous",
      "dateUpdated": "2021-04-15T03:31:13+0000",
      "config": {
        "editorSetting": {
          "language": "scala",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "colWidth": 12,
        "editorMode": "ace/mode/scala",
        "fontSize": 9,
        "results": {},
        "enabled": true
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "TEXT",
            "data": "+---------+------------+----------------+-------------+\n|age_index|gender_index|occupation_index|zipcode_index|\n+---------+------------+----------------+-------------+\n|      6.0|         1.0|            11.0|        111.0|\n|      5.0|         0.0|             9.0|       3118.0|\n|      0.0|         0.0|            13.0|         35.0|\n|      3.0|         0.0|             2.0|        511.0|\n|      0.0|         0.0|             7.0|          5.0|\n+---------+------------+----------------+-------------+\nonly showing top 5 rows\n\n\u001b[1m\u001b[34mu_features\u001b[0m: \u001b[1m\u001b[32morg.apache.spark.sql.DataFrame\u001b[0m = [age_index: double, gender_index: double ... 2 more fields]\n"
          }
        ]
      },
      "apps": [],
      "runtimeInfos": {
        "jobUrl": {
          "propertyName": "jobUrl",
          "label": "SPARK JOB",
          "tooltip": "View in Spark web UI",
          "group": "spark",
          "values": [
            {
              "jobUrl": "http://e67d52a5ef45:4040/jobs/job?id=1193",
              "$$hashKey": "object:94675"
            }
          ],
          "interpreterSettingId": "spark"
        }
      },
      "progressUpdateIntervalMs": 500,
      "jobName": "paragraph_1618453647621_145858810",
      "id": "paragraph_1618193165429_1967928733",
      "dateCreated": "2021-04-15T02:27:27+0000",
      "dateStarted": "2021-04-15T03:31:13+0000",
      "dateFinished": "2021-04-15T03:31:14+0000",
      "status": "FINISHED",
      "$$hashKey": "object:80146"
    },
    {
      "text": "//maininting relevant columns and userid for referencing\nval uinfo = users1.drop(\"userid_index\", \"age\", \"gender\", \"occupation\", \"zipcode\")\nuinfo.show()",
      "user": "anonymous",
      "dateUpdated": "2021-04-15T03:31:14+0000",
      "config": {
        "editorSetting": {
          "language": "scala",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "colWidth": 12,
        "editorMode": "ace/mode/scala",
        "fontSize": 9,
        "results": {},
        "enabled": true
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "TEXT",
            "data": "+------+---------+------------+----------------+-------------+\n|userid|age_index|gender_index|occupation_index|zipcode_index|\n+------+---------+------------+----------------+-------------+\n|     1|      6.0|         1.0|            11.0|        111.0|\n|     2|      5.0|         0.0|             9.0|       3118.0|\n|     3|      0.0|         0.0|            13.0|         35.0|\n|     4|      3.0|         0.0|             2.0|        511.0|\n|     5|      0.0|         0.0|             7.0|          5.0|\n|     6|      4.0|         1.0|            17.0|         35.0|\n|     7|      1.0|         0.0|             3.0|        352.0|\n|     8|      0.0|         0.0|             5.0|       2621.0|\n|     9|      0.0|         0.0|             4.0|        650.0|\n|    10|      1.0|         1.0|             3.0|        667.0|\n|    11|      0.0|         1.0|             3.0|       1726.0|\n|    12|      0.0|         0.0|             5.0|       3263.0|\n|    13|      3.0|         0.0|             3.0|       1172.0|\n|    14|      1.0|         0.0|             1.0|        734.0|\n|    15|      0.0|         0.0|             2.0|          1.0|\n|    16|      1.0|         1.0|             1.0|       2193.0|\n|    17|      4.0|         0.0|             3.0|       2150.0|\n|    18|      2.0|         1.0|            12.0|        932.0|\n|    19|      6.0|         0.0|            11.0|         81.0|\n|    20|      0.0|         0.0|             6.0|         20.0|\n+------+---------+------------+----------------+-------------+\nonly showing top 20 rows\n\n\u001b[1m\u001b[34muinfo\u001b[0m: \u001b[1m\u001b[32morg.apache.spark.sql.DataFrame\u001b[0m = [userid: string, age_index: double ... 3 more fields]\n"
          }
        ]
      },
      "apps": [],
      "runtimeInfos": {
        "jobUrl": {
          "propertyName": "jobUrl",
          "label": "SPARK JOB",
          "tooltip": "View in Spark web UI",
          "group": "spark",
          "values": [
            {
              "jobUrl": "http://e67d52a5ef45:4040/jobs/job?id=1194",
              "$$hashKey": "object:94700"
            }
          ],
          "interpreterSettingId": "spark"
        }
      },
      "progressUpdateIntervalMs": 500,
      "jobName": "paragraph_1618453647621_1754903023",
      "id": "paragraph_1618193198283_1170994782",
      "dateCreated": "2021-04-15T02:27:27+0000",
      "dateStarted": "2021-04-15T03:31:14+0000",
      "dateFinished": "2021-04-15T03:31:14+0000",
      "status": "FINISHED",
      "$$hashKey": "object:80147"
    },
    {
      "text": "//placing all features within a list and referencing that to the userid\nval assembler = new VectorAssembler().setInputCols(u_features.columns).setOutputCol(\"features\")\nval users_output = assembler.transform(uinfo).select(\"userid\", \"features\")\nusers_output.show(20 , false)",
      "user": "anonymous",
      "dateUpdated": "2021-04-15T03:31:14+0000",
      "config": {
        "editorSetting": {
          "language": "scala",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "colWidth": 12,
        "editorMode": "ace/mode/scala",
        "fontSize": 9,
        "results": {},
        "enabled": true
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "TEXT",
            "data": "+------+--------------------+\n|userid|features            |\n+------+--------------------+\n|1     |[6.0,1.0,11.0,111.0]|\n|2     |[5.0,0.0,9.0,3118.0]|\n|3     |[0.0,0.0,13.0,35.0] |\n|4     |[3.0,0.0,2.0,511.0] |\n|5     |[0.0,0.0,7.0,5.0]   |\n|6     |[4.0,1.0,17.0,35.0] |\n|7     |[1.0,0.0,3.0,352.0] |\n|8     |[0.0,0.0,5.0,2621.0]|\n|9     |[0.0,0.0,4.0,650.0] |\n|10    |[1.0,1.0,3.0,667.0] |\n|11    |[0.0,1.0,3.0,1726.0]|\n|12    |[0.0,0.0,5.0,3263.0]|\n|13    |[3.0,0.0,3.0,1172.0]|\n|14    |[1.0,0.0,1.0,734.0] |\n|15    |[0.0,0.0,2.0,1.0]   |\n|16    |[1.0,1.0,1.0,2193.0]|\n|17    |[4.0,0.0,3.0,2150.0]|\n|18    |[2.0,1.0,12.0,932.0]|\n|19    |[6.0,0.0,11.0,81.0] |\n|20    |[0.0,0.0,6.0,20.0]  |\n+------+--------------------+\nonly showing top 20 rows\n\n\u001b[1m\u001b[34massembler\u001b[0m: \u001b[1m\u001b[32morg.apache.spark.ml.feature.VectorAssembler\u001b[0m = vecAssembler_bd792bd23300\n\u001b[1m\u001b[34musers_output\u001b[0m: \u001b[1m\u001b[32morg.apache.spark.sql.DataFrame\u001b[0m = [userid: string, features: vector]\n"
          }
        ]
      },
      "apps": [],
      "runtimeInfos": {
        "jobUrl": {
          "propertyName": "jobUrl",
          "label": "SPARK JOB",
          "tooltip": "View in Spark web UI",
          "group": "spark",
          "values": [
            {
              "jobUrl": "http://e67d52a5ef45:4040/jobs/job?id=1195",
              "$$hashKey": "object:94725"
            }
          ],
          "interpreterSettingId": "spark"
        }
      },
      "progressUpdateIntervalMs": 500,
      "jobName": "paragraph_1618453647621_488804408",
      "id": "paragraph_1618193229795_782804045",
      "dateCreated": "2021-04-15T02:27:27+0000",
      "dateStarted": "2021-04-15T03:31:14+0000",
      "dateFinished": "2021-04-15T03:31:15+0000",
      "status": "FINISHED",
      "$$hashKey": "object:80148"
    },
    {
      "text": "//split data set testing and training\r\nval Array(utraining, utesting) = users_output.randomSplit(Array(0.7, 0.3), seed = 1234)",
      "user": "anonymous",
      "dateUpdated": "2021-04-15T03:31:15+0000",
      "config": {
        "editorSetting": {
          "language": "scala",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "colWidth": 12,
        "editorMode": "ace/mode/scala",
        "fontSize": 9,
        "results": {},
        "enabled": true
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "TEXT",
            "data": "\u001b[1m\u001b[34mutraining\u001b[0m: \u001b[1m\u001b[32morg.apache.spark.sql.Dataset[org.apache.spark.sql.Row]\u001b[0m = [userid: string, features: vector]\n\u001b[1m\u001b[34mutesting\u001b[0m: \u001b[1m\u001b[32morg.apache.spark.sql.Dataset[org.apache.spark.sql.Row]\u001b[0m = [userid: string, features: vector]\n"
          }
        ]
      },
      "apps": [],
      "runtimeInfos": {},
      "progressUpdateIntervalMs": 500,
      "jobName": "paragraph_1618453647622_905717989",
      "id": "paragraph_1618193319789_472236887",
      "dateCreated": "2021-04-15T02:27:27+0000",
      "dateStarted": "2021-04-15T03:31:15+0000",
      "dateFinished": "2021-04-15T03:31:16+0000",
      "status": "FINISHED",
      "$$hashKey": "object:80149"
    },
    {
      "text": "// using kmeans to model with 13 clusters and fit to training\r\nval model = new KMeans()\r\n    .setK(13)\r\n    .setFeaturesCol(\"features\")\r\n    .setPredictionCol(\"prediction\")\r\n    .fit(utraining)",
      "user": "anonymous",
      "dateUpdated": "2021-04-15T03:31:16+0000",
      "config": {
        "editorSetting": {
          "language": "scala",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "colWidth": 12,
        "editorMode": "ace/mode/scala",
        "fontSize": 9,
        "results": {},
        "enabled": true
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "TEXT",
            "data": "\u001b[1m\u001b[34mmodel\u001b[0m: \u001b[1m\u001b[32morg.apache.spark.ml.clustering.KMeansModel\u001b[0m = kmeans_fba7038a5c52\n"
          }
        ]
      },
      "apps": [],
      "runtimeInfos": {
        "jobUrl": {
          "propertyName": "jobUrl",
          "label": "SPARK JOB",
          "tooltip": "View in Spark web UI",
          "group": "spark",
          "values": [
            {
              "jobUrl": "http://e67d52a5ef45:4040/jobs/job?id=1196",
              "$$hashKey": "object:97089"
            },
            {
              "jobUrl": "http://e67d52a5ef45:4040/jobs/job?id=1197",
              "$$hashKey": "object:97090"
            },
            {
              "jobUrl": "http://e67d52a5ef45:4040/jobs/job?id=1198",
              "$$hashKey": "object:97091"
            },
            {
              "jobUrl": "http://e67d52a5ef45:4040/jobs/job?id=1199",
              "$$hashKey": "object:97092"
            },
            {
              "jobUrl": "http://e67d52a5ef45:4040/jobs/job?id=1200",
              "$$hashKey": "object:97093"
            },
            {
              "jobUrl": "http://e67d52a5ef45:4040/jobs/job?id=1201",
              "$$hashKey": "object:97094"
            },
            {
              "jobUrl": "http://e67d52a5ef45:4040/jobs/job?id=1202",
              "$$hashKey": "object:97095"
            },
            {
              "jobUrl": "http://e67d52a5ef45:4040/jobs/job?id=1203",
              "$$hashKey": "object:97096"
            },
            {
              "jobUrl": "http://e67d52a5ef45:4040/jobs/job?id=1204",
              "$$hashKey": "object:97097"
            },
            {
              "jobUrl": "http://e67d52a5ef45:4040/jobs/job?id=1205",
              "$$hashKey": "object:97098"
            },
            {
              "jobUrl": "http://e67d52a5ef45:4040/jobs/job?id=1206",
              "$$hashKey": "object:97099"
            },
            {
              "jobUrl": "http://e67d52a5ef45:4040/jobs/job?id=1207",
              "$$hashKey": "object:97100"
            },
            {
              "jobUrl": "http://e67d52a5ef45:4040/jobs/job?id=1208",
              "$$hashKey": "object:97101"
            },
            {
              "jobUrl": "http://e67d52a5ef45:4040/jobs/job?id=1209",
              "$$hashKey": "object:97102"
            },
            {
              "jobUrl": "http://e67d52a5ef45:4040/jobs/job?id=1210",
              "$$hashKey": "object:97103"
            },
            {
              "jobUrl": "http://e67d52a5ef45:4040/jobs/job?id=1211",
              "$$hashKey": "object:97104"
            },
            {
              "jobUrl": "http://e67d52a5ef45:4040/jobs/job?id=1212",
              "$$hashKey": "object:97105"
            },
            {
              "jobUrl": "http://e67d52a5ef45:4040/jobs/job?id=1213",
              "$$hashKey": "object:97106"
            },
            {
              "jobUrl": "http://e67d52a5ef45:4040/jobs/job?id=1214",
              "$$hashKey": "object:97107"
            },
            {
              "jobUrl": "http://e67d52a5ef45:4040/jobs/job?id=1215",
              "$$hashKey": "object:97108"
            },
            {
              "jobUrl": "http://e67d52a5ef45:4040/jobs/job?id=1216",
              "$$hashKey": "object:97109"
            },
            {
              "jobUrl": "http://e67d52a5ef45:4040/jobs/job?id=1217",
              "$$hashKey": "object:97110"
            },
            {
              "jobUrl": "http://e67d52a5ef45:4040/jobs/job?id=1218",
              "$$hashKey": "object:97111"
            },
            {
              "jobUrl": "http://e67d52a5ef45:4040/jobs/job?id=1219",
              "$$hashKey": "object:97112"
            },
            {
              "jobUrl": "http://e67d52a5ef45:4040/jobs/job?id=1220",
              "$$hashKey": "object:97113"
            },
            {
              "jobUrl": "http://e67d52a5ef45:4040/jobs/job?id=1221",
              "$$hashKey": "object:97114"
            },
            {
              "jobUrl": "http://e67d52a5ef45:4040/jobs/job?id=1222",
              "$$hashKey": "object:97115"
            },
            {
              "jobUrl": "http://e67d52a5ef45:4040/jobs/job?id=1223",
              "$$hashKey": "object:97116"
            }
          ],
          "interpreterSettingId": "spark"
        }
      },
      "progressUpdateIntervalMs": 500,
      "jobName": "paragraph_1618453647622_1825193101",
      "id": "paragraph_1618193385436_2035163296",
      "dateCreated": "2021-04-15T02:27:27+0000",
      "dateStarted": "2021-04-15T03:31:16+0000",
      "dateFinished": "2021-04-15T03:31:20+0000",
      "status": "FINISHED",
      "$$hashKey": "object:80150"
    },
    {
      "text": "// test model with testing set\r\n   val user_predict1 = model.transform(utesting)\r\n   val user_predtrain = model.transform(utraining)\r\n   println(\"View predictions on test set\")\r\n   user_predict1.show(20)",
      "user": "anonymous",
      "dateUpdated": "2021-04-15T03:31:20+0000",
      "config": {
        "editorSetting": {
          "language": "scala",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "colWidth": 12,
        "editorMode": "ace/mode/scala",
        "fontSize": 9,
        "results": {},
        "enabled": true
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "TEXT",
            "data": "View predictions on test set\n+------+--------------------+----------+\n|userid|            features|prediction|\n+------+--------------------+----------+\n|     1|[6.0,1.0,11.0,111.0]|         1|\n|    10| [1.0,1.0,3.0,667.0]|        12|\n|   100| [1.0,0.0,4.0,692.0]|        12|\n|   101|[2.0,1.0,12.0,267.0]|        10|\n|  1021|[1.0,0.0,1.0,1179.0]|         0|\n|  1022|[0.0,0.0,12.0,205...|         8|\n|  1026| [3.0,1.0,1.0,916.0]|        12|\n|  1029| [0.0,0.0,1.0,722.0]|        12|\n|  1032|[4.0,0.0,9.0,1841.0]|         5|\n|  1035|[2.0,0.0,8.0,1643.0]|         5|\n|  1038|[5.0,1.0,13.0,805.0]|        12|\n|  1039|[1.0,1.0,3.0,2785.0]|         2|\n|  1040|[0.0,0.0,15.0,241...|         6|\n|  1045|[6.0,1.0,11.0,317...|         7|\n|  1054|[6.0,0.0,11.0,163...|         5|\n|  1057| [3.0,0.0,4.0,716.0]|        12|\n|  1065| [0.0,1.0,1.0,211.0]|        10|\n|  1069|  [0.0,0.0,7.0,54.0]|         1|\n|   107|[3.0,0.0,19.0,305...|         7|\n|  1071| [4.0,0.0,9.0,416.0]|         4|\n+------+--------------------+----------+\nonly showing top 20 rows\n\n\u001b[1m\u001b[34muser_predict1\u001b[0m: \u001b[1m\u001b[32morg.apache.spark.sql.DataFrame\u001b[0m = [userid: string, features: vector ... 1 more field]\n\u001b[1m\u001b[34muser_predtrain\u001b[0m: \u001b[1m\u001b[32morg.apache.spark.sql.DataFrame\u001b[0m = [userid: string, features: vector ... 1 more field]\n"
          }
        ]
      },
      "apps": [],
      "runtimeInfos": {
        "jobUrl": {
          "propertyName": "jobUrl",
          "label": "SPARK JOB",
          "tooltip": "View in Spark web UI",
          "group": "spark",
          "values": [
            {
              "jobUrl": "http://e67d52a5ef45:4040/jobs/job?id=1224",
              "$$hashKey": "object:97269"
            }
          ],
          "interpreterSettingId": "spark"
        }
      },
      "progressUpdateIntervalMs": 500,
      "jobName": "paragraph_1618453647622_1571884170",
      "id": "paragraph_1618193425480_2026535419",
      "dateCreated": "2021-04-15T02:27:27+0000",
      "dateStarted": "2021-04-15T03:31:20+0000",
      "dateFinished": "2021-04-15T03:31:21+0000",
      "status": "FINISHED",
      "$$hashKey": "object:80151"
    },
    {
      "text": "//reassign completed dataframe to user_predict\nval user_predict = user_predict1.union(user_predtrain)",
      "user": "anonymous",
      "dateUpdated": "2021-04-15T03:36:08+0000",
      "config": {
        "colWidth": 12,
        "fontSize": 9,
        "enabled": true,
        "results": {},
        "editorSetting": {
          "language": "scala",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "editorMode": "ace/mode/scala"
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "apps": [],
      "runtimeInfos": {},
      "progressUpdateIntervalMs": 500,
      "jobName": "paragraph_1618457106724_1348205024",
      "id": "paragraph_1618457106724_1348205024",
      "dateCreated": "2021-04-15T03:25:06+0000",
      "status": "FINISHED",
      "$$hashKey": "object:80152",
      "dateFinished": "2021-04-15T03:31:21+0000",
      "dateStarted": "2021-04-15T03:31:21+0000",
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "TEXT",
            "data": "\u001b[1m\u001b[34muser_predict\u001b[0m: \u001b[1m\u001b[32morg.apache.spark.sql.Dataset[org.apache.spark.sql.Row]\u001b[0m = [userid: string, features: vector ... 1 more field]\n"
          }
        ]
      }
    },
    {
      "text": "//renaming columns\nval userprd = user_predict.withColumnRenamed(\"userid\", \"user_id\").withColumnRenamed(\"features\", \"ufeatures\").withColumnRenamed(\"prediction\", \"uprediction\")\nuserprd.show(5)",
      "user": "anonymous",
      "dateUpdated": "2021-04-15T03:31:21+0000",
      "config": {
        "editorSetting": {
          "language": "scala",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "colWidth": 12,
        "editorMode": "ace/mode/scala",
        "fontSize": 9,
        "results": {},
        "enabled": true
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "TEXT",
            "data": "+-------+--------------------+-----------+\n|user_id|           ufeatures|uprediction|\n+-------+--------------------+-----------+\n|      1|[6.0,1.0,11.0,111.0]|          1|\n|     10| [1.0,1.0,3.0,667.0]|         12|\n|    100| [1.0,0.0,4.0,692.0]|         12|\n|    101|[2.0,1.0,12.0,267.0]|         10|\n|   1021|[1.0,0.0,1.0,1179.0]|          0|\n+-------+--------------------+-----------+\nonly showing top 5 rows\n\n\u001b[1m\u001b[34muserprd\u001b[0m: \u001b[1m\u001b[32morg.apache.spark.sql.DataFrame\u001b[0m = [user_id: string, ufeatures: vector ... 1 more field]\n"
          }
        ]
      },
      "apps": [],
      "runtimeInfos": {
        "jobUrl": {
          "propertyName": "jobUrl",
          "label": "SPARK JOB",
          "tooltip": "View in Spark web UI",
          "group": "spark",
          "values": [
            {
              "jobUrl": "http://e67d52a5ef45:4040/jobs/job?id=1225",
              "$$hashKey": "object:97339"
            }
          ],
          "interpreterSettingId": "spark"
        }
      },
      "progressUpdateIntervalMs": 500,
      "jobName": "paragraph_1618453647622_777043756",
      "id": "paragraph_1618193440087_2094009374",
      "dateCreated": "2021-04-15T02:27:27+0000",
      "dateStarted": "2021-04-15T03:31:21+0000",
      "dateFinished": "2021-04-15T03:31:22+0000",
      "status": "FINISHED",
      "$$hashKey": "object:80153"
    },
    {
      "text": "val evaluator = new ClusteringEvaluator()",
      "user": "anonymous",
      "dateUpdated": "2021-04-15T03:31:22+0000",
      "config": {
        "editorSetting": {
          "language": "scala",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "colWidth": 12,
        "editorMode": "ace/mode/scala",
        "fontSize": 9,
        "results": {},
        "enabled": true
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "TEXT",
            "data": "\u001b[1m\u001b[34mevaluator\u001b[0m: \u001b[1m\u001b[32morg.apache.spark.ml.evaluation.ClusteringEvaluator\u001b[0m = cluEval_163bf87da0f7\n"
          }
        ]
      },
      "apps": [],
      "runtimeInfos": {},
      "progressUpdateIntervalMs": 500,
      "jobName": "paragraph_1618453647623_1925806611",
      "id": "paragraph_1618193485616_1097812473",
      "dateCreated": "2021-04-15T02:27:27+0000",
      "dateStarted": "2021-04-15T03:31:22+0000",
      "dateFinished": "2021-04-15T03:31:23+0000",
      "status": "FINISHED",
      "$$hashKey": "object:80154"
    },
    {
      "text": "//A score of 0.6 since it is closer to 1, suggest that the clusters are fairly well apart from each other\r\nval silhouette = evaluator.evaluate(user_predict)\r\nprintln(s\"Silhouette with squared euclidean distance = $silhouette\")",
      "user": "anonymous",
      "dateUpdated": "2021-04-15T03:31:23+0000",
      "config": {
        "editorSetting": {
          "language": "scala",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "colWidth": 12,
        "editorMode": "ace/mode/scala",
        "fontSize": 9,
        "results": {},
        "enabled": true
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "TEXT",
            "data": "Silhouette with squared euclidean distance = 0.719607451568593\n\u001b[1m\u001b[34msilhouette\u001b[0m: \u001b[1m\u001b[32mDouble\u001b[0m = 0.719607451568593\n"
          }
        ]
      },
      "apps": [],
      "runtimeInfos": {
        "jobUrl": {
          "propertyName": "jobUrl",
          "label": "SPARK JOB",
          "tooltip": "View in Spark web UI",
          "group": "spark",
          "values": [
            {
              "jobUrl": "http://e67d52a5ef45:4040/jobs/job?id=1226",
              "$$hashKey": "object:97431"
            },
            {
              "jobUrl": "http://e67d52a5ef45:4040/jobs/job?id=1227",
              "$$hashKey": "object:97432"
            }
          ],
          "interpreterSettingId": "spark"
        }
      },
      "progressUpdateIntervalMs": 500,
      "jobName": "paragraph_1618453647625_1676565191",
      "id": "paragraph_1618193482532_1280727121",
      "dateCreated": "2021-04-15T02:27:27+0000",
      "dateStarted": "2021-04-15T03:31:23+0000",
      "dateFinished": "2021-04-15T03:31:25+0000",
      "status": "FINISHED",
      "$$hashKey": "object:80155"
    },
    {
      "text": "",
      "user": "anonymous",
      "dateUpdated": "2021-04-15T03:07:57+0000",
      "config": {
        "editorSetting": {
          "language": "scala",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "colWidth": 12,
        "editorMode": "ace/mode/scala",
        "fontSize": 9,
        "results": {},
        "enabled": true
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "apps": [],
      "runtimeInfos": {},
      "progressUpdateIntervalMs": 500,
      "jobName": "paragraph_1618453647626_515026714",
      "id": "paragraph_1618193779791_498202062",
      "dateCreated": "2021-04-15T02:27:27+0000",
      "status": "FINISHED",
      "$$hashKey": "object:80156"
    },
    {
      "title": "Upload Rating Data",
      "text": "%sh wget https://raw.githubusercontent.com/jcsamuels/UWI-BigData-project1/ML-1M/ratings.dat\n\n",
      "user": "anonymous",
      "dateUpdated": "2021-04-15T03:31:25+0000",
      "config": {
        "editorSetting": {
          "language": "sh",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": false
        },
        "colWidth": 12,
        "editorMode": "ace/mode/sh",
        "fontSize": 9,
        "title": true,
        "results": {},
        "enabled": true
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "TEXT",
            "data": "--2021-04-15 03:31:25--  https://raw.githubusercontent.com/jcsamuels/UWI-BigData-project1/ML-1M/ratings.dat\nResolving raw.githubusercontent.com (raw.githubusercontent.com)... 185.199.109.133, 185.199.108.133, 185.199.110.133, ...\nConnecting to raw.githubusercontent.com (raw.githubusercontent.com)|185.199.109.133|:443... connected.\nHTTP request sent, awaiting response... 200 OK\nLength: 24594131 (23M) [text/plain]\nSaving to: ‘ratings.dat.3’\n\n     0K .......... .......... .......... .......... ..........  0%  715K 34s\n    50K .......... .......... .......... .......... ..........  0% 1.63M 24s\n   100K .......... .......... .......... .......... ..........  0% 1015K 24s\n   150K .......... .......... .......... .......... ..........  0% 1.74M 21s\n   200K .......... .......... .......... .......... ..........  1%  943K 22s\n   250K .......... .......... .......... .......... ..........  1% 5.35M 19s\n   300K .......... .......... .......... .......... ..........  1% 3.47M 17s\n   350K .......... .......... .......... .......... ..........  1% 1.22M 17s\n   400K .......... .......... .......... .......... ..........  1% 3.61M 16s\n   450K .......... .......... .......... .......... ..........  2% 2.57M 15s\n   500K .......... .......... .......... .......... ..........  2% 2.94M 15s\n   550K .......... .......... .......... .......... ..........  2% 3.94M 14s\n   600K .......... .......... .......... .......... ..........  2% 4.65M 13s\n   650K .......... .......... .......... .......... ..........  2% 6.14M 12s\n   700K .......... .......... .......... .......... ..........  3% 2.47M 12s\n   750K .......... .......... .......... .......... ..........  3% 5.10M 12s\n   800K .......... .......... .......... .......... ..........  3% 5.12M 11s\n   850K .......... .......... .......... .......... ..........  3% 6.83M 11s\n   900K .......... .......... .......... .......... ..........  3% 2.48M 11s\n   950K .......... .......... .......... .......... ..........  4% 4.95M 10s\n  1000K .......... .......... .......... .......... ..........  4% 8.15M 10s\n  1050K .......... .......... .......... .......... ..........  4% 3.15M 10s\n  1100K .......... .......... .......... .......... ..........  4% 4.17M 10s\n  1150K .......... .......... .......... .......... ..........  4% 7.46M 9s\n  1200K .......... .......... .......... .......... ..........  5% 1.78M 9s\n  1250K .......... .......... .......... .......... ..........  5% 12.8M 9s\n  1300K .......... .......... .......... .......... ..........  5% 6.70M 9s\n  1350K .......... .......... .......... .......... ..........  5% 1.08M 9s\n  1400K .......... .......... .......... .......... ..........  6% 9.59M 9s\n  1450K .......... .......... .......... .......... ..........  6% 9.59M 9s\n  1500K .......... .......... .......... .......... ..........  6% 11.3M 9s\n  1550K .......... .......... .......... .......... ..........  6% 8.85M 8s\n  1600K .......... .......... .......... .......... ..........  6% 10.9M 8s\n  1650K .......... .......... .......... .......... ..........  7% 9.88M 8s\n  1700K .......... .......... .......... .......... ..........  7% 2.32M 8s\n  1750K .......... .......... .......... .......... ..........  7% 6.16M 8s\n  1800K .......... .......... .......... .......... ..........  7% 3.76M 8s\n  1850K .......... .......... .......... .......... ..........  7% 8.21M 8s\n  1900K .......... .......... .......... .......... ..........  8% 3.55M 8s\n  1950K .......... .......... .......... .......... ..........  8% 12.4M 7s\n  2000K .......... .......... .......... .......... ..........  8% 5.59M 7s\n  2050K .......... .......... .......... .......... ..........  8% 2.48M 7s\n  2100K .......... .......... .......... .......... ..........  8% 3.61M 7s\n  2150K .......... .......... .......... .......... ..........  9% 4.44M 7s\n  2200K .......... .......... .......... .......... ..........  9% 3.40M 7s\n  2250K .......... .......... .......... .......... ..........  9% 4.98M 7s\n  2300K .......... .......... .......... .......... ..........  9% 2.44M 7s\n  2350K .......... .......... .......... .......... ..........  9% 2.28M 7s\n  2400K .......... .......... .......... .......... .......... 10%  118K 11s\n  2450K .......... .......... .......... .......... .......... 10% 6.83M 10s\n  2500K .......... .......... .......... .......... .......... 10% 6.10M 10s\n  2550K .......... .......... .......... .......... .......... 10% 15.0M 10s\n  2600K .......... .......... .......... .......... .......... 11% 5.22M 10s\n  2650K .......... .......... .......... .......... .......... 11% 12.0M 10s\n  2700K .......... .......... .......... .......... .......... 11% 12.2M 10s\n  2750K .......... .......... .......... .......... .......... 11% 1.52M 10s\n  2800K .......... .......... .......... .......... .......... 11% 4.80M 10s\n  2850K .......... .......... .......... .......... .......... 12% 1.25M 10s\n  2900K .......... .......... .......... .......... .......... 12% 1.15M 10s\n  2950K .......... .......... .......... .......... .......... 12% 3.38M 10s\n  3000K .......... .......... .......... .......... .......... 12% 12.8M 10s\n  3050K .......... .......... .......... .......... .......... 12% 2.80M 9s\n  3100K .......... .......... .......... .......... .......... 13% 3.42M 9s\n  3150K .......... .......... .......... .......... .......... 13%  135M 9s\n  3200K .......... .......... .......... .......... .......... 13% 27.1M 9s\n  3250K .......... .......... .......... .......... .......... 13% 5.99M 9s\n  3300K .......... .......... .......... .......... .......... 13% 21.5M 9s\n  3350K .......... .......... .......... .......... .......... 14% 19.0M 9s\n  3400K .......... .......... .......... .......... .......... 14% 24.4M 9s\n  3450K .......... .......... .......... .......... .......... 14% 5.81M 8s\n  3500K .......... .......... .......... .......... .......... 14% 17.5M 8s\n  3550K .......... .......... .......... .......... .......... 14% 5.13M 8s\n  3600K .......... .......... .......... .......... .......... 15% 17.9M 8s\n  3650K .......... .......... .......... .......... .......... 15% 11.7M 8s\n  3700K .......... .......... .......... .......... .......... 15% 5.41M 8s\n  3750K .......... .......... .......... .......... .......... 15% 10.3M 8s\n  3800K .......... .......... .......... .......... .......... 16% 43.8M 8s\n  3850K .......... .......... .......... .......... .......... 16% 25.5M 8s\n  3900K .......... .......... .......... .......... .......... 16% 10.6M 8s\n  3950K .......... .......... .......... .......... .......... 16% 12.5M 7s\n  4000K .......... .......... .......... .......... .......... 16% 6.88M 7s\n  4050K .......... .......... .......... .......... .......... 17% 5.33M 7s\n  4100K .......... .......... .......... .......... .......... 17% 45.4M 7s\n  4150K .......... .......... .......... .......... .......... 17% 13.5M 7s\n  4200K .......... .......... .......... .......... .......... 17% 10.5M 7s\n  4250K .......... .......... .......... .......... .......... 17% 31.6M 7s\n  4300K .......... .......... .......... .......... .......... 18% 9.64M 7s\n  4350K .......... .......... .......... .......... .......... 18% 21.6M 7s\n  4400K .......... .......... .......... .......... .......... 18% 31.7M 7s\n  4450K .......... .......... .......... .......... .......... 18% 13.0M 7s\n  4500K .......... .......... .......... .......... .......... 18% 11.7M 7s\n  4550K .......... .......... .......... .......... .......... 19% 4.95M 7s\n  4600K .......... .......... .......... .......... .......... 19% 9.75M 6s\n  4650K .......... .......... .......... .......... .......... 19% 81.5M 6s\n  4700K .......... .......... .......... .......... .......... 19% 6.59M 6s\n  4750K .......... .......... .......... .......... .......... 19% 4.89M 6s\n  4800K .......... .......... .......... .......... .......... 20% 1.66M 6s\n  4850K .......... .......... .......... .......... .......... 20% 5.35M 6s\n  4900K .......... .......... .......... .......... .......... 20% 6.82M 6s\n  4950K .......... .......... .......... .......... .......... 20% 2.88M 6s\n  5000K .......... .......... .......... .......... .......... 21% 4.13M 6s\n  5050K .......... .......... .......... .......... .......... 21% 6.77M 6s\n  5100K .......... .......... .......... .......... .......... 21% 11.5M 6s\n  5150K .......... .......... .......... .......... .......... 21% 3.52M 6s\n  5200K .......... .......... .......... .......... .......... 21% 2.37M 6s\n  5250K .......... .......... .......... .......... .......... 22% 10.6M 6s\n  5300K .......... .......... .......... .......... .......... 22% 5.26M 6s\n  5350K .......... .......... .......... .......... .......... 22% 4.17M 6s\n  5400K .......... .......... .......... .......... .......... 22% 7.19M 6s\n  5450K .......... .......... .......... .......... .......... 22% 10.9M 6s\n  5500K .......... .......... .......... .......... .......... 23% 2.80M 6s\n  5550K .......... .......... .......... .......... .......... 23% 5.58M 6s\n  5600K .......... .......... .......... .......... .......... 23% 9.69M 6s\n  5650K .......... .......... .......... .......... .......... 23% 5.35M 6s\n  5700K .......... .......... .......... .......... .......... 23% 3.78M 6s\n  5750K .......... .......... .......... .......... .......... 24% 11.3M 6s\n  5800K .......... .......... .......... .......... .......... 24% 3.15M 6s\n  5850K .......... .......... .......... .......... .......... 24% 4.84M 6s\n  5900K .......... .......... .......... .......... .......... 24% 2.50M 6s\n  5950K .......... .......... .......... .......... .......... 24% 22.1M 5s\n  6000K .......... .......... .......... .......... .......... 25% 4.11M 5s\n  6050K .......... .......... .......... .......... .......... 25% 6.82M 5s\n  6100K .......... .......... .......... .......... .......... 25% 1.91M 5s\n  6150K .......... .......... .......... .......... .......... 25% 7.65M 5s\n  6200K .......... .......... .......... .......... .......... 26% 2.68M 5s\n  6250K .......... .......... .......... .......... .......... 26% 3.93M 5s\n  6300K .......... .......... .......... .......... .......... 26% 13.2M 5s\n  6350K .......... .......... .......... .......... .......... 26% 4.75M 5s\n  6400K .......... .......... .......... .......... .......... 26% 9.49M 5s\n  6450K .......... .......... .......... .......... .......... 27% 1.60M 5s\n  6500K .......... .......... .......... .......... .......... 27% 2.34M 5s\n  6550K .......... .......... .......... .......... .......... 27% 3.16M 5s\n  6600K .......... .......... .......... .......... .......... 27% 3.43M 5s\n  6650K .......... .......... .......... .......... .......... 27% 3.82M 5s\n  6700K .......... .......... .......... .......... .......... 28% 9.65M 5s\n  6750K .......... .......... .......... .......... .......... 28% 5.36M 5s\n  6800K .......... .......... .......... .......... .......... 28% 4.95M 5s\n  6850K .......... .......... .......... .......... .......... 28% 6.24M 5s\n  6900K .......... .......... .......... .......... .......... 28% 7.17M 5s\n  6950K .......... .......... .......... .......... .......... 29% 8.22M 5s\n  7000K .......... .......... .......... .......... .......... 29% 8.52M 5s\n  7050K .......... .......... .......... .......... .......... 29% 45.4M 5s\n  7100K .......... .......... .......... .......... .......... 29% 20.5M 5s\n  7150K .......... .......... .......... .......... .......... 29% 7.03M 5s\n  7200K .......... .......... .......... .......... .......... 30% 9.33M 5s\n  7250K .......... .......... .......... .......... .......... 30% 2.04M 5s\n  7300K .......... .......... .......... .......... .......... 30% 5.36M 5s\n  7350K .......... .......... .......... .......... .......... 30% 3.11M 5s\n  7400K .......... .......... .......... .......... .......... 31% 20.5M 5s\n  7450K .......... .......... .......... .......... .......... 31% 6.94M 5s\n  7500K .......... .......... .......... .......... .......... 31% 4.24M 5s\n  7550K .......... .......... .......... .......... .......... 31% 6.30M 5s\n  7600K .......... .......... .......... .......... .......... 31% 3.18M 5s\n  7650K .......... .......... .......... .......... .......... 32% 5.77M 5s\n  7700K .......... .......... .......... .......... .......... 32% 3.56M 5s\n  7750K .......... .......... .......... .......... .......... 32% 3.36M 5s\n  7800K .......... .......... .......... .......... .......... 32%  602K 5s\n  7850K .......... .......... .......... .......... .......... 32% 1.98M 5s\n  7900K .......... .......... .......... .......... .......... 33% 9.27M 5s\n  7950K .......... .......... .......... .......... .......... 33% 6.81M 5s\n  8000K .......... .......... .......... .......... .......... 33% 2.66M 5s\n  8050K .......... .......... .......... .......... .......... 33% 9.54M 5s\n  8100K .......... .......... .......... .......... .......... 33%  109M 5s\n  8150K .......... .......... .......... .......... .......... 34% 93.8M 5s\n  8200K .......... .......... .......... .......... .......... 34% 23.5M 5s\n  8250K .......... .......... .......... .......... .......... 34% 6.81M 4s\n  8300K .......... .......... .......... .......... .......... 34% 3.95M 4s\n  8350K .......... .......... .......... .......... .......... 34% 4.18M 4s\n  8400K .......... .......... .......... .......... .......... 35% 10.9M 4s\n  8450K .......... .......... .......... .......... .......... 35% 12.6M 4s\n  8500K .......... .......... .......... .......... .......... 35% 15.2M 4s\n  8550K .......... .......... .......... .......... .......... 35% 11.9M 4s\n  8600K .......... .......... .......... .......... .......... 36% 12.3M 4s\n  8650K .......... .......... .......... .......... .......... 36% 12.7M 4s\n  8700K .......... .......... .......... .......... .......... 36% 10.5M 4s\n  8750K .......... .......... .......... .......... .......... 36% 15.3M 4s\n  8800K .......... .......... .......... .......... .......... 36% 14.0M 4s\n  8850K .......... .......... .......... .......... .......... 37% 29.8M 4s\n  8900K .......... .......... .......... .......... .......... 37% 11.1M 4s\n  8950K .......... .......... .......... .......... .......... 37% 32.9M 4s\n  9000K .......... .......... .......... .......... .......... 37% 4.82M 4s\n  9050K .......... .......... .......... .......... .......... 37% 5.77M 4s\n  9100K .......... .......... .......... .......... .......... 38% 7.09M 4s\n  9150K .......... .......... .......... .......... .......... 38% 16.4M 4s\n  9200K .......... .......... .......... .......... .......... 38% 31.5M 4s\n  9250K .......... .......... .......... .......... .......... 38% 17.6M 4s\n  9300K .......... .......... .......... .......... .......... 38% 20.8M 4s\n  9350K .......... .......... .......... .......... .......... 39% 18.7M 4s\n  9400K .......... .......... .......... .......... .......... 39% 28.1M 4s\n  9450K .......... .......... .......... .......... .......... 39% 6.82M 4s\n  9500K .......... .......... .......... .......... .......... 39% 5.85M 4s\n  9550K .......... .......... .......... .......... .......... 39% 12.3M 4s\n  9600K .......... .......... .......... .......... .......... 40% 7.47M 4s\n  9650K .......... .......... .......... .......... .......... 40% 3.59M 4s\n  9700K .......... .......... .......... .......... .......... 40% 4.38M 4s\n  9750K .......... .......... .......... .......... .......... 40% 5.68M 4s\n  9800K .......... .......... .......... .......... .......... 41% 4.94M 4s\n  9850K .......... .......... .......... .......... .......... 41% 20.0M 4s\n  9900K .......... .......... .......... .......... .......... 41% 2.60M 4s\n  9950K .......... .......... .......... .......... .......... 41% 5.47M 4s\n 10000K .......... .......... .......... .......... .......... 41% 9.37M 4s\n 10050K .......... .......... .......... .......... .......... 42% 7.54M 4s\n 10100K .......... .......... .......... .......... .......... 42% 8.48M 4s\n 10150K .......... .......... .......... .......... .......... 42% 3.64M 4s\n 10200K .......... .......... .......... .......... .......... 42% 5.94M 4s\n 10250K .......... .......... .......... .......... .......... 42% 6.01M 3s\n 10300K .......... .......... .......... .......... .......... 43% 10.9M 3s\n 10350K .......... .......... .......... .......... .......... 43% 3.40M 3s\n 10400K .......... .......... .......... .......... .......... 43% 3.58M 3s\n 10450K .......... .......... .......... .......... .......... 43% 19.6M 3s\n 10500K .......... .......... .......... .......... .......... 43% 7.25M 3s\n 10550K .......... .......... .......... .......... .......... 44% 3.24M 3s\n 10600K .......... .......... .......... .......... .......... 44% 13.4M 3s\n 10650K .......... .......... .......... .......... .......... 44% 3.97M 3s\n 10700K .......... .......... .......... .......... .......... 44% 11.9M 3s\n 10750K .......... .......... .......... .......... .......... 44% 3.81M 3s\n 10800K .......... .......... .......... .......... .......... 45% 2.25M 3s\n 10850K .......... .......... .......... .......... .......... 45% 14.4M 3s\n 10900K .......... .......... .......... .......... .......... 45% 4.22M 3s\n 10950K .......... .......... .......... .......... .......... 45% 8.54M 3s\n 11000K .......... .......... .......... .......... .......... 46% 3.26M 3s\n 11050K .......... .......... .......... .......... .......... 46% 7.62M 3s\n 11100K .......... .......... .......... .......... .......... 46% 7.90M 3s\n 11150K .......... .......... .......... .......... .......... 46% 2.80M 3s\n 11200K .......... .......... .......... .......... .......... 46% 7.44M 3s\n 11250K .......... .......... .......... .......... .......... 47% 7.69M 3s\n 11300K .......... .......... .......... .......... .......... 47% 17.6M 3s\n 11350K .......... .......... .......... .......... .......... 47% 2.46M 3s\n 11400K .......... .......... .......... .......... .......... 47% 11.7M 3s\n 11450K .......... .......... .......... .......... .......... 47% 6.35M 3s\n 11500K .......... .......... .......... .......... .......... 48% 13.9M 3s\n 11550K .......... .......... .......... .......... .......... 48% 4.50M 3s\n 11600K .......... .......... .......... .......... .......... 48% 5.81M 3s\n 11650K .......... .......... .......... .......... .......... 48% 10.1M 3s\n 11700K .......... .......... .......... .......... .......... 48% 5.47M 3s\n 11750K .......... .......... .......... .......... .......... 49% 3.37M 3s\n 11800K .......... .......... .......... .......... .......... 49% 8.14M 3s\n 11850K .......... .......... .......... .......... .......... 49% 4.02M 3s\n 11900K .......... .......... .......... .......... .......... 49% 9.36M 3s\n 11950K .......... .......... .......... .......... .......... 49% 33.3M 3s\n 12000K .......... .......... .......... .......... .......... 50% 5.99M 3s\n 12050K .......... .......... .......... .......... .......... 50% 4.22M 3s\n 12100K .......... .......... .......... .......... .......... 50% 13.9M 3s\n 12150K .......... .......... .......... .......... .......... 50% 3.72M 3s\n 12200K .......... .......... .......... .......... .......... 51% 8.61M 3s\n 12250K .......... .......... .......... .......... .......... 51% 1.37M 3s\n 12300K .......... .......... .......... .......... .......... 51% 16.8M 3s\n 12350K .......... .......... .......... .......... .......... 51% 4.87M 3s\n 12400K .......... .......... .......... .......... .......... 51% 2.78M 3s\n 12450K .......... .......... .......... .......... .......... 52% 12.8M 3s\n 12500K .......... .......... .......... .......... .......... 52% 4.30M 3s\n 12550K .......... .......... .......... .......... .......... 52% 7.17M 3s\n 12600K .......... .......... .......... .......... .......... 52% 5.99M 3s\n 12650K .......... .......... .......... .......... .......... 52% 4.92M 3s\n 12700K .......... .......... .......... .......... .......... 53% 2.27M 3s\n 12750K .......... .......... .......... .......... .......... 53% 9.12M 3s\n 12800K .......... .......... .......... .......... .......... 53% 5.81M 3s\n 12850K .......... .......... .......... .......... .......... 53% 4.84M 3s\n 12900K .......... .......... .......... .......... .......... 53% 14.1M 3s\n 12950K .......... .......... .......... .......... .......... 54% 3.30M 3s\n 13000K .......... .......... .......... .......... .......... 54% 4.69M 3s\n 13050K .......... .......... .......... .......... .......... 54% 17.7M 3s\n 13100K .......... .......... .......... .......... .......... 54% 4.34M 3s\n 13150K .......... .......... .......... .......... .......... 54% 11.0M 3s\n 13200K .......... .......... .......... .......... .......... 55% 2.01M 3s\n 13250K .......... .......... .......... .......... .......... 55% 9.12M 3s\n 13300K .......... .......... .......... .......... .......... 55% 3.94M 3s\n 13350K .......... .......... .......... .......... .......... 55% 3.33M 3s\n 13400K .......... .......... .......... .......... .......... 56% 11.1M 3s\n 13450K .......... .......... .......... .......... .......... 56% 3.41M 3s\n 13500K .......... .......... .......... .......... .......... 56% 3.14M 3s\n 13550K .......... .......... .......... .......... .......... 56% 20.2M 2s\n 13600K .......... .......... .......... .......... .......... 56% 5.09M 2s\n 13650K .......... .......... .......... .......... .......... 57% 15.6M 2s\n 13700K .......... .......... .......... .......... .......... 57% 2.53M 2s\n 13750K .......... .......... .......... .......... .......... 57% 5.11M 2s\n 13800K .......... .......... .......... .......... .......... 57% 3.90M 2s\n 13850K .......... .......... .......... .......... .......... 57% 5.34M 2s\n 13900K .......... .......... .......... .......... .......... 58% 2.69M 2s\n 13950K .......... .......... .......... .......... .......... 58% 11.5M 2s\n 14000K .......... .......... .......... .......... .......... 58% 1.55M 2s\n 14050K .......... .......... .......... .......... .......... 58% 1.42M 2s\n 14100K .......... .......... .......... .......... .......... 58% 3.70M 2s\n 14150K .......... .......... .......... .......... .......... 59% 5.20M 2s\n 14200K .......... .......... .......... .......... .......... 59% 4.13M 2s\n 14250K .......... .......... .......... .......... .......... 59% 17.8M 2s\n 14300K .......... .......... .......... .......... .......... 59% 17.8M 2s\n 14350K .......... .......... .......... .......... .......... 59% 3.70M 2s\n 14400K .......... .......... .......... .......... .......... 60% 9.48M 2s\n 14450K .......... .......... .......... .......... .......... 60% 7.50M 2s\n 14500K .......... .......... .......... .......... .......... 60% 5.58M 2s\n 14550K .......... .......... .......... .......... .......... 60% 2.29M 2s\n 14600K .......... .......... .......... .......... .......... 60% 14.4M 2s\n 14650K .......... .......... .......... .......... .......... 61% 11.0M 2s\n 14700K .......... .......... .......... .......... .......... 61% 3.14M 2s\n 14750K .......... .......... .......... .......... .......... 61% 10.5M 2s\n 14800K .......... .......... .......... .......... .......... 61%  986K 2s\n 14850K .......... .......... .......... .......... .......... 62% 1.17M 2s\n 14900K .......... .......... .......... .......... .......... 62% 8.11M 2s\n 14950K .......... .......... .......... .......... .......... 62% 4.11M 2s\n 15000K .......... .......... .......... .......... .......... 62% 9.54M 2s\n 15050K .......... .......... .......... .......... .......... 62% 7.99M 2s\n 15100K .......... .......... .......... .......... .......... 63% 2.83M 2s\n 15150K .......... .......... .......... .......... .......... 63% 9.07M 2s\n 15200K .......... .......... .......... .......... .......... 63% 3.29M 2s\n 15250K .......... .......... .......... .......... .......... 63% 9.60M 2s\n 15300K .......... .......... .......... .......... .......... 63% 2.65M 2s\n 15350K .......... .......... .......... .......... .......... 64% 3.92M 2s\n 15400K .......... .......... .......... .......... .......... 64% 1.46M 2s\n 15450K .......... .......... .......... .......... .......... 64% 1.60M 2s\n 15500K .......... .......... .......... .......... .......... 64% 7.60M 2s\n 15550K .......... .......... .......... .......... .......... 64% 1.28M 2s\n 15600K .......... .......... .......... .......... .......... 65% 1.24M 2s\n 15650K .......... .......... .......... .......... .......... 65%  271K 2s\n 15700K .......... .......... .......... .......... .......... 65% 14.8M 2s\n 15750K .......... .......... .......... .......... .......... 65% 11.4M 2s\n 15800K .......... .......... .......... .......... .......... 65% 24.8M 2s\n 15850K .......... .......... .......... .......... .......... 66% 13.7M 2s\n 15900K .......... .......... .......... .......... .......... 66% 3.23M 2s\n 15950K .......... .......... .......... .......... .......... 66% 73.3M 2s\n 16000K .......... .......... .......... .......... .......... 66%  119M 2s\n 16050K .......... .......... .......... .......... .......... 67% 40.9M 2s\n 16100K .......... .......... .......... .......... .......... 67% 10.8M 2s\n 16150K .......... .......... .......... .......... .......... 67% 12.1M 2s\n 16200K .......... .......... .......... .......... .......... 67% 7.78M 2s\n 16250K .......... .......... .......... .......... .......... 67% 10.3M 2s\n 16300K .......... .......... .......... .......... .......... 68% 28.4M 2s\n 16350K .......... .......... .......... .......... .......... 68% 32.8M 2s\n 16400K .......... .......... .......... .......... .......... 68% 30.5M 2s\n 16450K .......... .......... .......... .......... .......... 68% 12.5M 2s\n 16500K .......... .......... .......... .......... .......... 68% 14.1M 2s\n 16550K .......... .......... .......... .......... .......... 69% 8.11M 2s\n 16600K .......... .......... .......... .......... .......... 69% 20.7M 2s\n 16650K .......... .......... .......... .......... .......... 69% 23.7M 2s\n 16700K .......... .......... .......... .......... .......... 69% 13.1M 2s\n 16750K .......... .......... .......... .......... .......... 69% 12.4M 2s\n 16800K .......... .......... .......... .......... .......... 70% 14.0M 2s\n 16850K .......... .......... .......... .......... .......... 70% 12.6M 2s\n 16900K .......... .......... .......... .......... .......... 70% 11.2M 2s\n 16950K .......... .......... .......... .......... .......... 70% 8.52M 2s\n 17000K .......... .......... .......... .......... .......... 70% 25.3M 2s\n 17050K .......... .......... .......... .......... .......... 71% 37.8M 2s\n 17100K .......... .......... .......... .......... .......... 71% 12.4M 2s\n 17150K .......... .......... .......... .......... .......... 71% 8.59M 2s\n 17200K .......... .......... .......... .......... .......... 71% 8.18M 2s\n 17250K .......... .......... .......... .......... .......... 72% 2.94M 2s\n 17300K .......... .......... .......... .......... .......... 72% 16.3M 2s\n 17350K .......... .......... .......... .......... .......... 72% 3.42M 2s\n 17400K .......... .......... .......... .......... .......... 72% 2.34M 2s\n 17450K .......... .......... .......... .......... .......... 72% 12.3M 2s\n 17500K .......... .......... .......... .......... .......... 73% 6.13M 2s\n 17550K .......... .......... .......... .......... .......... 73% 8.31M 2s\n 17600K .......... .......... .......... .......... .......... 73% 5.18M 2s\n 17650K .......... .......... .......... .......... .......... 73% 7.89M 2s\n 17700K .......... .......... .......... .......... .......... 73% 3.51M 2s\n 17750K .......... .......... .......... .......... .......... 74% 8.07M 1s\n 17800K .......... .......... .......... .......... .......... 74% 2.85M 1s\n 17850K .......... .......... .......... .......... .......... 74% 6.68M 1s\n 17900K .......... .......... .......... .......... .......... 74% 5.50M 1s\n 17950K .......... .......... .......... .......... .......... 74% 3.01M 1s\n 18000K .......... .......... .......... .......... .......... 75% 7.07M 1s\n 18050K .......... .......... .......... .......... .......... 75% 14.0M 1s\n 18100K .......... .......... .......... .......... .......... 75% 7.92M 1s\n 18150K .......... .......... .......... .......... .......... 75% 5.83M 1s\n 18200K .......... .......... .......... .......... .......... 75% 5.22M 1s\n 18250K .......... .......... .......... .......... .......... 76% 4.03M 1s\n 18300K .......... .......... .......... .......... .......... 76% 3.84M 1s\n 18350K .......... .......... .......... .......... .......... 76% 12.2M 1s\n 18400K .......... .......... .......... .......... .......... 76% 2.41M 1s\n 18450K .......... .......... .......... .......... .......... 77% 4.57M 1s\n 18500K .......... .......... .......... .......... .......... 77% 24.6M 1s\n 18550K .......... .......... .......... .......... .......... 77% 2.35M 1s\n 18600K .......... .......... .......... .......... .......... 77% 5.28M 1s\n 18650K .......... .......... .......... .......... .......... 77% 4.31M 1s\n 18700K .......... .......... .......... .......... .......... 78% 2.54M 1s\n 18750K .......... .......... .......... .......... .......... 78% 7.55M 1s\n 18800K .......... .......... .......... .......... .......... 78% 2.80M 1s\n 18850K .......... .......... .......... .......... .......... 78% 18.1M 1s\n 18900K .......... .......... .......... .......... .......... 78% 2.83M 1s\n 18950K .......... .......... .......... .......... .......... 79% 8.13M 1s\n 19000K .......... .......... .......... .......... .......... 79% 3.28M 1s\n 19050K .......... .......... .......... .......... .......... 79% 17.1M 1s\n 19100K .......... .......... .......... .......... .......... 79% 4.03M 1s\n 19150K .......... .......... .......... .......... .......... 79% 10.8M 1s\n 19200K .......... .......... .......... .......... .......... 80% 9.88M 1s\n 19250K .......... .......... .......... .......... .......... 80% 5.86M 1s\n 19300K .......... .......... .......... .......... .......... 80% 3.12M 1s\n 19350K .......... .......... .......... .......... .......... 80% 6.70M 1s\n 19400K .......... .......... .......... .......... .......... 80% 2.78M 1s\n 19450K .......... .......... .......... .......... .......... 81% 10.8M 1s\n 19500K .......... .......... .......... .......... .......... 81% 2.38M 1s\n 19550K .......... .......... .......... .......... .......... 81% 10.9M 1s\n 19600K .......... .......... .......... .......... .......... 81% 19.1M 1s\n 19650K .......... .......... .......... .......... .......... 82% 5.31M 1s\n 19700K .......... .......... .......... .......... .......... 82% 4.35M 1s\n 19750K .......... .......... .......... .......... .......... 82% 7.98M 1s\n 19800K .......... .......... .......... .......... .......... 82% 2.47M 1s\n 19850K .......... .......... .......... .......... .......... 82% 4.77M 1s\n 19900K .......... .......... .......... .......... .......... 83% 12.7M 1s\n 19950K .......... .......... .......... .......... .......... 83% 5.59M 1s\n 20000K .......... .......... .......... .......... .......... 83% 13.8M 1s\n 20050K .......... .......... .......... .......... .......... 83% 2.76M 1s\n 20100K .......... .......... .......... .......... .......... 83% 4.19M 1s\n 20150K .......... .......... .......... .......... .......... 84% 9.03M 1s\n 20200K .......... .......... .......... .......... .......... 84% 5.09M 1s\n 20250K .......... .......... .......... .......... .......... 84% 3.12M 1s\n 20300K .......... .......... .......... .......... .......... 84% 11.4M 1s\n 20350K .......... .......... .......... .......... .......... 84% 13.8M 1s\n 20400K .......... .......... .......... .......... .......... 85% 2.44M 1s\n 20450K .......... .......... .......... .......... .......... 85% 13.2M 1s\n 20500K .......... .......... .......... .......... .......... 85% 5.55M 1s\n 20550K .......... .......... .......... .......... .......... 85% 9.56M 1s\n 20600K .......... .......... .......... .......... .......... 85% 2.55M 1s\n 20650K .......... .......... .......... .......... .......... 86% 10.7M 1s\n 20700K .......... .......... .......... .......... .......... 86% 11.7M 1s\n 20750K .......... .......... .......... .......... .......... 86% 9.42M 1s\n 20800K .......... .......... .......... .......... .......... 86% 4.68M 1s\n 20850K .......... .......... .......... .......... .......... 87% 14.1M 1s\n 20900K .......... .......... .......... .......... .......... 87% 4.17M 1s\n 20950K .......... .......... .......... .......... .......... 87% 8.15M 1s\n 21000K .......... .......... .......... .......... .......... 87% 6.23M 1s\n 21050K .......... .......... .......... .......... .......... 87% 6.23M 1s\n 21100K .......... .......... .......... .......... .......... 88% 4.20M 1s\n 21150K .......... .......... .......... .......... .......... 88% 6.84M 1s\n 21200K .......... .......... .......... .......... .......... 88% 13.2M 1s\n 21250K .......... .......... .......... .......... .......... 88% 12.6M 1s\n 21300K .......... .......... .......... .......... .......... 88% 5.21M 1s\n 21350K .......... .......... .......... .......... .......... 89% 3.53M 1s\n 21400K .......... .......... .......... .......... .......... 89% 10.6M 1s\n 21450K .......... .......... .......... .......... .......... 89% 12.0M 1s\n 21500K .......... .......... .......... .......... .......... 89% 3.57M 1s\n 21550K .......... .......... .......... .......... .......... 89% 11.1M 1s\n 21600K .......... .......... .......... .......... .......... 90% 3.48M 1s\n 21650K .......... .......... .......... .......... .......... 90% 5.90M 1s\n 21700K .......... .......... .......... .......... .......... 90% 7.13M 1s\n 21750K .......... .......... .......... .......... .......... 90% 3.87M 1s\n 21800K .......... .......... .......... .......... .......... 90% 3.57M 1s\n 21850K .......... .......... .......... .......... .......... 91% 10.7M 0s\n 21900K .......... .......... .......... .......... .......... 91% 6.40M 0s\n 21950K .......... .......... .......... .......... .......... 91% 5.53M 0s\n 22000K .......... .......... .......... .......... .......... 91% 7.31M 0s\n 22050K .......... .......... .......... .......... .......... 92% 11.4M 0s\n 22100K .......... .......... .......... .......... .......... 92% 4.70M 0s\n 22150K .......... .......... .......... .......... .......... 92% 3.75M 0s\n 22200K .......... .......... .......... .......... .......... 92% 12.0M 0s\n 22250K .......... .......... .......... .......... .......... 92% 4.73M 0s\n 22300K .......... .......... .......... .......... .......... 93% 14.0M 0s\n 22350K .......... .......... .......... .......... .......... 93% 3.53M 0s\n 22400K .......... .......... .......... .......... .......... 93% 8.58M 0s\n 22450K .......... .......... .......... .......... .......... 93% 4.58M 0s\n 22500K .......... .......... .......... .......... .......... 93% 17.5M 0s\n 22550K .......... .......... .......... .......... .......... 94% 7.82M 0s\n 22600K .......... .......... .......... .......... .......... 94% 8.89M 0s\n 22650K .......... .......... .......... .......... .......... 94% 5.88M 0s\n 22700K .......... .......... .......... .......... .......... 94% 5.55M 0s\n 22750K .......... .......... .......... .......... .......... 94% 9.72M 0s\n 22800K .......... .......... .......... .......... .......... 95% 2.84M 0s\n 22850K .......... .......... .......... .......... .......... 95% 9.55M 0s\n 22900K .......... .......... .......... .......... .......... 95% 3.70M 0s\n 22950K .......... .......... .......... .......... .......... 95% 7.80M 0s\n 23000K .......... .......... .......... .......... .......... 95%  967K 0s\n 23050K .......... .......... .......... .......... .......... 96% 6.23M 0s\n 23100K .......... .......... .......... .......... .......... 96% 2.56M 0s\n 23150K .......... .......... .......... .......... .......... 96% 4.48M 0s\n 23200K .......... .......... .......... .......... .......... 96% 7.79M 0s\n 23250K .......... .......... .......... .......... .......... 97% 6.23M 0s\n 23300K .......... .......... .......... .......... .......... 97% 6.64M 0s\n 23350K .......... .......... .......... .......... .......... 97% 4.37M 0s\n 23400K .......... .......... .......... .......... .......... 97% 12.0M 0s\n 23450K .......... .......... .......... .......... .......... 97% 4.85M 0s\n 23500K .......... .......... .......... .......... .......... 98% 5.54M 0s\n 23550K .......... .......... .......... .......... .......... 98% 5.82M 0s\n 23600K .......... .......... .......... .......... .......... 98% 12.6M 0s\n 23650K .......... .......... .......... .......... .......... 98% 14.5M 0s\n 23700K .......... .......... .......... .......... .......... 98% 6.99M 0s\n 23750K .......... .......... .......... .......... .......... 99% 3.62M 0s\n 23800K .......... .......... .......... .......... .......... 99% 10.3M 0s\n 23850K .......... .......... .......... .......... .......... 99% 3.51M 0s\n 23900K .......... .......... .......... .......... .......... 99% 7.08M 0s\n 23950K .......... .......... .......... .......... .......... 99% 6.40M 0s\n 24000K .......... .......                                    100% 26.2M=5.4s\n\n2021-04-15 03:31:31 (4.30 MB/s) - ‘ratings.dat.3’ saved [24594131/24594131]\n\n"
          }
        ]
      },
      "apps": [],
      "runtimeInfos": {},
      "progressUpdateIntervalMs": 500,
      "jobName": "paragraph_1618453647627_790255598",
      "id": "paragraph_1618169874927_529039696",
      "dateCreated": "2021-04-15T02:27:27+0000",
      "dateStarted": "2021-04-15T03:31:25+0000",
      "dateFinished": "2021-04-15T03:31:31+0000",
      "status": "FINISHED",
      "$$hashKey": "object:80157"
    },
    {
      "text": "//split data column _co into constiuent columns\nval ratings1M = sqlContext.read.format(\"com.databricks.spark.csv\").option(\"sep\", \",\").option(\"header\", false).option(\"inferSchema\", true).load(\"ratings.dat\")\nval ratings1 = ratings1M.select(split(col(\"_c0\"),\"::\").getItem(0).as(\"userid\"),split(col(\"_c0\"),\"::\").getItem(1).as(\"movieid\"),split(col(\"_c0\"),\"::\").getItem(2).as(\"ratings\"),split(col(\"_c0\"),\"::\").getItem(3).as(\"timestamp\")).drop(\"_c0\")\nratings1.show(5, false)\n",
      "user": "anonymous",
      "dateUpdated": "2021-04-15T03:31:31+0000",
      "config": {
        "editorSetting": {
          "language": "scala",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "colWidth": 12,
        "editorMode": "ace/mode/scala",
        "fontSize": 9,
        "results": {},
        "enabled": true
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "TEXT",
            "data": "+------+-------+-------+---------+\n|userid|movieid|ratings|timestamp|\n+------+-------+-------+---------+\n|1     |1193   |5      |978300760|\n|1     |661    |3      |978302109|\n|1     |914    |3      |978301968|\n|1     |3408   |4      |978300275|\n|1     |2355   |5      |978824291|\n+------+-------+-------+---------+\nonly showing top 5 rows\n\n\u001b[1m\u001b[34mratings1M\u001b[0m: \u001b[1m\u001b[32morg.apache.spark.sql.DataFrame\u001b[0m = [_c0: string]\n\u001b[1m\u001b[34mratings1\u001b[0m: \u001b[1m\u001b[32morg.apache.spark.sql.DataFrame\u001b[0m = [userid: string, movieid: string ... 2 more fields]\n"
          }
        ]
      },
      "apps": [],
      "runtimeInfos": {
        "jobUrl": {
          "propertyName": "jobUrl",
          "label": "SPARK JOB",
          "tooltip": "View in Spark web UI",
          "group": "spark",
          "values": [
            {
              "jobUrl": "http://e67d52a5ef45:4040/jobs/job?id=1228",
              "$$hashKey": "object:97553"
            },
            {
              "jobUrl": "http://e67d52a5ef45:4040/jobs/job?id=1229",
              "$$hashKey": "object:97554"
            },
            {
              "jobUrl": "http://e67d52a5ef45:4040/jobs/job?id=1230",
              "$$hashKey": "object:97555"
            }
          ],
          "interpreterSettingId": "spark"
        }
      },
      "progressUpdateIntervalMs": 500,
      "jobName": "paragraph_1618453647633_1166160447",
      "id": "paragraph_1618193887328_1683829244",
      "dateCreated": "2021-04-15T02:27:27+0000",
      "dateStarted": "2021-04-15T03:31:32+0000",
      "dateFinished": "2021-04-15T03:31:34+0000",
      "status": "FINISHED",
      "$$hashKey": "object:80158"
    },
    {
      "text": "//review schema\nratings1.printSchema()",
      "user": "anonymous",
      "dateUpdated": "2021-04-15T03:31:34+0000",
      "config": {
        "editorSetting": {
          "language": "scala",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "colWidth": 12,
        "editorMode": "ace/mode/scala",
        "fontSize": 9,
        "results": {},
        "enabled": true
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "TEXT",
            "data": "root\n |-- userid: string (nullable = true)\n |-- movieid: string (nullable = true)\n |-- ratings: string (nullable = true)\n |-- timestamp: string (nullable = true)\n\n"
          }
        ]
      },
      "apps": [],
      "runtimeInfos": {},
      "progressUpdateIntervalMs": 500,
      "jobName": "paragraph_1618453647634_847196914",
      "id": "paragraph_1618194959804_1922339251",
      "dateCreated": "2021-04-15T02:27:27+0000",
      "dateStarted": "2021-04-15T03:31:34+0000",
      "dateFinished": "2021-04-15T03:31:34+0000",
      "status": "FINISHED",
      "$$hashKey": "object:80159"
    },
    {
      "text": "//converting ratings column to int\nval ratings = ratings1.selectExpr(\"userid\", \"movieid\", \"cast(ratings as int)\", \"timestamp\")\nratings.printSchema()",
      "user": "anonymous",
      "dateUpdated": "2021-04-15T03:31:34+0000",
      "config": {
        "editorSetting": {
          "language": "scala",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "colWidth": 12,
        "editorMode": "ace/mode/scala",
        "fontSize": 9,
        "results": {},
        "enabled": true
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "TEXT",
            "data": "root\n |-- userid: string (nullable = true)\n |-- movieid: string (nullable = true)\n |-- ratings: integer (nullable = true)\n |-- timestamp: string (nullable = true)\n\n\u001b[1m\u001b[34mratings\u001b[0m: \u001b[1m\u001b[32morg.apache.spark.sql.DataFrame\u001b[0m = [userid: string, movieid: string ... 2 more fields]\n"
          }
        ]
      },
      "apps": [],
      "runtimeInfos": {},
      "progressUpdateIntervalMs": 500,
      "jobName": "paragraph_1618453647637_1137387696",
      "id": "paragraph_1618194991948_841989748",
      "dateCreated": "2021-04-15T02:27:27+0000",
      "dateStarted": "2021-04-15T03:31:35+0000",
      "dateFinished": "2021-04-15T03:31:35+0000",
      "status": "FINISHED",
      "$$hashKey": "object:80160"
    },
    {
      "title": "Combining user and movie predicted values to ratings table",
      "text": "//joing tables\nval ratings_new = ratings.join(userprd, ratings(\"userid\") === userprd(\"user_id\"), \"left\")\nval ratings1 = ratings_new.join(movieprd, ratings(\"movieid\") === movieprd(\"movie_id\"), \"left\")\nratings1.show()\n// as it turns out not all movies from movies.dat are rated. ",
      "user": "anonymous",
      "dateUpdated": "2021-04-15T03:31:35+0000",
      "config": {
        "editorSetting": {
          "language": "scala",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "colWidth": 12,
        "editorMode": "ace/mode/scala",
        "fontSize": 9,
        "title": true,
        "results": {},
        "enabled": true
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "TEXT",
            "data": "+------+-------+-------+---------+-------+--------------------+-----------+--------+--------------+-----------+\n|userid|movieid|ratings|timestamp|user_id|           ufeatures|uprediction|movie_id|     mfeatures|mprediction|\n+------+-------+-------+---------+-------+--------------------+-----------+--------+--------------+-----------+\n|     1|   1193|      5|978300760|      1|[6.0,1.0,11.0,111.0]|          1|    1193|  [1245.0,0.0]|          9|\n|     1|    661|      3|978302109|      1|[6.0,1.0,11.0,111.0]|          1|     661| [1741.0,29.0]|         11|\n|     1|    914|      3|978301968|      1|[6.0,1.0,11.0,111.0]|          1|     914|  [315.0,85.0]|         12|\n|     1|   3408|      4|978300275|      1|[6.0,1.0,11.0,111.0]|          1|    3408|    [70.0,0.0]|          3|\n|     1|   2355|      5|978824291|      1|[6.0,1.0,11.0,111.0]|          1|    null|          null|       null|\n|     1|   1197|      3|978302268|      1|[6.0,1.0,11.0,111.0]|          1|    null|          null|       null|\n|     1|   1287|      5|978302039|      1|[6.0,1.0,11.0,111.0]|          1|    1287|[2662.0,126.0]|          2|\n|     1|   2804|      5|978300719|      1|[6.0,1.0,11.0,111.0]|          1|    null|          null|       null|\n|     1|    594|      4|978302268|      1|[6.0,1.0,11.0,111.0]|          1|     594| [2005.0,29.0]|          0|\n|     1|    919|      4|978301368|      1|[6.0,1.0,11.0,111.0]|          1|    null|          null|       null|\n|     1|    595|      5|978824268|      1|[6.0,1.0,11.0,111.0]|          1|     595| [2121.0,29.0]|          5|\n|     1|    938|      4|978301752|      1|[6.0,1.0,11.0,111.0]|          1|     938| [2489.0,35.0]|          6|\n|     1|   2398|      4|978302281|      1|[6.0,1.0,11.0,111.0]|          1|    2398|  [1636.0,0.0]|         11|\n|     1|   2918|      4|978302124|      1|[6.0,1.0,11.0,111.0]|          1|    2918|  [2867.0,1.0]|          8|\n|     1|   1035|      5|978301753|      1|[6.0,1.0,11.0,111.0]|          1|    null|          null|       null|\n|     1|   2791|      4|978302188|      1|[6.0,1.0,11.0,111.0]|          1|    2791|   [798.0,1.0]|         10|\n|     1|   2687|      3|978824268|      1|[6.0,1.0,11.0,111.0]|          1|    2687| [1861.0,21.0]|          0|\n|     1|   2018|      4|978301777|      1|[6.0,1.0,11.0,111.0]|          1|    2018| [1932.0,21.0]|          0|\n|     1|   3105|      5|978301713|      1|[6.0,1.0,11.0,111.0]|          1|    3105|  [1979.0,0.0]|          0|\n|     1|   2797|      4|978302039|      1|[6.0,1.0,11.0,111.0]|          1|    2797| [1902.0,72.0]|          0|\n+------+-------+-------+---------+-------+--------------------+-----------+--------+--------------+-----------+\nonly showing top 20 rows\n\n\u001b[1m\u001b[34mratings_new\u001b[0m: \u001b[1m\u001b[32morg.apache.spark.sql.DataFrame\u001b[0m = [userid: string, movieid: string ... 5 more fields]\n\u001b[1m\u001b[34mratings1\u001b[0m: \u001b[1m\u001b[32morg.apache.spark.sql.DataFrame\u001b[0m = [userid: string, movieid: string ... 8 more fields]\n"
          }
        ]
      },
      "apps": [],
      "runtimeInfos": {
        "jobUrl": {
          "propertyName": "jobUrl",
          "label": "SPARK JOB",
          "tooltip": "View in Spark web UI",
          "group": "spark",
          "values": [
            {
              "jobUrl": "http://e67d52a5ef45:4040/jobs/job?id=1231",
              "$$hashKey": "object:97705"
            },
            {
              "jobUrl": "http://e67d52a5ef45:4040/jobs/job?id=1232",
              "$$hashKey": "object:97706"
            },
            {
              "jobUrl": "http://e67d52a5ef45:4040/jobs/job?id=1233",
              "$$hashKey": "object:97707"
            }
          ],
          "interpreterSettingId": "spark"
        }
      },
      "progressUpdateIntervalMs": 500,
      "jobName": "paragraph_1618453647638_764847304",
      "id": "paragraph_1618193479916_1083252158",
      "dateCreated": "2021-04-15T02:27:27+0000",
      "dateStarted": "2021-04-15T03:31:35+0000",
      "dateFinished": "2021-04-15T03:31:42+0000",
      "status": "FINISHED",
      "$$hashKey": "object:80161"
    },
    {
      "text": "//checking if null exist for upredictions / ufeatures\nratings1.filter(\"ufeatures is null\").show(false)\n//there are missing ufeature values as well",
      "user": "anonymous",
      "dateUpdated": "2021-04-15T03:31:42+0000",
      "config": {
        "editorSetting": {
          "language": "scala",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "colWidth": 12,
        "editorMode": "ace/mode/scala",
        "fontSize": 9,
        "results": {},
        "enabled": true
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "TEXT",
            "data": "+------+-------+-------+---------+-------+---------+-----------+--------+---------+-----------+\n|userid|movieid|ratings|timestamp|user_id|ufeatures|uprediction|movie_id|mfeatures|mprediction|\n+------+-------+-------+---------+-------+---------+-----------+--------+---------+-----------+\n+------+-------+-------+---------+-------+---------+-----------+--------+---------+-----------+\n\n"
          }
        ]
      },
      "apps": [],
      "runtimeInfos": {
        "jobUrl": {
          "propertyName": "jobUrl",
          "label": "SPARK JOB",
          "tooltip": "View in Spark web UI",
          "group": "spark",
          "values": [
            {
              "jobUrl": "http://e67d52a5ef45:4040/jobs/job?id=1234",
              "$$hashKey": "object:97858"
            },
            {
              "jobUrl": "http://e67d52a5ef45:4040/jobs/job?id=1235",
              "$$hashKey": "object:97859"
            },
            {
              "jobUrl": "http://e67d52a5ef45:4040/jobs/job?id=1236",
              "$$hashKey": "object:97860"
            },
            {
              "jobUrl": "http://e67d52a5ef45:4040/jobs/job?id=1237",
              "$$hashKey": "object:97861"
            },
            {
              "jobUrl": "http://e67d52a5ef45:4040/jobs/job?id=1238",
              "$$hashKey": "object:97862"
            }
          ],
          "interpreterSettingId": "spark"
        }
      },
      "progressUpdateIntervalMs": 500,
      "jobName": "paragraph_1618453647639_125946458",
      "id": "paragraph_1618193616283_991100144",
      "dateCreated": "2021-04-15T02:27:27+0000",
      "dateStarted": "2021-04-15T03:31:43+0000",
      "dateFinished": "2021-04-15T03:31:53+0000",
      "status": "FINISHED",
      "$$hashKey": "object:80162"
    },
    {
      "text": "//filtering / drop out out null rows\nval ratings_nw1 = ratings1.na.drop()\nratings_nw.show()",
      "user": "anonymous",
      "dateUpdated": "2021-04-15T03:31:54+0000",
      "config": {
        "editorSetting": {
          "language": "scala",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "colWidth": 12,
        "editorMode": "ace/mode/scala",
        "fontSize": 9,
        "results": {},
        "enabled": true
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "TEXT",
            "data": "+------+-------+------+---------+-------+--------------------+-----------+--------+--------------------+-----------+\n|userid|movieid|rating|timestamp|user_id|           ufeatures|uprediction|movie_id|           mfeatures|mprediction|\n+------+-------+------+---------+-------+--------------------+-----------+--------+--------------------+-----------+\n|   196|    242|     3|881250949|    196|  [25.0,0.0,7.0,1.0]|          6|     242|(22,[0,1,2,8],[12...|         11|\n|   186|    302|     3|891717742|    186| [17.0,1.0,8.0,68.0]|          2|     302|(22,[0,1,2,9,13,1...|         12|\n|    22|    377|     1|878887116|     22| [1.0,0.0,7.0,409.0]|          3|     377|(22,[0,1,2,7,8],[...|          3|\n|   244|     51|     2|880606923|    244| [3.0,0.0,11.0,27.0]|          6|      51|(22,[0,1,2,11,17,...|         12|\n|   166|    346|     1|886397596|    166| [31.0,0.0,2.0,15.0]|          6|     346|(22,[0,1,2,9,11],...|          3|\n|   298|    474|     4|884182806|    298|[16.0,0.0,8.0,787.0]|          5|     474|(22,[0,1,2,18,20]...|         10|\n|   115|    265|     2|881171488|    115|[14.0,0.0,4.0,349.0]|          0|     265|(22,[0,1,2,4,19],...|          7|\n|   253|    465|     5|891628467|    253|  [5.0,1.0,6.0,16.0]|          6|     465|(22,[0,1,2,5,7,17...|         12|\n|   305|    451|     3|886324817|    305| [9.0,0.0,5.0,100.0]|          7|     451|(22,[0,1,2,8,15,1...|         11|\n|     6|     86|     3|883603013|      6|[20.0,0.0,8.0,162.0]|         10|      86|(22,[0,1,2,11],[1...|         10|\n|    62|    257|     2|879372434|     62| [4.0,1.0,3.0,209.0]|          9|     257|(22,[0,1,2,4,5,8,...|          3|\n|   286|   1014|     5|879781125|    286| [4.0,0.0,0.0,222.0]|          9|    1014|(22,[0,1,2,8],[64...|          0|\n|   200|    222|     5|876042340|    200|[18.0,0.0,5.0,142.0]|         10|     222|(22,[0,1,2,4,5,18...|          9|\n|   210|     40|     3|891035994|    210|[17.0,0.0,4.0,693.0]|          4|      40|(22,[0,2,8],[543....|          4|\n|   224|     29|     3|888104457|    224|[14.0,1.0,2.0,519.0]|          8|      29|(22,[0,2,4,5,8,9]...|          0|\n|   303|    785|     3|879485318|    303|[15.0,0.0,0.0,684.0]|          4|     785|(22,[0,1,2,8,17],...|          2|\n|   122|    387|     5|879270459|    122| [10.0,1.0,7.0,31.0]|          6|     387|(22,[0,1,2,11],[1...|          1|\n|   194|    274|     2|879539794|    194| [28.0,0.0,3.0,94.0]|          7|     274|(22,[0,2,8,17],[8...|          8|\n|   291|   1042|     4|874834944|    291|[15.0,0.0,0.0,292.0]|          0|    1042|(22,[0,2,16,19],[...|          3|\n|   234|   1184|     2|892079237|    234|[38.0,0.0,15.0,65...|          4|    1184|(22,[0,1,2,10],[9...|          9|\n+------+-------+------+---------+-------+--------------------+-----------+--------+--------------------+-----------+\nonly showing top 20 rows\n\n\u001b[1m\u001b[34mratings_nw1\u001b[0m: \u001b[1m\u001b[32morg.apache.spark.sql.DataFrame\u001b[0m = [userid: string, movieid: string ... 8 more fields]\n"
          }
        ]
      },
      "apps": [],
      "runtimeInfos": {
        "jobUrl": {
          "propertyName": "jobUrl",
          "label": "SPARK JOB",
          "tooltip": "View in Spark web UI",
          "group": "spark",
          "values": [
            {
              "jobUrl": "http://e67d52a5ef45:4040/jobs/job?id=1239",
              "$$hashKey": "object:97968"
            },
            {
              "jobUrl": "http://e67d52a5ef45:4040/jobs/job?id=1240",
              "$$hashKey": "object:97969"
            },
            {
              "jobUrl": "http://e67d52a5ef45:4040/jobs/job?id=1241",
              "$$hashKey": "object:97970"
            }
          ],
          "interpreterSettingId": "spark"
        }
      },
      "progressUpdateIntervalMs": 500,
      "jobName": "paragraph_1618453647639_1736580032",
      "id": "paragraph_1618193612512_878070978",
      "dateCreated": "2021-04-15T02:27:27+0000",
      "dateStarted": "2021-04-15T03:31:54+0000",
      "dateFinished": "2021-04-15T03:31:55+0000",
      "status": "FINISHED",
      "$$hashKey": "object:80163"
    },
    {
      "text": "//checking how many rows dropped\nprintln(ratings1.count, ratings_nw1.count)\n//939593 rows from ratings droped because not all users and movies provided and were given ratings",
      "user": "anonymous",
      "dateUpdated": "2021-04-15T03:31:55+0000",
      "config": {
        "editorSetting": {
          "language": "scala",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "colWidth": 12,
        "editorMode": "ace/mode/scala",
        "fontSize": 9,
        "results": {},
        "enabled": true
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "TEXT",
            "data": "(1000209,756975)\n"
          }
        ]
      },
      "apps": [],
      "runtimeInfos": {
        "jobUrl": {
          "propertyName": "jobUrl",
          "label": "SPARK JOB",
          "tooltip": "View in Spark web UI",
          "group": "spark",
          "values": [
            {
              "jobUrl": "http://e67d52a5ef45:4040/jobs/job?id=1242",
              "$$hashKey": "object:98187"
            },
            {
              "jobUrl": "http://e67d52a5ef45:4040/jobs/job?id=1243",
              "$$hashKey": "object:98188"
            },
            {
              "jobUrl": "http://e67d52a5ef45:4040/jobs/job?id=1244",
              "$$hashKey": "object:98189"
            },
            {
              "jobUrl": "http://e67d52a5ef45:4040/jobs/job?id=1245",
              "$$hashKey": "object:98190"
            },
            {
              "jobUrl": "http://e67d52a5ef45:4040/jobs/job?id=1246",
              "$$hashKey": "object:98191"
            },
            {
              "jobUrl": "http://e67d52a5ef45:4040/jobs/job?id=1247",
              "$$hashKey": "object:98192"
            }
          ],
          "interpreterSettingId": "spark"
        }
      },
      "progressUpdateIntervalMs": 500,
      "jobName": "paragraph_1618453647640_1043710935",
      "id": "paragraph_1618193609501_762375577",
      "dateCreated": "2021-04-15T02:27:27+0000",
      "dateStarted": "2021-04-15T03:31:56+0000",
      "dateFinished": "2021-04-15T03:32:20+0000",
      "status": "FINISHED",
      "$$hashKey": "object:80164"
    },
    {
      "title": "ALS Modeling 1M Dataset",
      "text": "//creating training and test data for modelling\nval Array(training, test) = ratings_nw1.randomSplit(Array(0.8, 0.2))",
      "user": "anonymous",
      "dateUpdated": "2021-04-15T03:32:20+0000",
      "config": {
        "editorSetting": {
          "language": "scala",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "colWidth": 12,
        "editorMode": "ace/mode/scala",
        "fontSize": 9,
        "title": true,
        "results": {},
        "enabled": true
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "TEXT",
            "data": "\u001b[1m\u001b[34mtraining\u001b[0m: \u001b[1m\u001b[32morg.apache.spark.sql.Dataset[org.apache.spark.sql.Row]\u001b[0m = [userid: string, movieid: string ... 8 more fields]\n\u001b[1m\u001b[34mtest\u001b[0m: \u001b[1m\u001b[32morg.apache.spark.sql.Dataset[org.apache.spark.sql.Row]\u001b[0m = [userid: string, movieid: string ... 8 more fields]\n"
          }
        ]
      },
      "apps": [],
      "runtimeInfos": {},
      "progressUpdateIntervalMs": 500,
      "jobName": "paragraph_1618453647640_817600579",
      "id": "paragraph_1618193606157_752531418",
      "dateCreated": "2021-04-15T02:27:27+0000",
      "dateStarted": "2021-04-15T03:32:20+0000",
      "dateFinished": "2021-04-15T03:32:21+0000",
      "status": "FINISHED",
      "$$hashKey": "object:80165"
    },
    {
      "text": "//setting model parameters\r\nval als = new ALS()\r\n      .setMaxIter(5)\r\n      .setRegParam(0.01)\r\n      .setUserCol(\"uprediction\")\r\n      .setItemCol(\"mprediction\")\r\n      .setRatingCol(\"ratings\")\r\nval model = als.fit(training)",
      "user": "anonymous",
      "dateUpdated": "2021-04-15T03:32:21+0000",
      "config": {
        "editorSetting": {
          "language": "scala",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "colWidth": 12,
        "editorMode": "ace/mode/scala",
        "fontSize": 9,
        "results": {},
        "enabled": true
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "TEXT",
            "data": "\u001b[1m\u001b[34mals\u001b[0m: \u001b[1m\u001b[32morg.apache.spark.ml.recommendation.ALS\u001b[0m = als_93ee3740b943\n\u001b[1m\u001b[34mmodel\u001b[0m: \u001b[1m\u001b[32morg.apache.spark.ml.recommendation.ALSModel\u001b[0m = als_93ee3740b943\n"
          }
        ]
      },
      "apps": [],
      "runtimeInfos": {
        "jobUrl": {
          "propertyName": "jobUrl",
          "label": "SPARK JOB",
          "tooltip": "View in Spark web UI",
          "group": "spark",
          "values": [
            {
              "jobUrl": "http://e67d52a5ef45:4040/jobs/job?id=1248",
              "$$hashKey": "object:98600"
            },
            {
              "jobUrl": "http://e67d52a5ef45:4040/jobs/job?id=1249",
              "$$hashKey": "object:98601"
            },
            {
              "jobUrl": "http://e67d52a5ef45:4040/jobs/job?id=1250",
              "$$hashKey": "object:98602"
            },
            {
              "jobUrl": "http://e67d52a5ef45:4040/jobs/job?id=1251",
              "$$hashKey": "object:98603"
            },
            {
              "jobUrl": "http://e67d52a5ef45:4040/jobs/job?id=1252",
              "$$hashKey": "object:98604"
            },
            {
              "jobUrl": "http://e67d52a5ef45:4040/jobs/job?id=1253",
              "$$hashKey": "object:98605"
            },
            {
              "jobUrl": "http://e67d52a5ef45:4040/jobs/job?id=1254",
              "$$hashKey": "object:98606"
            },
            {
              "jobUrl": "http://e67d52a5ef45:4040/jobs/job?id=1255",
              "$$hashKey": "object:98607"
            },
            {
              "jobUrl": "http://e67d52a5ef45:4040/jobs/job?id=1256",
              "$$hashKey": "object:98608"
            }
          ],
          "interpreterSettingId": "spark"
        }
      },
      "progressUpdateIntervalMs": 500,
      "jobName": "paragraph_1618453647640_1570560839",
      "id": "paragraph_1618193602726_1908911790",
      "dateCreated": "2021-04-15T02:27:27+0000",
      "dateStarted": "2021-04-15T03:32:21+0000",
      "dateFinished": "2021-04-15T03:33:12+0000",
      "status": "FINISHED",
      "$$hashKey": "object:80166"
    },
    {
      "text": "// Evaluate the model by computing the RMSE on the test data\r\n// Cold start strategy to 'drop' to ensure we don't get NaN evaluation metrics\r\nmodel.setColdStartStrategy(\"drop\")\r\nval predictions = model.transform(test)",
      "user": "anonymous",
      "dateUpdated": "2021-04-15T03:33:12+0000",
      "config": {
        "editorSetting": {
          "language": "scala",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "colWidth": 12,
        "editorMode": "ace/mode/scala",
        "fontSize": 9,
        "results": {},
        "enabled": true
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "TEXT",
            "data": "\u001b[1m\u001b[34mpredictions\u001b[0m: \u001b[1m\u001b[32morg.apache.spark.sql.DataFrame\u001b[0m = [userid: string, movieid: string ... 9 more fields]\n"
          }
        ]
      },
      "apps": [],
      "runtimeInfos": {},
      "progressUpdateIntervalMs": 500,
      "jobName": "paragraph_1618453647640_540620035",
      "id": "paragraph_1618193598779_733571390",
      "dateCreated": "2021-04-15T02:27:27+0000",
      "dateStarted": "2021-04-15T03:33:12+0000",
      "dateFinished": "2021-04-15T03:33:13+0000",
      "status": "FINISHED",
      "$$hashKey": "object:80167"
    },
    {
      "text": "// Evaluate Model using RMSE\r\nval evaluator = new RegressionEvaluator().setMetricName(\"rmse\").setLabelCol(\"ratings\").setPredictionCol(\"prediction\")\r\nval rmse = evaluator.evaluate(predictions)\r\nprintln(s\"Root-mean-square error = $rmse\")",
      "user": "anonymous",
      "dateUpdated": "2021-04-15T03:33:13+0000",
      "config": {
        "editorSetting": {
          "language": "sh",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": false
        },
        "colWidth": 12,
        "editorMode": "ace/mode/sh",
        "fontSize": 9,
        "results": {},
        "enabled": true
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "TEXT",
            "data": "Root-mean-square error = 1.120272782307169\n\u001b[1m\u001b[34mevaluator\u001b[0m: \u001b[1m\u001b[32morg.apache.spark.ml.evaluation.RegressionEvaluator\u001b[0m = regEval_5d5b43abcde1\n\u001b[1m\u001b[34mrmse\u001b[0m: \u001b[1m\u001b[32mDouble\u001b[0m = 1.120272782307169\n"
          }
        ]
      },
      "apps": [],
      "runtimeInfos": {
        "jobUrl": {
          "propertyName": "jobUrl",
          "label": "SPARK JOB",
          "tooltip": "View in Spark web UI",
          "group": "spark",
          "values": [
            {
              "jobUrl": "http://e67d52a5ef45:4040/jobs/job?id=1257",
              "$$hashKey": "object:98761"
            },
            {
              "jobUrl": "http://e67d52a5ef45:4040/jobs/job?id=1258",
              "$$hashKey": "object:98762"
            },
            {
              "jobUrl": "http://e67d52a5ef45:4040/jobs/job?id=1259",
              "$$hashKey": "object:98763"
            }
          ],
          "interpreterSettingId": "spark"
        }
      },
      "progressUpdateIntervalMs": 500,
      "jobName": "paragraph_1618453647640_507306027",
      "id": "paragraph_1618170148722_366742527",
      "dateCreated": "2021-04-15T02:27:27+0000",
      "dateStarted": "2021-04-15T03:33:13+0000",
      "dateFinished": "2021-04-15T03:33:29+0000",
      "status": "FINISHED",
      "$$hashKey": "object:80168"
    },
    {
      "text": "// Generate top 10 movie recommendations for each user (Item to user)\nval usertop10 = model.recommendForAllUsers(10)\n",
      "user": "anonymous",
      "dateUpdated": "2021-04-15T03:33:29+0000",
      "config": {
        "editorSetting": {
          "language": "scala",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "colWidth": 12,
        "editorMode": "ace/mode/scala",
        "fontSize": 9,
        "results": {},
        "enabled": true
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "TEXT",
            "data": "\u001b[1m\u001b[34musertop10\u001b[0m: \u001b[1m\u001b[32morg.apache.spark.sql.DataFrame\u001b[0m = [uprediction: int, recommendations: array<struct<mprediction:int,rating:float>>]\n"
          }
        ]
      },
      "apps": [],
      "runtimeInfos": {},
      "progressUpdateIntervalMs": 500,
      "jobName": "paragraph_1618453647641_535894730",
      "id": "paragraph_1618169972059_1971673939",
      "dateCreated": "2021-04-15T02:27:27+0000",
      "dateStarted": "2021-04-15T03:33:29+0000",
      "dateFinished": "2021-04-15T03:33:30+0000",
      "status": "FINISHED",
      "$$hashKey": "object:80169"
    },
    {
      "text": "//showing top 10 recommendations by cluster\nusertop10.show(false)\n",
      "user": "anonymous",
      "dateUpdated": "2021-04-15T03:33:30+0000",
      "config": {
        "editorSetting": {
          "language": "scala",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "colWidth": 12,
        "editorMode": "ace/mode/scala",
        "fontSize": 9,
        "results": {},
        "enabled": true
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "TEXT",
            "data": "+-----------+-----------------------------------------------------------------------------------------------------------------------------------------------------------------+\n|uprediction|recommendations                                                                                                                                                  |\n+-----------+-----------------------------------------------------------------------------------------------------------------------------------------------------------------+\n|12         |[[12, 3.6400213], [6, 3.6337762], [7, 3.6216795], [2, 3.609049], [3, 3.588676], [9, 3.5860128], [5, 3.58245], [8, 3.579925], [0, 3.5628874], [11, 3.5421422]]    |\n|1          |[[12, 3.6388664], [6, 3.6340601], [7, 3.616575], [2, 3.6113124], [9, 3.5851057], [3, 3.5846455], [5, 3.5810702], [8, 3.5795279], [0, 3.5638764], [11, 3.5380757]]|\n|6          |[[12, 3.5985057], [6, 3.5916772], [7, 3.5821624], [2, 3.5663323], [3, 3.5490575], [9, 3.5450046], [5, 3.541697], [8, 3.5387654], [0, 3.521292], [11, 3.5030613]] |\n|3          |[[12, 3.585098], [6, 3.5790696], [7, 3.5666976], [2, 3.5548837], [3, 3.5342817], [9, 3.5319247], [5, 3.5283754], [8, 3.525971], [0, 3.509308], [11, 3.4884474]]  |\n|5          |[[12, 3.649192], [6, 3.6425853], [7, 3.6317575], [2, 3.6173203], [3, 3.5984151], [9, 3.5949917], [5, 3.5915344], [8, 3.588767], [0, 3.5713542], [11, 3.5517745]] |\n|9          |[[12, 3.6335318], [6, 3.6267936], [7, 3.6166003], [2, 3.6014173], [3, 3.583288], [9, 3.5795357], [5, 3.5761442], [8, 3.573289], [0, 3.5557961], [11, 3.5368416]] |\n|4          |[[12, 3.6531658], [6, 3.646495], [7, 3.635862], [2, 3.621125], [3, 3.602444], [9, 3.5988958], [5, 3.5954528], [8, 3.5926485], [0, 3.575162], [11, 3.5557492]]    |\n|8          |[[12, 3.629304], [6, 3.6232433], [7, 3.6105542], [2, 3.5988178], [3, 3.577773], [9, 3.5754802], [5, 3.571873], [8, 3.5694718], [0, 3.5526445], [11, 3.5313659]]  |\n|7          |[[12, 3.577611], [6, 3.5710707], [7, 3.5606833], [2, 3.5462143], [3, 3.5279515], [9, 3.5244613], [5, 3.5210917], [8, 3.5183423], [0, 3.50121], [11, 3.4822202]]  |\n|10         |[[12, 3.63983], [6, 3.6342182], [7, 3.6197479], [2, 3.6103594], [3, 3.587215], [9, 3.5859258], [5, 3.5821545], [8, 3.5800629], [0, 3.5636337], [11, 3.540659]]   |\n|11         |[[12, 3.6572273], [6, 3.6513593], [7, 3.6376865], [2, 3.6270752], [3, 3.6048236], [9, 3.603031], [5, 3.5993178], [8, 3.5970523], [0, 3.5803256], [11, 3.5580654]]|\n|2          |[[12, 3.597289], [6, 3.590584], [7, 3.58063], [2, 3.5654154], [3, 3.5476196], [9, 3.5438285], [5, 3.5404835], [8, 3.5376246], [0, 3.5202749], [11, 3.5016499]]   |\n|0          |[[12, 3.5748413], [6, 3.5693047], [7, 3.5551836], [2, 3.5458395], [3, 3.523214], [9, 3.521895], [5, 3.5181992], [8, 3.516129], [0, 3.4999697], [11, 3.47749]]    |\n+-----------+-----------------------------------------------------------------------------------------------------------------------------------------------------------------+\n\n"
          }
        ]
      },
      "apps": [],
      "runtimeInfos": {
        "jobUrl": {
          "propertyName": "jobUrl",
          "label": "SPARK JOB",
          "tooltip": "View in Spark web UI",
          "group": "spark",
          "values": [
            {
              "jobUrl": "http://e67d52a5ef45:4040/jobs/job?id=1260",
              "$$hashKey": "object:98957"
            },
            {
              "jobUrl": "http://e67d52a5ef45:4040/jobs/job?id=1261",
              "$$hashKey": "object:98958"
            },
            {
              "jobUrl": "http://e67d52a5ef45:4040/jobs/job?id=1262",
              "$$hashKey": "object:98959"
            },
            {
              "jobUrl": "http://e67d52a5ef45:4040/jobs/job?id=1263",
              "$$hashKey": "object:98960"
            },
            {
              "jobUrl": "http://e67d52a5ef45:4040/jobs/job?id=1264",
              "$$hashKey": "object:98961"
            }
          ],
          "interpreterSettingId": "spark"
        }
      },
      "progressUpdateIntervalMs": 500,
      "jobName": "paragraph_1618453647641_433944417",
      "id": "paragraph_1618169967198_1409743974",
      "dateCreated": "2021-04-15T02:27:27+0000",
      "dateStarted": "2021-04-15T03:33:30+0000",
      "dateFinished": "2021-04-15T03:33:35+0000",
      "status": "FINISHED",
      "$$hashKey": "object:80170"
    },
    {
      "text": "//showing user to movie recommendations. From the recommndations list values are listed in order of ratings \n//position 0 is ther movie id and and position 1 is the predicted rating a user would give\nval idusr = ratings_nw.select(\"userid\", \"uprediction\")\nval idusers = idusr.withColumnRenamed(\"uprediction\", \"u_prediction\")\nval userrec10  = idusers.join(usertop10, idusers(\"u_prediction\") === usertop10(\"uprediction\"))\nval userrecs = userrec10.drop(\"u_prediction\")\nuserrecs.show(false)\n",
      "user": "anonymous",
      "dateUpdated": "2021-04-15T03:33:35+0000",
      "config": {
        "editorSetting": {
          "language": "scala",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "colWidth": 12,
        "editorMode": "ace/mode/scala",
        "fontSize": 9,
        "results": {},
        "enabled": true
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "TEXT",
            "data": "+------+-----------+-----------------------------------------------------------------------------------------------------------------------------------------------------------------+\n|userid|uprediction|recommendations                                                                                                                                                  |\n+------+-----------+-----------------------------------------------------------------------------------------------------------------------------------------------------------------+\n|72    |1          |[[12, 3.6388664], [6, 3.6340601], [7, 3.616575], [2, 3.6113124], [9, 3.5851057], [3, 3.5846455], [5, 3.5810702], [8, 3.5795279], [0, 3.5638764], [11, 3.5380757]]|\n|87    |1          |[[12, 3.6388664], [6, 3.6340601], [7, 3.616575], [2, 3.6113124], [9, 3.5851057], [3, 3.5846455], [5, 3.5810702], [8, 3.5795279], [0, 3.5638764], [11, 3.5380757]]|\n|42    |1          |[[12, 3.6388664], [6, 3.6340601], [7, 3.616575], [2, 3.6113124], [9, 3.5851057], [3, 3.5846455], [5, 3.5810702], [8, 3.5795279], [0, 3.5638764], [11, 3.5380757]]|\n|222   |1          |[[12, 3.6388664], [6, 3.6340601], [7, 3.616575], [2, 3.6113124], [9, 3.5851057], [3, 3.5846455], [5, 3.5810702], [8, 3.5795279], [0, 3.5638764], [11, 3.5380757]]|\n|42    |1          |[[12, 3.6388664], [6, 3.6340601], [7, 3.616575], [2, 3.6113124], [9, 3.5851057], [3, 3.5846455], [5, 3.5810702], [8, 3.5795279], [0, 3.5638764], [11, 3.5380757]]|\n|87    |1          |[[12, 3.6388664], [6, 3.6340601], [7, 3.616575], [2, 3.6113124], [9, 3.5851057], [3, 3.5846455], [5, 3.5810702], [8, 3.5795279], [0, 3.5638764], [11, 3.5380757]]|\n|145   |1          |[[12, 3.6388664], [6, 3.6340601], [7, 3.616575], [2, 3.6113124], [9, 3.5851057], [3, 3.5846455], [5, 3.5810702], [8, 3.5795279], [0, 3.5638764], [11, 3.5380757]]|\n|135   |1          |[[12, 3.6388664], [6, 3.6340601], [7, 3.616575], [2, 3.6113124], [9, 3.5851057], [3, 3.5846455], [5, 3.5810702], [8, 3.5795279], [0, 3.5638764], [11, 3.5380757]]|\n|271   |1          |[[12, 3.6388664], [6, 3.6340601], [7, 3.616575], [2, 3.6113124], [9, 3.5851057], [3, 3.5846455], [5, 3.5810702], [8, 3.5795279], [0, 3.5638764], [11, 3.5380757]]|\n|42    |1          |[[12, 3.6388664], [6, 3.6340601], [7, 3.616575], [2, 3.6113124], [9, 3.5851057], [3, 3.5846455], [5, 3.5810702], [8, 3.5795279], [0, 3.5638764], [11, 3.5380757]]|\n|271   |1          |[[12, 3.6388664], [6, 3.6340601], [7, 3.616575], [2, 3.6113124], [9, 3.5851057], [3, 3.5846455], [5, 3.5810702], [8, 3.5795279], [0, 3.5638764], [11, 3.5380757]]|\n|94    |1          |[[12, 3.6388664], [6, 3.6340601], [7, 3.616575], [2, 3.6113124], [9, 3.5851057], [3, 3.5846455], [5, 3.5810702], [8, 3.5795279], [0, 3.5638764], [11, 3.5380757]]|\n|72    |1          |[[12, 3.6388664], [6, 3.6340601], [7, 3.616575], [2, 3.6113124], [9, 3.5851057], [3, 3.5846455], [5, 3.5810702], [8, 3.5795279], [0, 3.5638764], [11, 3.5380757]]|\n|222   |1          |[[12, 3.6388664], [6, 3.6340601], [7, 3.616575], [2, 3.6113124], [9, 3.5851057], [3, 3.5846455], [5, 3.5810702], [8, 3.5795279], [0, 3.5638764], [11, 3.5380757]]|\n|87    |1          |[[12, 3.6388664], [6, 3.6340601], [7, 3.616575], [2, 3.6113124], [9, 3.5851057], [3, 3.5846455], [5, 3.5810702], [8, 3.5795279], [0, 3.5638764], [11, 3.5380757]]|\n|42    |1          |[[12, 3.6388664], [6, 3.6340601], [7, 3.616575], [2, 3.6113124], [9, 3.5851057], [3, 3.5846455], [5, 3.5810702], [8, 3.5795279], [0, 3.5638764], [11, 3.5380757]]|\n|172   |1          |[[12, 3.6388664], [6, 3.6340601], [7, 3.616575], [2, 3.6113124], [9, 3.5851057], [3, 3.5846455], [5, 3.5810702], [8, 3.5795279], [0, 3.5638764], [11, 3.5380757]]|\n|19    |1          |[[12, 3.6388664], [6, 3.6340601], [7, 3.616575], [2, 3.6113124], [9, 3.5851057], [3, 3.5846455], [5, 3.5810702], [8, 3.5795279], [0, 3.5638764], [11, 3.5380757]]|\n|18    |1          |[[12, 3.6388664], [6, 3.6340601], [7, 3.616575], [2, 3.6113124], [9, 3.5851057], [3, 3.5846455], [5, 3.5810702], [8, 3.5795279], [0, 3.5638764], [11, 3.5380757]]|\n|222   |1          |[[12, 3.6388664], [6, 3.6340601], [7, 3.616575], [2, 3.6113124], [9, 3.5851057], [3, 3.5846455], [5, 3.5810702], [8, 3.5795279], [0, 3.5638764], [11, 3.5380757]]|\n+------+-----------+-----------------------------------------------------------------------------------------------------------------------------------------------------------------+\nonly showing top 20 rows\n\n\u001b[1m\u001b[34midusr\u001b[0m: \u001b[1m\u001b[32morg.apache.spark.sql.DataFrame\u001b[0m = [userid: int, uprediction: int]\n\u001b[1m\u001b[34midusers\u001b[0m: \u001b[1m\u001b[32morg.apache.spark.sql.DataFrame\u001b[0m = [userid: int, u_prediction: int]\n\u001b[1m\u001b[34muserrec10\u001b[0m: \u001b[1m\u001b[32morg.apache.spark.sql.DataFrame\u001b[0m = [userid: int, u_prediction: int ... 2 more fields]\n\u001b[1m\u001b[34muserrecs\u001b[0m: \u001b[1m\u001b[32morg.apache.spark.sql.DataFrame\u001b[0m = [userid: int, uprediction: int ... 1 more field]\n"
          }
        ]
      },
      "apps": [],
      "runtimeInfos": {
        "jobUrl": {
          "propertyName": "jobUrl",
          "label": "SPARK JOB",
          "tooltip": "View in Spark web UI",
          "group": "spark",
          "values": [
            {
              "jobUrl": "http://e67d52a5ef45:4040/jobs/job?id=1265",
              "$$hashKey": "object:99178"
            },
            {
              "jobUrl": "http://e67d52a5ef45:4040/jobs/job?id=1266",
              "$$hashKey": "object:99179"
            },
            {
              "jobUrl": "http://e67d52a5ef45:4040/jobs/job?id=1267",
              "$$hashKey": "object:99180"
            },
            {
              "jobUrl": "http://e67d52a5ef45:4040/jobs/job?id=1268",
              "$$hashKey": "object:99181"
            },
            {
              "jobUrl": "http://e67d52a5ef45:4040/jobs/job?id=1269",
              "$$hashKey": "object:99182"
            },
            {
              "jobUrl": "http://e67d52a5ef45:4040/jobs/job?id=1270",
              "$$hashKey": "object:99183"
            }
          ],
          "interpreterSettingId": "spark"
        }
      },
      "progressUpdateIntervalMs": 500,
      "jobName": "paragraph_1618453647641_869636740",
      "id": "paragraph_1618169962519_674933954",
      "dateCreated": "2021-04-15T02:27:27+0000",
      "dateStarted": "2021-04-15T03:33:35+0000",
      "dateFinished": "2021-04-15T03:33:44+0000",
      "status": "FINISHED",
      "$$hashKey": "object:80171"
    },
    {
      "text": "//random check of cluster 7\nuserrecs.filter(userrecs(\"uprediction\") === 7).show(false)",
      "user": "anonymous",
      "dateUpdated": "2021-04-15T03:33:45+0000",
      "config": {
        "editorSetting": {
          "language": "scala",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "colWidth": 12,
        "editorMode": "ace/mode/scala",
        "fontSize": 9,
        "results": {},
        "enabled": true
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "TEXT",
            "data": "+------+-----------+---------------------------------------------------------------------------------------------------------------------------------------------------------------+\n|userid|uprediction|recommendations                                                                                                                                                |\n+------+-----------+---------------------------------------------------------------------------------------------------------------------------------------------------------------+\n|305   |7          |[[12, 3.577611], [6, 3.5710707], [7, 3.5606833], [2, 3.5462143], [3, 3.5279515], [9, 3.5244613], [5, 3.5210917], [8, 3.5183423], [0, 3.50121], [11, 3.4822202]]|\n|194   |7          |[[12, 3.577611], [6, 3.5710707], [7, 3.5606833], [2, 3.5462143], [3, 3.5279515], [9, 3.5244613], [5, 3.5210917], [8, 3.5183423], [0, 3.50121], [11, 3.4822202]]|\n|278   |7          |[[12, 3.577611], [6, 3.5710707], [7, 3.5606833], [2, 3.5462143], [3, 3.5279515], [9, 3.5244613], [5, 3.5210917], [8, 3.5183423], [0, 3.50121], [11, 3.4822202]]|\n|287   |7          |[[12, 3.577611], [6, 3.5710707], [7, 3.5606833], [2, 3.5462143], [3, 3.5279515], [9, 3.5244613], [5, 3.5210917], [8, 3.5183423], [0, 3.50121], [11, 3.4822202]]|\n|246   |7          |[[12, 3.577611], [6, 3.5710707], [7, 3.5606833], [2, 3.5462143], [3, 3.5279515], [9, 3.5244613], [5, 3.5210917], [8, 3.5183423], [0, 3.50121], [11, 3.4822202]]|\n|246   |7          |[[12, 3.577611], [6, 3.5710707], [7, 3.5606833], [2, 3.5462143], [3, 3.5279515], [9, 3.5244613], [5, 3.5210917], [8, 3.5183423], [0, 3.50121], [11, 3.4822202]]|\n|246   |7          |[[12, 3.577611], [6, 3.5710707], [7, 3.5606833], [2, 3.5462143], [3, 3.5279515], [9, 3.5244613], [5, 3.5210917], [8, 3.5183423], [0, 3.50121], [11, 3.4822202]]|\n|194   |7          |[[12, 3.577611], [6, 3.5710707], [7, 3.5606833], [2, 3.5462143], [3, 3.5279515], [9, 3.5244613], [5, 3.5210917], [8, 3.5183423], [0, 3.50121], [11, 3.4822202]]|\n|293   |7          |[[12, 3.577611], [6, 3.5710707], [7, 3.5606833], [2, 3.5462143], [3, 3.5279515], [9, 3.5244613], [5, 3.5210917], [8, 3.5183423], [0, 3.50121], [11, 3.4822202]]|\n|293   |7          |[[12, 3.577611], [6, 3.5710707], [7, 3.5606833], [2, 3.5462143], [3, 3.5279515], [9, 3.5244613], [5, 3.5210917], [8, 3.5183423], [0, 3.50121], [11, 3.4822202]]|\n|194   |7          |[[12, 3.577611], [6, 3.5710707], [7, 3.5606833], [2, 3.5462143], [3, 3.5279515], [9, 3.5244613], [5, 3.5210917], [8, 3.5183423], [0, 3.50121], [11, 3.4822202]]|\n|293   |7          |[[12, 3.577611], [6, 3.5710707], [7, 3.5606833], [2, 3.5462143], [3, 3.5279515], [9, 3.5244613], [5, 3.5210917], [8, 3.5183423], [0, 3.50121], [11, 3.4822202]]|\n|194   |7          |[[12, 3.577611], [6, 3.5710707], [7, 3.5606833], [2, 3.5462143], [3, 3.5279515], [9, 3.5244613], [5, 3.5210917], [8, 3.5183423], [0, 3.50121], [11, 3.4822202]]|\n|305   |7          |[[12, 3.577611], [6, 3.5710707], [7, 3.5606833], [2, 3.5462143], [3, 3.5279515], [9, 3.5244613], [5, 3.5210917], [8, 3.5183423], [0, 3.50121], [11, 3.4822202]]|\n|194   |7          |[[12, 3.577611], [6, 3.5710707], [7, 3.5606833], [2, 3.5462143], [3, 3.5279515], [9, 3.5244613], [5, 3.5210917], [8, 3.5183423], [0, 3.50121], [11, 3.4822202]]|\n|85    |7          |[[12, 3.577611], [6, 3.5710707], [7, 3.5606833], [2, 3.5462143], [3, 3.5279515], [9, 3.5244613], [5, 3.5210917], [8, 3.5183423], [0, 3.50121], [11, 3.4822202]]|\n|305   |7          |[[12, 3.577611], [6, 3.5710707], [7, 3.5606833], [2, 3.5462143], [3, 3.5279515], [9, 3.5244613], [5, 3.5210917], [8, 3.5183423], [0, 3.50121], [11, 3.4822202]]|\n|293   |7          |[[12, 3.577611], [6, 3.5710707], [7, 3.5606833], [2, 3.5462143], [3, 3.5279515], [9, 3.5244613], [5, 3.5210917], [8, 3.5183423], [0, 3.50121], [11, 3.4822202]]|\n|1     |7          |[[12, 3.577611], [6, 3.5710707], [7, 3.5606833], [2, 3.5462143], [3, 3.5279515], [9, 3.5244613], [5, 3.5210917], [8, 3.5183423], [0, 3.50121], [11, 3.4822202]]|\n|232   |7          |[[12, 3.577611], [6, 3.5710707], [7, 3.5606833], [2, 3.5462143], [3, 3.5279515], [9, 3.5244613], [5, 3.5210917], [8, 3.5183423], [0, 3.50121], [11, 3.4822202]]|\n+------+-----------+---------------------------------------------------------------------------------------------------------------------------------------------------------------+\nonly showing top 20 rows\n\n"
          }
        ]
      },
      "apps": [],
      "runtimeInfos": {
        "jobUrl": {
          "propertyName": "jobUrl",
          "label": "SPARK JOB",
          "tooltip": "View in Spark web UI",
          "group": "spark",
          "values": [
            {
              "jobUrl": "http://e67d52a5ef45:4040/jobs/job?id=1271",
              "$$hashKey": "object:99400"
            },
            {
              "jobUrl": "http://e67d52a5ef45:4040/jobs/job?id=1272",
              "$$hashKey": "object:99401"
            },
            {
              "jobUrl": "http://e67d52a5ef45:4040/jobs/job?id=1273",
              "$$hashKey": "object:99402"
            },
            {
              "jobUrl": "http://e67d52a5ef45:4040/jobs/job?id=1274",
              "$$hashKey": "object:99403"
            },
            {
              "jobUrl": "http://e67d52a5ef45:4040/jobs/job?id=1275",
              "$$hashKey": "object:99404"
            },
            {
              "jobUrl": "http://e67d52a5ef45:4040/jobs/job?id=1276",
              "$$hashKey": "object:99405"
            }
          ],
          "interpreterSettingId": "spark"
        }
      },
      "progressUpdateIntervalMs": 500,
      "jobName": "paragraph_1618453647641_1172897831",
      "id": "paragraph_1618195586487_1991570744",
      "dateCreated": "2021-04-15T02:27:27+0000",
      "dateStarted": "2021-04-15T03:33:45+0000",
      "dateFinished": "2021-04-15T03:33:53+0000",
      "status": "FINISHED",
      "$$hashKey": "object:80172"
    },
    {
      "text": "// Validate distribution of all use classification\r\nuserrecs.select(\"uprediction\").groupBy(\"uprediction\").agg(count(userrecs(\"uprediction\")).\r\nalias(\"Count\")).orderBy(desc(\"Count\")).show(1000)\r\n// usertypes denoted  classification 6 has the most users of this category",
      "user": "anonymous",
      "dateUpdated": "2021-04-15T03:33:53+0000",
      "config": {
        "editorSetting": {
          "language": "scala",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "colWidth": 12,
        "editorMode": "ace/mode/scala",
        "fontSize": 9,
        "results": {},
        "enabled": true
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "TEXT",
            "data": "+-----------+-----+\n|uprediction|Count|\n+-----------+-----+\n|          6|12904|\n|          4|10571|\n|          8| 9652|\n|          3| 9449|\n|          7| 9122|\n|          9| 9084|\n|          1| 8311|\n|          5| 8252|\n|          2| 7947|\n|         10| 7704|\n|          0| 7004|\n+-----------+-----+\n\n"
          }
        ]
      },
      "apps": [],
      "runtimeInfos": {
        "jobUrl": {
          "propertyName": "jobUrl",
          "label": "SPARK JOB",
          "tooltip": "View in Spark web UI",
          "group": "spark",
          "values": [
            {
              "jobUrl": "http://e67d52a5ef45:4040/jobs/job?id=1277",
              "$$hashKey": "object:99517"
            },
            {
              "jobUrl": "http://e67d52a5ef45:4040/jobs/job?id=1278",
              "$$hashKey": "object:99518"
            },
            {
              "jobUrl": "http://e67d52a5ef45:4040/jobs/job?id=1279",
              "$$hashKey": "object:99519"
            }
          ],
          "interpreterSettingId": "spark"
        }
      },
      "progressUpdateIntervalMs": 500,
      "jobName": "paragraph_1618453647642_1376649771",
      "id": "paragraph_1618195581855_174750146",
      "dateCreated": "2021-04-15T02:27:27+0000",
      "dateStarted": "2021-04-15T03:33:53+0000",
      "dateFinished": "2021-04-15T03:34:00+0000",
      "status": "FINISHED",
      "$$hashKey": "object:80173"
    },
    {
      "text": "// Generate top 10 user recommendations for each movie (User to Item)\r\nval movietop10 = model.recommendForAllItems(10)",
      "user": "anonymous",
      "dateUpdated": "2021-04-15T03:34:00+0000",
      "config": {
        "editorSetting": {
          "language": "scala",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "colWidth": 12,
        "editorMode": "ace/mode/scala",
        "fontSize": 9,
        "results": {},
        "enabled": true
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "TEXT",
            "data": "\u001b[1m\u001b[34mmovietop10\u001b[0m: \u001b[1m\u001b[32morg.apache.spark.sql.DataFrame\u001b[0m = [mprediction: int, recommendations: array<struct<uprediction:int,rating:float>>]\n"
          }
        ]
      },
      "apps": [],
      "runtimeInfos": {},
      "progressUpdateIntervalMs": 500,
      "jobName": "paragraph_1618453647642_1129186763",
      "id": "paragraph_1618195622905_1687186072",
      "dateCreated": "2021-04-15T02:27:27+0000",
      "dateStarted": "2021-04-15T03:34:00+0000",
      "dateFinished": "2021-04-15T03:34:01+0000",
      "status": "FINISHED",
      "$$hashKey": "object:80174"
    },
    {
      "text": "//showing movie to user recommendations. From the recommndations list values are listed in order of ratings \n//position 0 is ther user id and and position 1 is the predicted rating a user would give\nval idmvi = ratings_nw.select(\"movieid\", \"mprediction\")\nval idmvis = idmvi.withColumnRenamed(\"mprediction\", \"m_prediction\")\nval movierec10  = idmvis.join(movietop10, idmvis(\"m_prediction\") === movietop10(\"mprediction\"))\nval movierecs = movierec10.drop(\"m_prediction\")\nmovierecs.show(false)",
      "user": "anonymous",
      "dateUpdated": "2021-04-15T03:34:01+0000",
      "config": {
        "editorSetting": {
          "language": "scala",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "colWidth": 12,
        "editorMode": "ace/mode/scala",
        "fontSize": 9,
        "results": {},
        "enabled": true
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "TEXT",
            "data": "+-------+-----------+--------------------------------------------------------------------------------------------------------------------------------------------------------------+\n|movieid|mprediction|recommendations                                                                                                                                               |\n+-------+-----------+--------------------------------------------------------------------------------------------------------------------------------------------------------------+\n|302    |12         |[[11, 3.6572273], [4, 3.6531658], [5, 3.649192], [12, 3.6400213], [10, 3.63983], [1, 3.6388664], [9, 3.6335318], [8, 3.629304], [6, 3.5985057], [2, 3.597289]]|\n|51     |12         |[[11, 3.6572273], [4, 3.6531658], [5, 3.649192], [12, 3.6400213], [10, 3.63983], [1, 3.6388664], [9, 3.6335318], [8, 3.629304], [6, 3.5985057], [2, 3.597289]]|\n|465    |12         |[[11, 3.6572273], [4, 3.6531658], [5, 3.649192], [12, 3.6400213], [10, 3.63983], [1, 3.6388664], [9, 3.6335318], [8, 3.629304], [6, 3.5985057], [2, 3.597289]]|\n|118    |12         |[[11, 3.6572273], [4, 3.6531658], [5, 3.649192], [12, 3.6400213], [10, 3.63983], [1, 3.6388664], [9, 3.6335318], [8, 3.629304], [6, 3.5985057], [2, 3.597289]]|\n|332    |12         |[[11, 3.6572273], [4, 3.6531658], [5, 3.649192], [12, 3.6400213], [10, 3.63983], [1, 3.6388664], [9, 3.6335318], [8, 3.629304], [6, 3.5985057], [2, 3.597289]]|\n|432    |12         |[[11, 3.6572273], [4, 3.6531658], [5, 3.649192], [12, 3.6400213], [10, 3.63983], [1, 3.6388664], [9, 3.6335318], [8, 3.629304], [6, 3.5985057], [2, 3.597289]]|\n|384    |12         |[[11, 3.6572273], [4, 3.6531658], [5, 3.649192], [12, 3.6400213], [10, 3.63983], [1, 3.6388664], [9, 3.6335318], [8, 3.629304], [6, 3.5985057], [2, 3.597289]]|\n|219    |12         |[[11, 3.6572273], [4, 3.6531658], [5, 3.649192], [12, 3.6400213], [10, 3.63983], [1, 3.6388664], [9, 3.6335318], [8, 3.629304], [6, 3.5985057], [2, 3.597289]]|\n|229    |12         |[[11, 3.6572273], [4, 3.6531658], [5, 3.649192], [12, 3.6400213], [10, 3.63983], [1, 3.6388664], [9, 3.6335318], [8, 3.629304], [6, 3.5985057], [2, 3.597289]]|\n|229    |12         |[[11, 3.6572273], [4, 3.6531658], [5, 3.649192], [12, 3.6400213], [10, 3.63983], [1, 3.6388664], [9, 3.6335318], [8, 3.629304], [6, 3.5985057], [2, 3.597289]]|\n|208    |12         |[[11, 3.6572273], [4, 3.6531658], [5, 3.649192], [12, 3.6400213], [10, 3.63983], [1, 3.6388664], [9, 3.6335318], [8, 3.629304], [6, 3.5985057], [2, 3.597289]]|\n|118    |12         |[[11, 3.6572273], [4, 3.6531658], [5, 3.649192], [12, 3.6400213], [10, 3.63983], [1, 3.6388664], [9, 3.6335318], [8, 3.629304], [6, 3.5985057], [2, 3.597289]]|\n|514    |12         |[[11, 3.6572273], [4, 3.6531658], [5, 3.649192], [12, 3.6400213], [10, 3.63983], [1, 3.6388664], [9, 3.6335318], [8, 3.629304], [6, 3.5985057], [2, 3.597289]]|\n|317    |12         |[[11, 3.6572273], [4, 3.6531658], [5, 3.649192], [12, 3.6400213], [10, 3.63983], [1, 3.6388664], [9, 3.6335318], [8, 3.629304], [6, 3.5985057], [2, 3.597289]]|\n|385    |12         |[[11, 3.6572273], [4, 3.6531658], [5, 3.649192], [12, 3.6400213], [10, 3.63983], [1, 3.6388664], [9, 3.6335318], [8, 3.629304], [6, 3.5985057], [2, 3.597289]]|\n|272    |12         |[[11, 3.6572273], [4, 3.6531658], [5, 3.649192], [12, 3.6400213], [10, 3.63983], [1, 3.6388664], [9, 3.6335318], [8, 3.629304], [6, 3.5985057], [2, 3.597289]]|\n|514    |12         |[[11, 3.6572273], [4, 3.6531658], [5, 3.649192], [12, 3.6400213], [10, 3.63983], [1, 3.6388664], [9, 3.6335318], [8, 3.629304], [6, 3.5985057], [2, 3.597289]]|\n|137    |12         |[[11, 3.6572273], [4, 3.6531658], [5, 3.649192], [12, 3.6400213], [10, 3.63983], [1, 3.6388664], [9, 3.6335318], [8, 3.629304], [6, 3.5985057], [2, 3.597289]]|\n|673    |12         |[[11, 3.6572273], [4, 3.6531658], [5, 3.649192], [12, 3.6400213], [10, 3.63983], [1, 3.6388664], [9, 3.6335318], [8, 3.629304], [6, 3.5985057], [2, 3.597289]]|\n|1091   |12         |[[11, 3.6572273], [4, 3.6531658], [5, 3.649192], [12, 3.6400213], [10, 3.63983], [1, 3.6388664], [9, 3.6335318], [8, 3.629304], [6, 3.5985057], [2, 3.597289]]|\n+-------+-----------+--------------------------------------------------------------------------------------------------------------------------------------------------------------+\nonly showing top 20 rows\n\n\u001b[1m\u001b[34midmvi\u001b[0m: \u001b[1m\u001b[32morg.apache.spark.sql.DataFrame\u001b[0m = [movieid: int, mprediction: int]\n\u001b[1m\u001b[34midmvis\u001b[0m: \u001b[1m\u001b[32morg.apache.spark.sql.DataFrame\u001b[0m = [movieid: int, m_prediction: int]\n\u001b[1m\u001b[34mmovierec10\u001b[0m: \u001b[1m\u001b[32morg.apache.spark.sql.DataFrame\u001b[0m = [movieid: int, m_prediction: int ... 2 more fields]\n\u001b[1m\u001b[34mmovierecs\u001b[0m: \u001b[1m\u001b[32morg.apache.spark.sql.DataFrame\u001b[0m = [movieid: int, mprediction: int ... 1 more field]\n"
          }
        ]
      },
      "apps": [],
      "runtimeInfos": {
        "jobUrl": {
          "propertyName": "jobUrl",
          "label": "SPARK JOB",
          "tooltip": "View in Spark web UI",
          "group": "spark",
          "values": [
            {
              "jobUrl": "http://e67d52a5ef45:4040/jobs/job?id=1280",
              "$$hashKey": "object:99709"
            },
            {
              "jobUrl": "http://e67d52a5ef45:4040/jobs/job?id=1281",
              "$$hashKey": "object:99710"
            },
            {
              "jobUrl": "http://e67d52a5ef45:4040/jobs/job?id=1282",
              "$$hashKey": "object:99711"
            },
            {
              "jobUrl": "http://e67d52a5ef45:4040/jobs/job?id=1283",
              "$$hashKey": "object:99712"
            },
            {
              "jobUrl": "http://e67d52a5ef45:4040/jobs/job?id=1284",
              "$$hashKey": "object:99713"
            }
          ],
          "interpreterSettingId": "spark"
        }
      },
      "progressUpdateIntervalMs": 500,
      "jobName": "paragraph_1618453647642_577977983",
      "id": "paragraph_1618195626458_1306182287",
      "dateCreated": "2021-04-15T02:27:27+0000",
      "dateStarted": "2021-04-15T03:34:01+0000",
      "dateFinished": "2021-04-15T03:34:07+0000",
      "status": "FINISHED",
      "$$hashKey": "object:80175"
    },
    {
      "text": "// Validate distribution of all use classification\r\nmovierecs.select(\"mprediction\").groupBy(\"mprediction\").agg(count(movierecs(\"mprediction\")).\r\nalias(\"Count\")).orderBy(desc(\"Count\")).show(1000)\r\n// movie types denoted  as classification 3 has the most users of this category",
      "user": "anonymous",
      "dateUpdated": "2021-04-15T03:34:07+0000",
      "config": {
        "editorSetting": {
          "language": "scala",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "colWidth": 12,
        "editorMode": "ace/mode/scala",
        "fontSize": 9,
        "results": {},
        "enabled": true
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "TEXT",
            "data": "+-----------+-----+\n|mprediction|Count|\n+-----------+-----+\n|          2|10387|\n|         12| 9440|\n|          3| 8701|\n|          4| 8307|\n|          9| 8063|\n|          6| 7983|\n|         10| 7944|\n|         11| 7762|\n|          1| 7128|\n|          0| 6586|\n|          7| 6140|\n|          5| 6069|\n|          8| 5490|\n+-----------+-----+\n\n"
          }
        ]
      },
      "apps": [],
      "runtimeInfos": {
        "jobUrl": {
          "propertyName": "jobUrl",
          "label": "SPARK JOB",
          "tooltip": "View in Spark web UI",
          "group": "spark",
          "values": [
            {
              "jobUrl": "http://e67d52a5ef45:4040/jobs/job?id=1285",
              "$$hashKey": "object:99821"
            },
            {
              "jobUrl": "http://e67d52a5ef45:4040/jobs/job?id=1286",
              "$$hashKey": "object:99822"
            },
            {
              "jobUrl": "http://e67d52a5ef45:4040/jobs/job?id=1287",
              "$$hashKey": "object:99823"
            }
          ],
          "interpreterSettingId": "spark"
        }
      },
      "progressUpdateIntervalMs": 500,
      "jobName": "paragraph_1618453647642_241836196",
      "id": "paragraph_1618195578862_1702447283",
      "dateCreated": "2021-04-15T02:27:27+0000",
      "dateStarted": "2021-04-15T03:34:07+0000",
      "dateFinished": "2021-04-15T03:34:16+0000",
      "status": "FINISHED",
      "$$hashKey": "object:80176"
    }
  ],
  "name": "Collaborative Filtering",
  "id": "2G2N1K112",
  "defaultInterpreterGroup": "spark",
  "version": "0.9.0-preview2",
  "noteParams": {},
  "noteForms": {},
  "angularObjects": {},
  "config": {
    "isZeppelinNotebookCronEnable": false,
    "looknfeel": "default",
    "personalizedMode": "false"
  },
  "info": {
    "isRunning": true
  },
  "path": "/Collaborative Filtering"
}